# „ÄêÂèåËØ≠Â≠óÂπï+ËµÑÊñô‰∏ãËΩΩ„ÄëÊñØÂù¶Á¶èCS124 ÔΩú ‰ªéËØ≠Ë®ÄÂà∞‰ø°ÊÅØ(2021ÊúÄÊñ∞¬∑ÂÖ®14ËÆ≤) - P25ÔºöLe4.7- Á≤æÁ°ÆÁéá„ÄÅÂè¨ÂõûÁéá‰∏éFÂÄº - ShowMeAI - BV1YA411w7ym

![](img/b85b78094c471e92463071ac1ac6783f_0.png)

OkayÔºå let me now talk about how we evaluate text categorization and in doing this I'm going to come back to the concepts of precision and recall that we introduced informally before„ÄÇ

 but define them formalally and show how they get put together into combine measure the F measure that gets applied to text classification„ÄÇ

 but it isn't only applied to text classificationÔºå you'll see these concepts coming back again and again as ways of evaluation for tasks and natural language processing„ÄÇ

üòä„ÄÇ

![](img/b85b78094c471e92463071ac1ac6783f_2.png)

The starting point for understanding these measures is the following two by two contingency table„ÄÇ

 And so for any particular piece of data that we're evaluating„ÄÇ

 there are essentially four states on one axis were choosing whether this piece of data correctly belongs to a class„ÄÇ

Or whether it doesn't correctly belong to a class„ÄÇ SoÔºå for example„ÄÇ

 if we're wanting to decide whether a piece of email is spamÔºå we're„ÄÇIt either is spam„ÄÇ

 which is the correct classÔºå or it's notÔºå which is the not correct class„ÄÇ And so on this axis„ÄÇ

 we're describing the truth„ÄÇNowÔºå what we've done is built a system that tries to detect the truth„ÄÇ

 And so secondlyÔºå we're going to look at the status of our system„ÄÇ

 so our system could be saying that this piece of data is spam or it could be saying that it's not spam„ÄÇ

And so we're then going to take these four things and look at the four possibilities that occur„ÄÇ

 And here they are„ÄÇ So if we're looking for spamÔºå one possibility is the truth that that it is that it is spam„ÄÇ

 and that we said it was spam„ÄÇ And so that's then referred to as a true positive„ÄÇ

Another possibility is that„ÄÇOur system thought it wasn't spamÔºå even though actuallyÔºå it was„ÄÇ

 And so that's then a false negative„ÄÇ It was treated as negativeÔºå falsely„ÄÇ

On the other side of the dial it's possible that the piece of email actually wasn't spam in that case there are again two possibilities our system mistakenly thought it was spam so that's then a false positive we're classifying something positively wrongly„ÄÇ

 but the other possibility is it wasn't a piece of spam and our system said it wasn't piece of spam and then we're dealing with a true negative„ÄÇ

OkayÔºå so if we're doing this kind of classification with two classes that are perhaps about equally common in your email„ÄÇ

 spam and non spamÔºå it seems a reasonable thing to do is just to look at accuracy„ÄÇüòäÔºåSo for accuracy„ÄÇ

 the ones that count as you getting the answerÔºå correct are these ones„ÄÇ

 So if you want to work out the accuracyÔºå the accuracy equals the true positives plus the true negatives over„ÄÇ

All four classesÔºå the true positivesÔºå plus the false positives„ÄÇPlusÔºå the false negatives„ÄÇ

 plus the true negatives„ÄÇIn many applicationsÔºå accuracy is a useful measure for systems„ÄÇ

 but there is a particular scenario in which is not a useful measure„ÄÇ

 And that scenario is when you're dealing with things that are uncommon„ÄÇ SoÔºå for example„ÄÇ

 suppose that we're wanting to detect mentions of shoe brands in web pages„ÄÇ

 So the correct class is that something is a shoe brand„ÄÇüòäÔºåAnd the„ÄÇThe not class is anything else„ÄÇ

WellÔºå if you're just looking through random web pages or tweets or something„ÄÇ

 looking for mentions of shoe brandsÔºå probably„ÄÇI don't knowÔºå99„ÄÇ

99% of the words you encounter are not going to be the name of shoe brands„ÄÇ

 And so what does that meanÔºå What that is likely to mean is that perhaps in total„ÄÇ

 let's say there are„ÄÇ10 mentions of a shoe brand in a00000 word sampleÔºå and 99„ÄÇ

Thousand990 words that are not shoe brands„ÄÇWellÔºå if we build a classifierÔºå presumably„ÄÇ

 even if it's a mediocre classifierÔºå we're going to say most words are not a shoe brand„ÄÇ

 And if we go straight to the limit caseÔºå one possibility of our classifier is it could say that no word as a shoe brands„ÄÇ

 So it doesn't select any words as shoe brands„ÄÇ And it says that all 10000 words are not shoe brands„ÄÇ

 And so that means the number of true negatives is 99990„ÄÇ but there are few„ÄÇFalse negatives„ÄÇ

 words that were shoe brandsÔºå But the number of them is 10„ÄÇ

 So if we then actually work out the accuracy of this system„ÄÇ

 you'll see that the accuracy of the system„ÄÇIs 99„ÄÇ99%„ÄÇSo we have a 99„ÄÇ99% accurate system„ÄÇ

 but the system has done precisely nothing„ÄÇThis is a very easy system to write„ÄÇ

 You just write one line of code that says return false for any token and you're done„ÄÇ

 And yet its accuracy is amazing„ÄÇ So what's clearly missing here is that we're just not dealing with what we wanted to do„ÄÇ

 So what we wanted to do was detect shoe brands„ÄÇ So what's all important to us is the 10 tokens„ÄÇ

 which are instances of shoe brands„ÄÇ And so what we want to do is come up with an evaluation metric that is much more focused on„ÄÇ

 are we detecting these very few words that are the names of shoe brands„ÄÇüòä„ÄÇ



![](img/b85b78094c471e92463071ac1ac6783f_4.png)

And so that's what the measures of precision and recall do„ÄÇ So precision„ÄÇ

Tells you of the things that you're selectingÔºå Are they the correct things„ÄÇ

 So precision is saying of the things that you are selectingÔºå which is that row„ÄÇ

What percentage of them are correct thingsÔºå This column„ÄÇ

 So precision is the number of true positives out of all the things that you selected„ÄÇ

 the true positives plus the false positives„ÄÇAnd then recall is the opposite measure„ÄÇFor recall„ÄÇ

You're saying of the things„ÄÇThat are correct„ÄÇ What percentage of them did you find„ÄÇ So for recall„ÄÇ

 the numerator isÔºå again the true positives„ÄÇ But this timeÔºå the denominator is the true positives„ÄÇ

PlusÔºå the not selected false negatives„ÄÇAnd so note how looking at these measures solves the problem that we had last time with the shoe brands„ÄÇ

 because the fact that there is 99990 tokens that are true negatives is now having no effect on these measures at all„ÄÇ

And so what would happen in our previous case where there are 10 tokens here is and0 tokens here since our classifier said every word wasn't a shoe brand„ÄÇ

 that what we'd find is that we'd say that the recall of that system„ÄÇIs 0„ÄÇ

 It's finding none of what we wanted to find„ÄÇ And basically„ÄÇ

 we can say a system with0 recall isn't interesting„ÄÇ

And so this suggests we'd actually want to do better by returning some stuff„ÄÇ

 So what we'd like to do is label some things as shoe brands„ÄÇ So we could revise the system„ÄÇ

 And when we revise the system„ÄÇ maybe what we'll do is we'll have it return„ÄÇ

 40 things as the name of shoes„ÄÇ And so it'll perhaps find 8 of the shoe brands„ÄÇ

 But it'll make some mistakes and claim some things as shoe brands that aren't„ÄÇ

 So there'll be 32 tokens over here„ÄÇ And then there'll be two tokens down here„ÄÇ

 And then we the remainder of the tokens„ÄÇüòäÔºå960 will be down here„ÄÇ So then at that pointÔºå we can say„ÄÇ

 wellÔºå the recall of our system is pretty good„ÄÇ So it now finding 8 out of the 10 instances of shoe brands„ÄÇ

 So its recall is 80 per cent„ÄÇBut the problem is that that recall came as a cost because it's now also claiming lots of other things as shoe brands that aren't„ÄÇ

 So the precision of the system is now8 over 8 plus 32 equals8 out of 40Ôºå which equals 20%„ÄÇ

1 in five thingsÔºå it returns as correct„ÄÇ And so for a lot of practical applications„ÄÇ

 this kind of precision is going to be too low„ÄÇ It depends on whether you're really interest in finding references to shoe brands and have prepared to have a human being go through and check them all individually„ÄÇ

 But if you want to do something more automatic 20% is too low of a precision„ÄÇ But in this„ÄÇ

 we see the secret of the trade off that balances between recall and precision because almost inevitably„ÄÇ

 if you're going to increase your recall and find instances of something„ÄÇ

 you're going to make some mistakes„ÄÇ

![](img/b85b78094c471e92463071ac1ac6783f_6.png)

And so your precision is going to go down„ÄÇ And the more you try and boost recall„ÄÇ

 the more your precision is going to be starting to drop„ÄÇ

 And so people are trading off precision and recall„ÄÇ

 So that's a good thing about having these two measures„ÄÇ

 because you can discuss the trade off and say how important to someone is the precision of what's returned versus how important is it to find all of the stuff to have high recall„ÄÇ

And that's a trade off that is played out differently in different applications„ÄÇ

 so in various applications such as for things like legal applications where you want to find all of the appropriate evidence such as in discovery procedures where what you really really want to be doing is having a system thats is high recall that finds as much of the relevant stuff as possible„ÄÇ

 where in other contexts where what you're going to do is just show a sampling of stuff to the user„ÄÇ

üòäÔºåYou might be more interested in the stuff that's shown to the user being stuff that is correct that looks good„ÄÇ

 that your precision is highÔºå and it doesn't really matter that you're only showing to the user 1/10th or 1/20th of the things that do satisfy their query„ÄÇ

So sometimes that explicit tradeoff is really useful and it's a really good concept to remember when you're building NLP systems because in practice whenever you're building one of these systems you're choosing some tradeoff point as to how much you're emphasing precision or recall and different tradeoff points are appropriate in different applications„ÄÇ

 but sometimes that's a slightly annoying thing having these two measures because if people are wanting to compare systems and say which one is better then you need some way to combine these measures and so that's been thought about as well„ÄÇ

üòäÔºåAnd so the standard way that's been proposed to combine these measures is something that's called the F measure in disciplines like information retrieval and named entity recognition„ÄÇ

 So what is the F measure„ÄÇ What the F measure isÔºå is there's neither more nor less than a weighted harmonic mean„ÄÇ

 So at this pointÔºå we have to kind of revise a little bit of math on means„ÄÇ

 So you doubtless remember the arithmetic meanÔºå which is just the average of two things„ÄÇ

 and you perhaps also remember a geometric mean„ÄÇ But in addition to both of those„ÄÇ

 there's a harmonic mean„ÄÇ And in a harmonic meanÔºå what you do is you take the reciprocal of two quantities„ÄÇ

 and then add them and then take the reciprocal of that„ÄÇüòä„ÄÇ

And if you work through in more detail what that does„ÄÇ

 the harmonic mean ends up as a very conservative average„ÄÇ

 So if you put in two numbers into a harmonic mean„ÄÇ

 it's fairly close to the minimum of the two numbersÔºå not completely at the minimum„ÄÇ

 but it's nearer to the minimum than either the arithmetic or geometric means„ÄÇüòä„ÄÇ

Then in particular for this F measure we're allowed to put weights on these two terms and so this is this alpha factor so the weighting is how much to pay more attention to the precision or how much to pay more attention to the recall so if you are in an application and you know the precision is much more important to you„ÄÇ

 you can actually express that utility trade off by putting a particular value of alpha in that expresses it„ÄÇ

So this formulation here very clearly shows that the F measure is the weighted harmonic mean„ÄÇ

 but actually that's not the formulation that you normally see in books„ÄÇ

 The formulation that you normally see in books is actually this oneÔºå which isÔºå I guess„ÄÇ

 just a little bit tidier to write„ÄÇ these two formulations are related than maybe we'll work through that in one of the exercises„ÄÇ

 you can work out the relationship between alpha and beta„ÄÇ

 but effectively this formula also expresses a weighted harmonic mean„ÄÇ

 and it also has a control parameter beta as to how much emphasis is being put on precision versus recall„ÄÇ

üòäÔºåSo while that control parameter is useful in the absence of other evidence„ÄÇ

 the most commonly used thing is a balanced f measure and so the balanced F measure gets referred to as the F1 measure and what that's meaning is that you're setting beta equal to1 that then gives you equal balance between precision recall which corresponds in turn to alpha being a half and if you do the balanced F measure„ÄÇ

 this formula here simplifies to just this formula and so this is really the thing that you'll see most common„ÄÇ

 so if you don't remember any of the rest of this stuff what you should do is remember this little formula for the F measure two times the precision times the recall divided by the sum of the precision and the recall„ÄÇ



![](img/b85b78094c471e92463071ac1ac6783f_8.png)

So that should give you a good sense of what these measures of precision recall are„ÄÇ

 how they are combined into the F measureÔºå why they're useful„ÄÇ

 and how we use them to evaluate text classification„ÄÇüòä„ÄÇ



![](img/b85b78094c471e92463071ac1ac6783f_10.png)