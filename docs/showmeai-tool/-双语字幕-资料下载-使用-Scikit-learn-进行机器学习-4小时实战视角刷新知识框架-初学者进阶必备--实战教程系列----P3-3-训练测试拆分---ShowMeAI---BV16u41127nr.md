# 【双语字幕+资料下载】使用 Scikit-learn 进行机器学习，4小时实战视角刷新知识框架，初学者进阶必备！＜实战教程系列＞ - P3：3）训练测试拆分 - ShowMeAI - BV16u41127nr

![](img/816ece20f67a7bafdafc76312ab6259f_0.png)

所以上次我讨论了在同一数据上评估我们模型的问题。模型实际上可以有效地记忆答案，看起来表现良好，即使它并没有真正学到任何东西。我们将通过使用一种SK学习中的训练测试拆分来解决这个问题。这是一种通用策略，但这种特定方法会让我们更容易。

我们将这样做，我将获取我们的原始数据框，并返回两个数据框。我们将把我们的模型训练在一个数据框上，然后在另一个未见过的数据上进行评估。因此，这更好地测试它的表现。因此我可以看到我可以传递许多内容，其中之一是我可以说我希望我的数据中有多少比例进入测试集，我还可以说其他事情，比如尝试对数据进行分层，例如假设我处理的是某种分类数据。

我可能想确保两边的类别数量相似，虽然我在这里并没有尝试这样做。但我会指定一个训练测试集。![](img/816ece20f67a7bafdafc76312ab6259f_2.png)

所以让我导入这个东西，我要说。从SKLn导入哦是SKLn。t模型选择。导入。训练，测试，拆分。好的，然后我要说尝试和测试拆分。我将尝试在我原始的数据框上进行拆分。基本上，它返回一个包含两个数据框的数组。

所以我可以这样理解，我有我的训练数据框和测试数据框，它们的顺序是返回它们。让我看看这些。这里是我的训练数据框。然后这是我的测试数据框。你可以看到它们有点打乱了，如果我看索引的话。我正在处理不同的数据，所以这是我的模型将要学习的数据，而另一个是我实际确保它能学到东西的数据。

所以现在我可以看到，如果我看这个，下面是6300，上面是19000。这是因为默认的拆分是0.25，所以如果我愿意，可以这样做。然后这会让第一个数据框变大，第二个变小。所以我将这样做。哦，接下来让我看看我做错了什么。我想我实际上需要指定测试大小。

所以我将设置测试大小等于这个。然后这将会大一点。用于测试的数据更多。而训练的数据则稍少，所以这里有一些权衡。无论如何，现在我将回到我之前的例子，在那里我做了训练，而不是在同一数据上进行拟合和评分。我将拟合我的训练数据，然后在我的测试数据上进行评分。

所以我将从头开始再做一次复习，我要说LR等于线性回归。![](img/816ece20f67a7bafdafc76312ab6259f_4.png)

哦，来了，我说Lr.fit。我有我的训练数据框，然后我有一个列的列表。在这里，我可能有我的Y列，对吧？所以这就是总体策略。然后我想做的是给它打分。当我给它打分时，我会提供一个Y列和一个x列。抱歉。

我得说，训练数据框在这里。我会给它同样的信息。但现在我将处理测试数据框。我可能会说测试数据框，然后在这里也是一样，测试数据框。然后我将为此传递一个列的列表，就像之前一样。

我上次在看这个正数时在做什么？七天的平均值。有人可能会将其传递过来。就像这样，这里也是一样。然后在这里，我可以查看我试图预测的Y值，这就是这个东西。当我把它传递过来时，这里也是一样。我会这么做。

我看到这个。好吧，我的得分是0.16。那么如果我想在我原始的训练数据框上运行它，会发生什么呢？

像这样的训练数据框。在我训练的数据上表现得更好。这表明这里存在一些过拟合，对吧？模型在它学习过的数据上表现得更好，而不是在一些它之前没见过的新数据上，这当然是一个问题。因此，我可以尝试不同的方法来避免这种情况，我们最终会在这个学期讨论其中的一些方法。

大家好，今天我将讨论如何判断一个模型是否表现良好。我们如何解读不同的得分，并确保我们不是偶然得到一个好得分。因此，我可能会接上次的内容，模型试图预测基于当前病例数量的两周后COVID死亡人数，所以让我快速回顾一下上次我们在数据框上进行训练测试分割时的操作，我们的数据框看起来像这样。

这是按县计算的。然后每天和一年的数据在那里。然后我创建了这个线性回归模型，我从SK学习的线性模型中导入了它。然后我用它做了两件事，我把它拟合到我的训练数据上。然后我在我的测试数据上给它打分，这两部分我的训练数据和测试数据来自这里，因此当我做这个时。

我基本上做的是输入我的Y值，这是我最终想要预测的。然后在这里我输入我的x值或特征，这些是我现在知道的东西，例如，现在我知道阳性病例的七天滚动平均数，然后两周后我试图预测会有多少死亡。这可以是一个单一的序列，这就是为什么我们只输入一个字符串。

我在数据框后的括号里。这里我们实际上必须传入一个完整的数据框，因为通常我们可能有多个特征，当我在数据框后面的括号里传入一个列表时，我得到的是一个较小的数据框。这就是为什么我会有双括号。所以无论如何，我有这个0。

2，我们知道分数会在0和1之间。因此，很难说这个分数有多好，对吧？也许你总是偶然得到0.2。那么，这是我今天想谈的事情之一。你可能还会注意到，如果我多次重新运行这个，哦，现在我得到了27%、32%、24%、24、28、26。所以你可以看到，基于我如何进行训练测试划分，结果是不同的。

我可以得到非常不同的数字，因此这并没有给我们很多保障。那么我们如何才能从系统中获得更稳定的数字呢？我只给你一个关于问题的提示，如果我查看训练数据框并查看这个列，正是我们要预测的内容。嗯。让我来做这个。所以我有所有这些数字。

让我查看该列的方差，方差只是不同值与平均值之间差异的一个度量。然后我也将对测试集做同样的事情。因此，当我对测试集进行操作时，我看到它们实际上具有相当不同的方差。如果我再运行一次，随机抽样结果不同，现在测试数据的方差实际上比训练数据的方差要高。

我们最终会看看这个评分函数是如何工作的。但事实证明，它在很大程度上基于这个方差。这就是我们有如此嘈杂的度量的原因。所以让我去看幻灯片，尝试预览一下我们今天要讨论的内容。

![](img/816ece20f67a7bafdafc76312ab6259f_6.png)

我们将学习与模型评估相关的新函数。所以首先我们将学习这两个函数，它们将让我们对模型进行评分。![](img/816ece20f67a7bafdafc76312ab6259f_8.png)

第二，如果我们的模型表现平庸，就像我的模型一样，我的意思是0.2并不好。我们怎么知道这不是偶然的呢？因此，我们将使用一种叫做置换检验分数的方法。最后，为了获得一个噪声较少的度量，我们将进行交叉验证评分。

![](img/816ece20f67a7bafdafc76312ab6259f_10.png)

那么让我从这两个指标开始。我有这个R²分数和平均绝对误差。我们将讨论它们是如何工作的。![](img/816ece20f67a7bafdafc76312ab6259f_12.png)

如果我回到我的幻灯片或我的笔记本，我在这里进行评分。我也可以在这里说，从SKL.dot矩阵开始。![](img/816ece20f67a7bafdafc76312ab6259f_14.png)

导入。 我想做几件事。 我想计算 R2 分数，然后是平均绝对误差分数。 所有这些指标的工作方式大致如下。 我会调用指标函数。 然后我会说类似于，我的意思是。 我应该在这里快速检查一下。 我会说，我必须确保我的真实值和预测值之间的顺序是不同的。

我会说，真实值是什么，然后是我的预测值。 所以例如，在这里。 我知道这些是我的真实值。 然后我的预测值，嗯。 我该如何忘记我的预测值，我可以简单地说，模型。 请为我预测这些 y 值应该基于我将给你的 x 值。

所以我将这样做，在这里我输入 x 值，它将返回给我 Y 值。 还有这个奇怪的东西，我们最终会谈到。 但我可以把这个放在这里。 这样我就可以在这里使用很多不同的指标函数，例如。

使用 R2 分数。 就在这里，结果是与模型相关的这个平方默认使用 R2 分数。 我可以使用很多不同的指标，但这个是默认的。 所以让我们谈谈。 让我们稍微谈谈这个是如何计算的。 所以它的想法是，这是我想预测的东西。 所以这是我的 y 列。

有人会说，为什么在这里。 我可以瞥一眼。 我想做的是查看这一列相对于均值的平方残差。 那是什么意思。 我可以取这个。 然后减去这个的均值。 然后如果我想，我可以对所有这些进行平方。 所以这实际上是衡量系统有多糟糕的一个标准，如果我把所有这些东西加起来。

所以这实际上是系统的方差，只是我在求和而不是平均。 对，所以这是我原本的总误差或系统的方差，我可以认为我只是在添加，所以我在尝试平方和。🤧然后我想考虑的是，如果不是测量每个值与均值的距离。 而是测量到我实际预测的距离。

所以在这里会非常相似，我可以说，剩下的是什么。 如果我减去我的预测。 我如何获得我的预测，嗯，这就是在这里。 我会抓取这一部分。 让我把我的预测放在这里。 是的，然后让我看看。 所以我真正的想法是，最初这是我在系统中的方差，而这是我现在的方差。

在我做预测后，而不是仅仅减去均值。因此，我可以说，嗯，我可以说，还有多少剩余。我可以说剩余除以总数。那么，为什么呢？哦，让我把它放在这里。我可以说剩余除以总数，然后我想，好的。

为什么基本上保留了79%的方差？这意味着我减去了20%。🤧你可以看到这正是上面的内容，所以实际上这是人们用来评估回归效果的数学。通常我们可以用R平方分数更简单地做到这一点，甚至更简单的就是默认的vi say线性回归.dot分数。

让我给你举个例子，说明人们可能会使用的另一种指标。所以也许我只是想知道，嗯，平均误差是多少？在这种情况下，我会回到这一部分。对，这都是错误。如果我想获得平均值，应该考虑绝对误差。然后我可以取那个的均值。对。

所以这将是平均绝对误差。结果证明，实际上，干脆取这个均值绝对误差就行了。这其中有很多不同的指标，我想如果我按下Shift Tab，嗯。也许只是常规Tab。我可以看到这里所有不同的指标。

而且我大多数都没有使用过。所以我把这个粘贴在这里，我发现，嗯，这有点奇怪。它应该是相同的，应该是同一个数字。为什么不是同一个数字。因为我想要的是我的预测误差，而不是相对于均值。因此，对不起，这是我想要的，这是我想抓的东西。对。

所以我想说，你知道，这里是我所有的错误。取它们的绝对值。对，有些错误是正的或负的。我只是想要绝对值。然后我有平均值。为什么呢。嗯。在平衡语法中，这通常可能意味着我的括号不匹配。我明白了。

所以这个在那儿是匹配的。我不知道为什么我抓住了那个平方。好的。我可以看到这都是我的错误。然后我取绝对值并计算平均值。感谢上天，实际上得到的和我在这里写的相同。因此，再一次。对，这只是这个更复杂数学的捷径。

但这是另一种指标，涉及这些指标如何工作。呃。这种方法对所有错误的计数相对平等，你知道。错误的两倍大只是坏的两倍。因为在这里，我在做R平方分数时，平方我的错误，这会使它看起来更糟，尤其是当我有一些非常大的错误，而不是很多小错误时。

好的，这些是几个指标，这是我们想在幻灯片中回答的内容之一。我将返回这里。![](img/816ece20f67a7bafdafc76312ab6259f_16.png)
