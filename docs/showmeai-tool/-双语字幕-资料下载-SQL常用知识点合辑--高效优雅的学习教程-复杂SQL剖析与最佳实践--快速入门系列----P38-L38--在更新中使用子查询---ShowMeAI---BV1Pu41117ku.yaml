- en: ã€åŒè¯­å­—å¹•+èµ„æ–™ä¸‹è½½ã€‘SQLå¸¸ç”¨çŸ¥è¯†ç‚¹åˆè¾‘â€”â€”é«˜æ•ˆä¼˜é›…çš„å­¦ä¹ æ•™ç¨‹ï¼Œå¤æ‚SQLå‰–æä¸æœ€ä½³å®è·µï¼ï¼œå¿«é€Ÿå…¥é—¨ç³»åˆ—ï¼ - P38ï¼šL38- åœ¨æ›´æ–°ä¸­ä½¿ç”¨å­æŸ¥è¯¢
    - ShowMeAI - BV1Pu41117ku
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ã€åŒè¯­å­—å¹•+èµ„æ–™ä¸‹è½½ã€‘SQLå¸¸ç”¨çŸ¥è¯†ç‚¹åˆè¾‘â€”â€”é«˜æ•ˆä¼˜é›…çš„å­¦ä¹ æ•™ç¨‹ï¼Œå¤æ‚SQLå‰–æä¸æœ€ä½³å®è·µï¼ï¼œå¿«é€Ÿå…¥é—¨ç³»åˆ—ï¼ - P38ï¼šL38- åœ¨æ›´æ–°ä¸­ä½¿ç”¨å­æŸ¥è¯¢
    - ShowMeAI - BV1Pu41117ku
- en: '![](img/1aaccc13121b796c4c981d548aa633d9_0.png)'
  id: totrans-1
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1aaccc13121b796c4c981d548aa633d9_0.png)'
- en: å“¦ã€‚In this tutorial you're going to learn how to use subqueries in an update
    statement that's extremely powerfulã€‚ So we're going to continue with the example
    from the last tutorialã€‚ but we're going to make it more interesting Here we are
    updating all the invoices for client number three but what if we don't have the
    idea of a client we only have the name for exampleã€‚ imagine you have an application
    and in that application the user types in the name of the client So first we should
    find the I for that client and then use that I to update all their invoices How
    do we do that Wellã€‚
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: å“¦ã€‚åœ¨è¿™ä¸ªæ•™ç¨‹ä¸­ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•åœ¨æ›´æ–°è¯­å¥ä¸­ä½¿ç”¨å­æŸ¥è¯¢ï¼Œè¿™éå¸¸å¼ºå¤§ã€‚æ‰€ä»¥æˆ‘ä»¬å°†ç»§ç»­ä¸Šä¸€ä¸ªæ•™ç¨‹çš„ä¾‹å­ï¼Œä½†æˆ‘ä»¬ä¼šè®©å®ƒæ›´æœ‰è¶£ã€‚è¿™é‡Œæˆ‘ä»¬æ­£åœ¨æ›´æ–°å®¢æˆ·ç¼–å·ä¸‰çš„æ‰€æœ‰å‘ç¥¨ï¼Œä½†å¦‚æœæˆ‘ä»¬æ²¡æœ‰å®¢æˆ·çš„IDï¼Œåªæœ‰åå­—æ€ä¹ˆåŠï¼Ÿæƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œåœ¨é‚£ä¸ªåº”ç”¨ç¨‹åºä¸­ç”¨æˆ·è¾“å…¥å®¢æˆ·çš„åå­—ã€‚æ‰€ä»¥é¦–å…ˆæˆ‘ä»¬åº”è¯¥æ‰¾åˆ°è¯¥å®¢æˆ·çš„IDï¼Œç„¶åç”¨é‚£ä¸ªIDæ›´æ–°ä»–ä»¬æ‰€æœ‰çš„å‘ç¥¨ã€‚æˆ‘ä»¬è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ
- en: let's have a quick look at our client tableã€‚ğŸ˜Šï¼ŒSo here we have this clientï¼Œ My
    worksã€‚ let's say we have the nameï¼Œ we want to find the IDã€‚ğŸ˜Šï¼ŒSo back to our query
    editor windowã€‚ğŸ˜Šã€‚After this update statementï¼Œ I'm going to write a select statement
    to select the client ID columnã€‚ğŸ˜Šã€‚From the client's tableï¼Œ where name equals my
    worksã€‚
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬å¿«é€Ÿçœ‹ä¸€ä¸‹æˆ‘ä»¬çš„å®¢æˆ·è¡¨ã€‚ğŸ˜Šè¿™é‡Œæœ‰è¿™ä¸ªå®¢æˆ·ï¼Œæˆ‘çš„å·¥ä½œã€‚å‡è®¾æˆ‘ä»¬æœ‰åå­—ï¼Œæˆ‘ä»¬æƒ³æ‰¾åˆ°IDã€‚ğŸ˜Šæ‰€ä»¥å›åˆ°æˆ‘ä»¬çš„æŸ¥è¯¢ç¼–è¾‘å™¨çª—å£ã€‚ğŸ˜Šåœ¨è¿™ä¸ªæ›´æ–°è¯­å¥åï¼Œæˆ‘å°†å†™ä¸€ä¸ªé€‰æ‹©è¯­å¥æ¥é€‰æ‹©å®¢æˆ·IDåˆ—ã€‚ğŸ˜Šæ¥è‡ªå®¢æˆ·è¡¨ï¼Œæ¡ä»¶æ˜¯åå­—ç­‰äºæˆ‘çš„å·¥ä½œã€‚
- en: Now here we have a syntax error because we didn't terminate the last statement
    with a semicollonã€‚ but don't worry about thatï¼Œ we're going to get back to that
    in a secondã€‚ let's just select these few lines and execute this queryã€‚ğŸ˜Šï¼ŒThe idea
    of this client is too beautifulã€‚Now we can use this select statement as a sub
    queryry in an update statementã€‚
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨è¿™é‡Œå‡ºç°äº†è¯­æ³•é”™è¯¯ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰ç”¨åˆ†å·ç»“æŸæœ€åä¸€ä¸ªè¯­å¥ã€‚ä½†ä¸ç”¨æ‹…å¿ƒï¼Œæˆ‘ä»¬é©¬ä¸Šä¼šå›åˆ°è¿™ä¸€ç‚¹ã€‚è®©æˆ‘ä»¬é€‰ä¸­è¿™å‡ è¡Œå¹¶æ‰§è¡Œè¿™ä¸ªæŸ¥è¯¢ã€‚ğŸ˜Šè¿™ä¸ªå®¢æˆ·çš„æƒ³æ³•å¤ªç¾å¦™äº†ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥åœ¨æ›´æ–°è¯­å¥ä¸­å°†è¿™ä¸ªé€‰æ‹©è¯­å¥ç”¨ä½œå­æŸ¥è¯¢ã€‚
- en: so as I told you beforeï¼Œ a sub queryry is a select statement that is within
    another SQL statementã€‚ğŸ˜Šã€‚So instead of hard coding3 hereï¼Œ we're going to use this
    select statement as a sub queryã€‚ but we need to put it in parenthsesisã€‚ğŸ˜Šï¼ŒSo my
    school will execute this query firstã€‚ it will return the client ID and then use
    it in this conditionã€‚ğŸ˜Šï¼ŒSo for clarityã€‚
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: æ­£å¦‚æˆ‘ä¹‹å‰æ‰€è¯´ï¼Œå­æŸ¥è¯¢æ˜¯åœ¨å¦ä¸€ä¸ªSQLè¯­å¥ä¸­çš„é€‰æ‹©è¯­å¥ã€‚ğŸ˜Šæ‰€ä»¥ï¼Œæˆ‘ä»¬ä¸å†åœ¨è¿™é‡Œç¡¬ç¼–ç ï¼Œè€Œæ˜¯å°†è¿™ä¸ªé€‰æ‹©è¯­å¥ç”¨ä½œå­æŸ¥è¯¢ï¼Œä½†æˆ‘ä»¬éœ€è¦å°†å…¶æ”¾åœ¨æ‹¬å·ä¸­ã€‚ğŸ˜Šæ‰€ä»¥ï¼Œæˆ‘çš„å­¦æ ¡ä¼šé¦–å…ˆæ‰§è¡Œè¿™ä¸ªæŸ¥è¯¢ã€‚å®ƒä¼šè¿”å›å®¢æˆ·IDï¼Œç„¶ååœ¨è¿™ä¸ªæ¡ä»¶ä¸­ä½¿ç”¨å®ƒã€‚ğŸ˜Šä¸ºäº†æ¸…æ™°èµ·è§ã€‚
- en: let's remove the line break and indent these few linesã€‚ğŸ˜Šï¼ŒSo this is the end
    resultã€‚Now we execute this query and this updated all the invoices for this client
    Nowã€‚ what if this query returns multiple clientsï¼Œ for exampleï¼Œ back to the client's
    tableã€‚ let's imagine we want to update the invoices for all clients located in
    New York or Californiaã€‚
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬å»æ‰æ¢è¡Œå¹¶ç¼©è¿›è¿™å‡ è¡Œã€‚ğŸ˜Šè¿™æ˜¯æœ€ç»ˆç»“æœã€‚ç°åœ¨æˆ‘ä»¬æ‰§è¡Œè¿™ä¸ªæŸ¥è¯¢ï¼Œè¿™æ›´æ–°äº†è¯¥å®¢æˆ·çš„æ‰€æœ‰å‘ç¥¨ã€‚ç°åœ¨ï¼Œå¦‚æœè¿™ä¸ªæŸ¥è¯¢è¿”å›å¤šä¸ªå®¢æˆ·ï¼Œæ¯”å¦‚ï¼Œå›åˆ°å®¢æˆ·è¡¨ã€‚è®©æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬æƒ³æ›´æ–°æ‰€æœ‰ä½äºçº½çº¦æˆ–åŠ åˆ©ç¦å°¼äºšçš„å®¢æˆ·çš„å‘ç¥¨ã€‚
- en: so we need to update our subquery like thisã€‚ğŸ˜Šï¼ŒWhereã€‚Stateã€‚Inã€‚Californiaã€‚And
    New Yorkã€‚Nowã€‚ before executing the entire statementï¼Œ let's just select our sub
    query and execute it to see what we getã€‚So we get two client IDï¼Œ one and three
    beautiful now because this queryã€‚ this sub query returns multiple recordsï¼Œ we
    cannot use an equal sign here anymoreã€‚
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥æˆ‘ä»¬éœ€è¦åƒè¿™æ ·æ›´æ–°æˆ‘ä»¬çš„å­æŸ¥è¯¢ã€‚ğŸ˜Šåœ¨ï¼ŒåŠ åˆ©ç¦å°¼äºšå’Œçº½çº¦ã€‚ç°åœ¨ï¼Œåœ¨æ‰§è¡Œæ•´ä¸ªè¯­å¥ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆé€‰æ‹©æˆ‘ä»¬çš„å­æŸ¥è¯¢å¹¶æ‰§è¡Œå®ƒï¼Œçœ‹çœ‹æˆ‘ä»¬å¾—åˆ°ä»€ä¹ˆã€‚æ‰€ä»¥æˆ‘ä»¬å¾—åˆ°äº†ä¸¤ä¸ªå®¢æˆ·IDï¼Œä¸€ä¸ªå’Œä¸‰ä¸ªï¼Œå¤ªç¾å¦™äº†ã€‚å› ä¸ºè¿™ä¸ªæŸ¥è¯¢ï¼Œè¿™ä¸ªå­æŸ¥è¯¢è¿”å›å¤šä¸ªè®°å½•ï¼Œæˆ‘ä»¬ä¸èƒ½å†åœ¨è¿™é‡Œä½¿ç”¨ç­‰å·äº†ã€‚
- en: so we need to replace this with the in operatorã€‚ğŸ˜Šã€‚And now this statement updates
    the invoices for all clients located in these two statesã€‚ Let's execute itã€‚ğŸ˜Šï¼ŒBeautifulï¼Œ
    everything workedã€‚So as a best practiceã€‚ before executing your update statementï¼Œ
    run your query to see what records you're going to update so you don't accidentally
    update the records that shouldn't be updated Now here we have a sub queryryã€‚
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†å…¶æ›¿æ¢ä¸ºinè¿ç®—ç¬¦ã€‚ğŸ˜Šç°åœ¨è¿™ä¸ªè¯­å¥æ›´æ–°äº†ä½äºè¿™ä¸¤ä¸ªå·çš„æ‰€æœ‰å®¢æˆ·çš„å‘ç¥¨ã€‚è®©æˆ‘ä»¬æ‰§è¡Œå®ƒã€‚ğŸ˜Šå¤ªç¾äº†ï¼Œä¸€åˆ‡éƒ½æ­£å¸¸ã€‚ä½œä¸ºæœ€ä½³å®è·µï¼Œåœ¨æ‰§è¡Œä½ çš„æ›´æ–°è¯­å¥ä¹‹å‰ï¼Œè¿è¡Œä½ çš„æŸ¥è¯¢ä»¥æŸ¥çœ‹ä½ å°†è¦æ›´æ–°å“ªäº›è®°å½•ï¼Œè¿™æ ·ä½ å°±ä¸ä¼šæ„å¤–æ›´æ–°ä¸åº”è¯¥æ›´æ–°çš„è®°å½•ã€‚ç°åœ¨è¿™é‡Œæœ‰ä¸€ä¸ªå­æŸ¥è¯¢ã€‚
- en: but even if it didn't have a sub queryryï¼Œ we could still query the records that
    we're going to update let me show you so let's imagine we're going to update all
    the invoices where payment date is nuã€‚ğŸ˜Šï¼ŒBefore executing this entire update statementï¼Œ
    I would run a query like thisã€‚
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†æ˜¯å³ä½¿æ²¡æœ‰å­æŸ¥è¯¢ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥æŸ¥è¯¢è¦æ›´æ–°çš„è®°å½•ï¼Œè®©æˆ‘ç»™ä½ æ¼”ç¤ºä¸€ä¸‹ã€‚æ‰€ä»¥å‡è®¾æˆ‘ä»¬è¦æ›´æ–°æ‰€æœ‰æ”¯ä»˜æ—¥æœŸä¸ºnullçš„å‘ç¥¨ã€‚ğŸ˜Šï¼Œåœ¨æ‰§è¡Œæ•´ä¸ªæ›´æ–°è¯­å¥ä¹‹å‰ï¼Œæˆ‘ä¼šè¿è¡Œä¸€ä¸ªè¿™æ ·çš„æŸ¥è¯¢ã€‚
- en: select start from invoices where payment date is notã€‚ Nowï¼Œ let's execute this
    queryã€‚ğŸ˜Šã€‚These are the two records that don't have a payment dateã€‚ so once we're
    confident that we are updating the right recordsï¼Œ then we come back hereã€‚And get
    rid of this select statement and just attach the word clause to our update statementã€‚ğŸ˜Šã€‚
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: é€‰æ‹©å¼€å§‹ä»å‘ç¥¨ä¸­æ”¯ä»˜æ—¥æœŸä¸ºç©ºã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ‰§è¡Œè¿™ä¸ªæŸ¥è¯¢ã€‚ğŸ˜Šã€‚è¿™ä¸¤æ¡è®°å½•æ²¡æœ‰æ”¯ä»˜æ—¥æœŸã€‚å› æ­¤ï¼Œä¸€æ—¦æˆ‘ä»¬ç¡®è®¤æ›´æ–°äº†æ­£ç¡®çš„è®°å½•ï¼Œæˆ‘ä»¬å°±ä¼šå›åˆ°è¿™é‡Œã€‚å»æ‰è¿™ä¸ªé€‰æ‹©è¯­å¥ï¼Œåªéœ€å°†å­—è¯å­å¥é™„åŠ åˆ°æˆ‘ä»¬çš„æ›´æ–°è¯­å¥ä¸Šã€‚ğŸ˜Šã€‚
- en: '![](img/1aaccc13121b796c4c981d548aa633d9_2.png)'
  id: totrans-11
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1aaccc13121b796c4c981d548aa633d9_2.png)'
- en: '![](img/1aaccc13121b796c4c981d548aa633d9_3.png)'
  id: totrans-12
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1aaccc13121b796c4c981d548aa633d9_3.png)'
- en: Al rightï¼Œ here's your exercise for this tutorial Back to our SQL store databaseã€‚
    Look at the orders tableã€‚ğŸ˜Šï¼ŒAs you can seeï¼Œ some of your orders don't have a commentã€‚
    I want you to write a SQL statement to update the comments for orders for customers
    who have more than 3000 pointsã€‚ so customers who have more than 3000 points regard
    them as gold customers Find their orders if they have placed an order update the
    comments column and set it to gold customer that's a really good exerciseã€‚
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: å¥½å§ï¼Œè¿™æ˜¯æœ¬æ•™ç¨‹çš„ç»ƒä¹ ï¼Œå›åˆ°æˆ‘ä»¬çš„ SQL å•†åº—æ•°æ®åº“ã€‚æŸ¥çœ‹è®¢å•è¡¨ã€‚ğŸ˜Šï¼Œå¦‚æ‚¨æ‰€è§ï¼Œä¸€äº›è®¢å•æ²¡æœ‰è¯„è®ºã€‚æˆ‘å¸Œæœ›æ‚¨ç¼–å†™ä¸€ä¸ª SQL è¯­å¥ï¼Œæ›´æ–°ç§¯åˆ†è¶…è¿‡3000çš„å®¢æˆ·çš„è®¢å•è¯„è®ºã€‚æ‰€ä»¥ç§¯åˆ†è¶…è¿‡3000çš„å®¢æˆ·è¢«è§†ä¸ºé»„é‡‘å®¢æˆ·ã€‚å¦‚æœä»–ä»¬ä¸‹è¿‡è®¢å•ï¼Œè¯·æ‰¾åˆ°ä»–ä»¬çš„è®¢å•ï¼Œæ›´æ–°è¯„è®ºåˆ—å¹¶å°†å…¶è®¾ç½®ä¸ºâ€œé»„é‡‘å®¢æˆ·â€ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç»ƒä¹ ã€‚
- en: '![](img/1aaccc13121b796c4c981d548aa633d9_5.png)'
  id: totrans-14
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1aaccc13121b796c4c981d548aa633d9_5.png)'
- en: '![](img/1aaccc13121b796c4c981d548aa633d9_6.png)'
  id: totrans-15
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1aaccc13121b796c4c981d548aa633d9_6.png)'
- en: All at first we need to find the gold customersï¼Œ so select everything from the
    customers table where points is greater than 3000ã€‚ and by the wayï¼Œ because the
    current database is SQL invoicingã€‚ we either have to type out a use statement
    on the top or double click this database before executing this queryã€‚So there
    you goã€‚ We have three gold customersã€‚ Nowã€‚
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°é»„é‡‘å®¢æˆ·ï¼Œå› æ­¤ä»å®¢æˆ·è¡¨ä¸­é€‰æ‹©æ‰€æœ‰è®°å½•ï¼Œæ¡ä»¶æ˜¯ç§¯åˆ†å¤§äº3000ã€‚é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œå› ä¸ºå½“å‰æ•°æ®åº“æ˜¯ SQL å‘ç¥¨ï¼Œæˆ‘ä»¬è¦ä¹ˆåœ¨é¡¶éƒ¨è¾“å…¥ä½¿ç”¨è¯­å¥ï¼Œè¦ä¹ˆåœ¨æ‰§è¡Œæ­¤æŸ¥è¯¢ä¹‹å‰åŒå‡»æ­¤æ•°æ®åº“ã€‚å¥½äº†ï¼Œæˆ‘ä»¬æœ‰ä¸‰ä¸ªé»„é‡‘å®¢æˆ·ã€‚ç°åœ¨ã€‚
- en: we need to get the idea of these customers to use them in an update statement
    mapã€‚ So we only selectã€‚Customer Id hereã€‚And then use this select statement as
    a sub query and an update statementã€‚ğŸ˜Šï¼ŒUpdate ordersï¼Œ set comments toã€‚Gold customerã€‚Where
    customer Iã€‚ because we're dealing with multiple customer IDsï¼Œ we need to use the
    in operatorã€‚ğŸ˜Šã€‚
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬éœ€è¦è·å–è¿™äº›å®¢æˆ·çš„ä¿¡æ¯ä»¥ä¾¿åœ¨æ›´æ–°è¯­å¥ä¸­ä½¿ç”¨ã€‚æ‰€ä»¥æˆ‘ä»¬åªé€‰æ‹©å®¢æˆ·IDã€‚ç„¶åå°†æ­¤é€‰æ‹©è¯­å¥ç”¨ä½œå­æŸ¥è¯¢å’Œæ›´æ–°è¯­å¥ã€‚ğŸ˜Šï¼Œæ›´æ–°è®¢å•ï¼Œè®¾ç½®è¯„è®ºä¸ºé»„é‡‘å®¢æˆ·ã€‚æ¡ä»¶æ˜¯å®¢æˆ·IDã€‚å› ä¸ºæˆ‘ä»¬æ­£åœ¨å¤„ç†å¤šä¸ªå®¢æˆ·IDï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨
    in æ“ä½œç¬¦ã€‚ğŸ˜Šã€‚
- en: And then to use this as a sub queryï¼Œ we need to enclose it in parenthesisã€‚ That's
    itã€‚ Let's indent the codeã€‚ that's betterã€‚ So here is the final solutionã€‚![](img/1aaccc13121b796c4c981d548aa633d9_8.png)
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åè¦å°†å…¶ç”¨ä½œå­æŸ¥è¯¢ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶æ”¾åœ¨æ‹¬å·ä¸­ã€‚è¿™å°±å®Œæˆäº†ã€‚è®©æˆ‘ä»¬ç¼©è¿›ä»£ç ã€‚è¿™æ ·æ›´å¥½ã€‚è¿™é‡Œæ˜¯æœ€ç»ˆè§£å†³æ–¹æ¡ˆã€‚![](img/1aaccc13121b796c4c981d548aa633d9_8.png)
- en: Ohã€‚
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: å“¦ã€‚
