- en: ã€åŒè¯­å­—å¹•+èµ„æ–™ä¸‹è½½ã€‘é¢å‘åˆå­¦è€…çš„ TensorFlow æ•™ç¨‹ï¼Œç†è®ºçŸ¥è¯†ã€ä»£ç æ€è·¯å’Œåº”ç”¨æ¡ˆä¾‹ï¼ŒçœŸæ­£ä»é›¶å¼€å§‹è®²æ˜ç™½ï¼ï¼œå¿«é€Ÿå…¥é—¨ç³»åˆ—ï¼ - P8ï¼šL9- è¿ç§»å­¦ä¹ 
    - ShowMeAI - BV1TT4y1m7Xg
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '![](img/61fab98aab26950654922e0fb57a2416_0.png)'
  prefs: []
  type: TYPE_IMG
- en: ğŸ¼ï¼ŒHeyï¼Œ guysï¼Œ and welcome to a new Tensorflowlow tutorialã€‚ Todayã€‚ we will continue
    where we left off last time and applied transfer learning together get a model
    with a good performanceã€‚ğŸ˜Šï¼ŒSo I highly recommend that you watch the last tutorial
    first if you haven't alreadyã€‚ And as a quick recapã€‚ So we used a dataset set from
    Kegle with Lego Star Wars Minfiã€‚
  prefs: []
  type: TYPE_NORMAL
- en: and we applied our own convolutional neural netã€‚ and then we had the problem
    that for the trainingã€‚ we got a very good accuracyã€‚ So this was close to a 100%ã€‚
    but it didn't perform well on our validation data set and also for the final evaluation
    with the test data setã€‚ We only got an accuracy of 40%ã€‚ So this is not very goodã€‚
  prefs: []
  type: TYPE_NORMAL
- en: So now what we want to do is we want to apply transfer learning to improve our
    modelã€‚ğŸ˜Šã€‚And transfer learning is a very niceï¼Œ simple but very powerful techniqueã€‚So
    the concept is that we use a model that has been already trained and this is probably
    a very good model that with a lot of features and that also has been trained on
    a lot of data and now what we do here is so we we take this model and then we
    only modify the last layers so we cut them out and then apply our own classification
    layers at the end and train only these layers at the end so with this our training
    can be very quick but we can also get the power of the rest of the neural network
    that is already pretrained So this is the whole concept behind transfer learning
    and now I show you how we do that with Ks so the first thingã€‚
  prefs: []
  type: TYPE_NORMAL
- en: We want to do is to load a pretrain modelã€‚ So there are already some models
    available in Ksã€‚ For exampleï¼Œ the popular Vg G16 modelã€‚ So you get this by saying
    Tensorflow kas applications and then the name of our modelã€‚ So if we download
    the if we call thisï¼Œ then it's downloading this model and saves it in your folderã€‚
    So let's run this and print this summaryã€‚ And here we have theã€‚Archiectureã€‚
  prefs: []
  type: TYPE_NORMAL
- en: So you can have a look at thatã€‚And now what we want to do here isï¼Œ as I saidï¼Œ
    we want toã€‚![](img/61fab98aab26950654922e0fb57a2416_2.png)
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/61fab98aab26950654922e0fb57a2416_3.png)'
  prefs: []
  type: TYPE_IMG
- en: Delette the last layerã€‚ so you can delete only the very last layerã€‚ or you can
    also delete more and then apply your ownã€‚ So in this exampleï¼Œ we only take out
    the lastã€‚Layerï¼Œ so this dense layer and then apply our own dense layer with five
    different outputsã€‚ because in our exampleï¼Œ we have five different classesã€‚ And
    right nowã€‚
  prefs: []
  type: TYPE_NORMAL
- en: this is a Kaas functional modelã€‚ So I already talked about the functional APIã€‚
    And if you haven'tã€‚ then I also recommend to watch this one first and I will put
    the link in the descriptionã€‚ But I also said that we can easily convert this to
    a sequential modelã€‚ So we can do this by setting up a new model and say this is
    a sequential modelã€‚
  prefs: []
  type: TYPE_NORMAL
- en: and then we iterate over all the layers except the last oneã€‚ So this is not
    included and say model and layerã€‚ So now let's run this and print the summaryã€‚
    and thenã€‚It should be the sameï¼Œ except that you don't see this layerï¼Œ soã€‚Oh sorryã€‚
    So hereã€‚ this is the original summaryã€‚ and here we have this as last layer with10
    outputsã€‚
  prefs: []
  type: TYPE_NORMAL
- en: And now in our caseï¼Œ this should be the last layerã€‚ So let's have a lookã€‚ And
    yesï¼Œ here thisã€‚ This is the last layerã€‚ And now what we want to do here is we
    want to set all of those layers to trainable equals falsesã€‚ because we don't have
    to retrain these againã€‚ we only have to train our new classification layerã€‚ So
    we loop over all layers and say layer trainable equals falseã€‚
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/61fab98aab26950654922e0fb57a2416_5.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/61fab98aab26950654922e0fb57a2416_6.png)'
  prefs: []
  type: TYPE_IMG
- en: And for exampleï¼Œ hereï¼Œ you see the trainable parameters and the nontrainable
    parametersã€‚ And now if we do this and print the summary againã€‚ then we see that
    now all of our parameters are non trainableã€‚ and now we add a last dense layerã€‚
    And by defaultã€‚ Now this is trainable againã€‚ And then againã€‚
  prefs: []
  type: TYPE_NORMAL
- en: we set up a loss and a optimizer and compile our modelã€‚And then so last time
    I told you how we can use thisã€‚Image data generator and then call this dot flow
    from directory functionã€‚ And this very easily loads the images from a directoryã€‚
    and we can also apply preprocessing and rescaling and even image augmentation
    hereã€‚ So last time we applied this rescaling hereã€‚And now this timeï¼Œ what we want
    to doã€‚ we want to apply the same pre processingcessing function as in our base
    modelã€‚ So in this weci G netã€‚Soï¼Œ and we also get this by saying this is available
    in tensor flowcaras applications than the name of our model and then dot pre process
    inputã€‚
  prefs: []
  type: TYPE_NORMAL
- en: So this is our pre processing functionï¼Œ and then we can give this to our image
    data generator for with the argument pre processinging functionã€‚ So this is the
    same for our training validation and test setã€‚And then we call this flow from
    directory for each oneã€‚ And this isã€‚ these are the same arguments as last timeã€‚
    And now this is loading them the images from the different modelsã€‚
  prefs: []
  type: TYPE_NORMAL
- en: I didn't run this cellã€‚ So let's run this and this againã€‚ And now we have itã€‚
    And nowï¼Œ againã€‚ this is the same as last timeã€‚ So we fitted our modelã€‚ and we
    apply this early stopping call backã€‚ So if our validation loss does not increase
    for or improve for5 eposã€‚ Then it does an early stoppingã€‚ So let's apply this
    again hereã€‚ And now let's fit our dataã€‚
  prefs: []
  type: TYPE_NORMAL
- en: So this is giving an errorã€‚ You must compile your model before training and
    testingã€‚ So I think I already did this in this cellã€‚ So let's run this againã€‚
    and run this and this and now our trainingã€‚ So now it's workingã€‚ I guess I didn't
    run the cell the first timeã€‚ So now let's see how our transfer learning model
    is doingã€‚
  prefs: []
  type: TYPE_NORMAL
- en: All rightã€‚ And now our training is doneã€‚ And againï¼Œ we had an early stoppingã€‚
    So we see that our accuracy on the test data set is 100 perã€‚ so perfectã€‚And the
    validation accuracy is almost 94%ã€‚ So yeahï¼Œ I think this is now very goodã€‚ And
    it's a lot better than last timeã€‚ And now we specified 30 epochsã€‚
  prefs: []
  type: TYPE_NORMAL
- en: but then our validation loss had the lowest value hereã€‚ And then it didn't get
    better over the next five epochã€‚ So we set patients is 5ã€‚ And that's why that
    the early stoppingã€‚ So we already had a validation accuracy of 100% in the second
    epochã€‚ But this might be the case because we don't have so many images available
    in our validation data setã€‚
  prefs: []
  type: TYPE_NORMAL
- en: So I think this result is not very reliableã€‚ But yeahã€‚ I think we can see how
    powerful this transfer learning isã€‚ because last time we had problem with overfitting
    so that we had aã€‚Good accuracy on the testã€‚ on the training dataï¼Œ but not on the
    validation data and not on the test dataã€‚
  prefs: []
  type: TYPE_NORMAL
- en: And now with a transfer learning techniqueï¼Œ we can get this after only two epochs
    And even in this example where we don't have so many images availableã€‚ and this
    is very goodã€‚ So now let's evaluate our model on the test data setã€‚ And we see
    in this caseï¼Œ we got 100 percent on accuracy on the test dataã€‚ So I guess I' am
    a little bit lucky this timeã€‚ But yeahã€‚
  prefs: []
  type: TYPE_NORMAL
- en: we see how powerful this technique is again and how simple it isã€‚ So you load
    a pretrained modelã€‚ğŸ˜Šã€‚Andã€‚Soã€‚So this oneã€‚ and then we converted it in this caseï¼Œ
    to a sequential modelã€‚ So you don't have to do thisã€‚ but this makes it a little
    bit simpler for you because I know the sequential API is easier to understandã€‚And
    then we excluded the last layer and added our own dense layerã€‚
  prefs: []
  type: TYPE_NORMAL
- en: and then we also set layers trainable to false except for our last dense layerã€‚
    And then we did a new trainingã€‚And as a homeworkï¼Œ you can try out other pretrain
    netsã€‚ Soã€‚ for exampleï¼Œ the mobile net version 2 is another very popular netã€‚ so
    you can go to this link And then here you have all the different available netã€‚
  prefs: []
  type: TYPE_NORMAL
- en: So here's our V G16ï¼Œ you also have reachi G19ã€‚ you have the mobile net and the
    mobile net version 2 and the resnetã€‚ So yeahï¼Œ try them out for itselfã€‚ and I can
    tell you that you might run into a problem when you try to convert your model
    to a sequential model because this only works if the architecture of your model
    is linearã€‚
  prefs: []
  type: TYPE_NORMAL
- en: and if you don't know how you do thisï¼Œ if your architecture is not linearã€‚ then
    you can watch my tutorial about the functional API because there I gave you a
    tip at the end and showed you how you can stillã€‚Do transfer learning with a functional
    modelã€‚ So yeah check it out and let me know if you can also get a accuracy of
    100% and I hope to see you in the next video thenã€‚ And if you enjoy this videoï¼Œ
    please hit the like button and consider subscribing to the channel byeã€‚
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/61fab98aab26950654922e0fb57a2416_8.png)'
  prefs: []
  type: TYPE_IMG
