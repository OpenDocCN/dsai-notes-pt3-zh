- en: „ÄêÂèåËØ≠Â≠óÂπï+ËµÑÊñô‰∏ãËΩΩ„Äë‰ΩøÁî® Scikit-learn ËøõË°åÊú∫Âô®Â≠¶‰π†Ôºå4Â∞èÊó∂ÂÆûÊàòËßÜËßíÂà∑Êñ∞Áü•ËØÜÊ°ÜÊû∂ÔºåÂàùÂ≠¶ËÄÖËøõÈò∂ÂøÖÂ§áÔºÅÔºúÂÆûÊàòÊïôÁ®ãÁ≥ªÂàóÔºû - P2Ôºö2ÔºâÁ∫øÊÄßÂõûÂΩí
    - ShowMeAI - BV16u41127nr
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '![](img/a675287e777e7febf7b67a8d3ccaf6f7_0.png)'
  prefs: []
  type: TYPE_IMG
- en: WellÔºå in this videoÔºå I'm going to be training a regression model from Psyt Learn
    to some COVID data in Wisconsin„ÄÇSo here I am on the Department of Health Services
    websiteÔºå a data portal„ÄÇ and I can search for COVID here„ÄÇAnd the data set I'm using
    is„ÄÇThis one right here„ÄÇ the historical data by county„ÄÇSo there are about 70 counties
    in Wisconsin„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: And what this data shows me is for each dayÔºå I wonder if I can draw a data browser
    here„ÄÇIt shows me for each date in each countyÔºå all of these different statsÔºå so
    for example„ÄÇ how many positive cases are there totalÔºå how many new cases are there„ÄÇ
    how about over the average of the last seven daysÔºüAnd how many deaths are there„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: and ultimately what we're going to try to predict and this based on this data
    is well„ÄÇ how many deaths are there two weeks in the future based on looking at
    the stats for today„ÄÇSo I had downloaded this and Im not to do it again„ÄÇ![](img/a675287e777e7febf7b67a8d3ccaf6f7_2.png)
  prefs: []
  type: TYPE_NORMAL
- en: And then there was a fair bit of data cleanup that I had to do here„ÄÇAnd that's
    not the main point of this lectureÔºå so I have a notebook for it that does all
    the cleanup„ÄÇ I was just trying to kind of quickly walk you through this some of
    the things I did here without spending too much time on it„ÄÇOne I pulled out just
    a few interesting columnsÔºå so for example„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: how many positive cases were there on average over the last seven days and then
    how many new deaths were thereÔºü
  prefs: []
  type: TYPE_NORMAL
- en: We had a bunch of missing dataÔºå so I just dropped anything with missing data„ÄÇAnd
    then I converted the date to an actual Pada state time and in the process I dropped
    what hour it was„ÄÇ I just want to get the date without having the hour that it
    was posted„ÄÇAnd thenÔºå finally„ÄÇThe documentation for this data set says that negative
    999 really means that there's less than55 in whatever that field is„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: so it could be anywhere from0 to 4 and so I think just for simplicity I just
    replace that all 0 we don't really know what that is you can imagine doing something
    smarter like maybe 2„ÄÇ5 seems more fair in some sense„ÄÇAnywayÔºå so I get a data set
    that looks like thisÔºå right„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: in a lot of casesÔºå while there's„ÄÇNo new cases and no new deaths„ÄÇ maybe for some
    of these smaller counties„ÄÇ and then then of courseÔºå for larger counties„ÄÇ that
    definitely is not zero„ÄÇAnd and so then I you go down a little bit more„ÄÇ the other
    thing I want to do is I want to add a column which isn't just about how many new
    deaths are there„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: but how many new deaths are there two weeks in the future„ÄÇAnd so I had to do
    some trickery with time Dltas„ÄÇTo basically join the data on two weeks in the future
    and you can look at that if you're interested„ÄÇButBut in end I get a data set that
    looks like thisÔºå right„ÄÇ I know how many new deaths there are on this particular
    day„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: and then this last field is how many there are after the specific one and I
    save all this to this Wisconsin COVID data set so that's what I may be working
    with here and I'm just trying to head over here and create a new notebook„ÄÇTo analyze
    that„ÄÇ So let me head here„ÄÇ And then what I'm going to do is I'm going to import
    pandas for starters„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: So I'm going say„ÄÇImport pandas as PD„ÄÇAnd maybe I'm also add on import mat plot
    LibÔºå dot5 plot„ÄÇÂóØ„ÄÇAs PLTÔºå and then maybe I'm sure I can configure my mappl lib
    stuff first„ÄÇOtÔºå lib and line„ÄÇAnd then PRRT that„ÄÇA C parametersms„ÄÇLet's just make
    the font size a little bit bigger„ÄÇGreat„ÄÇ so now I can actually give my data frameÔºå
    so I'm going to say data frame equals PDd„ÄÇread CSv„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: And what do I want while that file I produced from that other notebookÔºå which
    is Wisconsin„ÄÇ12vi„ÄÇcsv„ÄÇ and let me just peek at that„ÄÇSo that's all I could and
    maybe just to make sure that all these things are not actually zero just I say
    what does the data frame mean and so I can see on average in a given to in a given
    day on average one in four people have died and so what I'm going be trying to
    do is I'm trying to be predicting this field on I might either try this as a feature
    or this is a feature and this is going my label column that I'm actually trying
    to predict„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: it's a quantity which is why I'm doing a regression instead of a classification„ÄÇOften
    before I jump into trying to do a regression„ÄÇ I'll do a scatter plot to just see
    if I can identify visually any patterns in the data and so I might do something
    like this I might say data frame dot plot„ÄÇThatts scatter„ÄÇ And then I can say my
    x equals somethingÔºå and then my y equals something„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: And so in both casesÔºå the thing I'm trying to predict my why is how many deaths
    are there going to be two weeks after this given date„ÄÇ and then my XÔºå I guess
    for the first caseÔºå I'll tryÔºåOfThe seven day average„ÄÇLike that„ÄÇAnd so I can see
    a picture there and then the other thing I want to do is I want to say well„ÄÇ if
    I look at how many deaths there were a dayÔºå what will that tell me about how many
    deaths it'll be two weeks from now and I see a slightly different pattern there„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: sometimes for these I like to say alpha equals 0„ÄÇ2 or something like that just
    give a little bit of transparency when a lot of points are on top of each other„ÄÇAnd
    I'll do that as well„ÄÇAnd so the other thing that I really like to do as we're
    going forward is we're going to train a regression model„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: On both of these variablesÔºå and so I want you to get a sense when we score that„ÄÇ
    how that score corresponds to kind of the strength of the relationship in both
    of these„ÄÇSo I'll start with this oneÔºå how can we train a regression model that
    fits this to thisÔºü
  prefs: []
  type: TYPE_NORMAL
- en: And the first thing I have to do is I'm going to have to import it„ÄÇ so I'm going
    to say from SKLarn do linear modelÔºå import linear„ÄÇRegression„ÄÇ this is the main
    regression model we're going to learn this semesterÔºå so I'm going to do that„ÄÇAnd
    then if I want toÔºå I can create a new linear regression object„ÄÇJust like that„ÄÇAnd„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: and so there's a fewÔºå there's a few„ÄÇMethods are going to want to learn with
    this„ÄÇ so some important methods are going to be fit„ÄÇProdect wellÔºå FÔºå score and
    predict„ÄÇAnd we're going to be running those things on our data„ÄÇRight„ÄÇ so let me
    come down here and what I can do when I'm fitting it or training it is I give
    it two pieces of information I give it my„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: My X valuesÔºå and I'll give it my Y values„ÄÇAnd for theÔºå the y values„ÄÇThat could
    be a series if I want„ÄÇ so I could just pull off that one column for my x valuesÔºå
    it has to be a data frame„ÄÇAnd so let me just take a look at my data frame earlier„ÄÇWhat
    I'm going to do first is do a model corresponding to this plot right so I want
    to do it based on how do the deaths today predict the deaths in the future„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: And so what I have to do is I have plot this one column is new deaths„ÄÇInto a
    data frame„ÄÇ So the way I'll do that is like thisÔºå if I do thisÔºå just death„ÄÇNew„ÄÇThen
    what then I just did a series the way I can do a data frame is I can pass in a
    list and I can say some columns here right and so it kind of looks weird right
    that I'm putting a list inside of brackets„ÄÇ but that's what's happening and in
    this case I'm really just interested in one thing which is just well how many
    new deaths were there on this particular day and so I do that and I get this nice
    data frame which is going work well for us and then for my Y values I can just
    directly pull it out as a series„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: And that will be death new„ÄÇTwo weeks from now„ÄÇAllÔºå so these will be my x values„ÄÇAnd
    that must be a data frame„ÄÇAnd then this Y values and this can be a series„ÄÇAnd
    in general„ÄÇ why is that when I'm trying to predict one thingÔºüBut I might be making
    a prediction based on multiple columns„ÄÇSo I'm going to head down here and I'm
    just going to copy these things„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: I'm going to copy this right here„ÄÇAnd then let me copy this right here„ÄÇIts like
    that„ÄÇAnd I train it„ÄÇ so fit means„ÄÇTo train based on the data„ÄÇSo I haven't done
    a bunch of examples of my features„ÄÇAnd my and my labelsÔºå right so I can do that
    and that's relatively uneventful„ÄÇ and I would like to be able to visualize„ÄÇWhat
    it looks likeÔºå what this model looks like„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: kind of what predictions is it making if I have new data„ÄÇ and it turns out that
    since I'm doing the linear regressionÔºå Im just one column here„ÄÇ it's actually
    going to be fairly easy to visualize because I can ask it for a given x value
    well what y value do you predictÔºü
  prefs: []
  type: TYPE_NORMAL
- en: So I can do that with thisÔºå I can say Lr„ÄÇpreect„ÄÇAnd then I can have to pass
    in some sort of value here„ÄÇ rightÔºå so I think I can pass in something likeÔºå heyÔºå
    if there's 10 new deaths to say„ÄÇ how many do I predictÔºüTwo weeks from now„ÄÇ And
    I have to pass this in as a list of listsÔºå because„ÄÇThat was the shape of this
    up here„ÄÇAnd I can see that there's also this array thing„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: which is an nu arrayÔºå we're not going to worry about that too much for now„ÄÇThe
    way I'll generally do these predictions is that I might create a data frame that
    will help me show a fit line„ÄÇ rightÔºå That's one way we can represent the relationship„ÄÇHereÔºå
    right if I drew a line on this„ÄÇ that would tell me for my x variable wellÔºå what
    do I predict for my YÔºü
  prefs: []
  type: TYPE_NORMAL
- en: And so I'm going to create a new fit data frame like this„ÄÇ that data frame and
    then I'm going to have a column„ÄÇWish will be„ÄÇDeath new remember that's the number
    of deaths today„ÄÇAnd for that„ÄÇ I'm just trying to try to put a bunch of different
    values rightÔºå Maybe I'll draw from like0 to 500„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: And let me just take a peek at that„ÄÇOkayÔºå so that's something my death new„ÄÇ
    and then what I can do is I can actually pass that whole thing in„ÄÇTo my predictionÔºå
    to„ÄÇ to basically„ÄÇFigure out what those y values are so I can say LR„ÄÇt predict„ÄÇAnd
    if I want„ÄÇ I can put in my whole data frame like that and try I find out that
    column„ÄÇ and again„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: I get a bunch of these weird valuesÔºå right in this nuy array„ÄÇBut the great thing
    isÔºå is that„ÄÇ I can say„ÄÇI want to just shove those things in a new column„ÄÇAnd I'm
    going call that„ÄÇThus„ÄÇIm I say that and then I might like to say something like
    predicted right to emphasize that this is not real data it's just a prediction„ÄÇ
    so I'm going put this up here„ÄÇAnd now when I run thisÔºå I can see that„ÄÇI have„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: For a given number of deaths on todayÔºå wellÔºå how many do I predict there will
    beÔºüTwo weeks from now„ÄÇ rightÔºå so if there's 500 deaths todayÔºå I guess I'm predicting
    that in two weeks„ÄÇ there's maybe be 160 deaths for a particular county„ÄÇAnd so
    what should I do now I can actually plot this thingÔºå I can say fit DF dot plot
    online„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: And I can say x equals this thing„ÄÇAnd I can say y equals this other thing just
    like this„ÄÇAnd„ÄÇDifferent models will give you different thingsÔºå but the linear
    regression„ÄÇRight here„ÄÇ that I'm using„ÄÇIs trying to give me a straight lineÔºå rightÔºå
    I'm going to run that„ÄÇAnd there's some sort of straight line thereÔºå and maybe
    I'll just make it red because I'm going to soon draw some new points„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: What I often like to do is after I have my regression lineÔºå I like to compare
    it to my actual data„ÄÇAnd so remember I had these similar columns beforeÔºå and that
    was all in my original data frame„ÄÇAnd for my original data frameÔºå I just want
    to draw a scatter„ÄÇOf all those points„ÄÇ And then at this pointÔºå I'm not drawing
    some sort of prediction„ÄÇ I'm actually drawing real data„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: So I'm going to do that„ÄÇAnd I guess it's drawing it down here„ÄÇ Let me actually
    try to put that on the same one„ÄÇ I'm going to say„ÄÇAX equals AX„ÄÇ and I may have
    the first one return an AX„ÄÇAnd then maybe„ÄÇAnd here I'll have the alpha B 0„ÄÇ2 again„ÄÇAnd
    why did I put AX thereÔºüThere we go„ÄÇAnd and so then I get these nice plots„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: and I can see that's far too long„ÄÇ Maybe what I should have done is I should
    have I can see my data only goes to about„ÄÇAbout 100Ôºå so maybe here I'll make my
    predictions over the range of about 100„ÄÇAnd so I'm going to do thatÔºå and I can
    see how that line fits„ÄÇÊòØ„ÄÇOkayÔºå wellÔºå how well do I doÔºå I mean„ÄÇ I might't try to
    intuit that based by looking at it„ÄÇ And really„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: what I'm looking at is for each of these points„ÄÇ WellÔºå I'd hope most of them
    are near the line„ÄÇ and I can see quite a bit of them are notÔºå rightÔºü And so the
    way we swear these things is we'll look at„ÄÇWhat is the variance in the thing we're
    trying to predictÔºü
  prefs: []
  type: TYPE_NORMAL
- en: So what is the variance and this thing of variance is kind of a measure of how
    much the values typically differ„ÄÇFrom the averageÔºå rightÔºå so I can get my variance
    and the variance in this column is 1„ÄÇ35„ÄÇAnd the idea is what we're going to do
    is we're going to say„ÄÇ well how much do each of these points differ from the average
    of the points along the y axis and then we're going to compare that to like well
    how much do they differ from that red line that I drew if the line is good then
    then that variance relative to the red line might throw down a lot„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: I'm sorry their variance relative to the red line might throw down a lot relative
    to the average which I guess I could draw as like a horizontal line„ÄÇAnd so the
    way I can do that is I can come back here and just like I fit the data„ÄÇWhere did
    I fit the dataÔºå I fit it„ÄÇRight here„ÄÇI can check„ÄÇInstead of fitting itÔºå I can score
    it„ÄÇRightÔºåAnd what this is going to tell me is how much of the variance is explained
    by the model„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: And that'll typically be a score between0 and 1 with0 being the worst and then
    one being the best and in some kind of weird cases„ÄÇ it can actually go negative
    and maybe we'll eventually talk about that„ÄÇ generally it's going be between0 and1„ÄÇAnd
    so I see this is not great„ÄÇOkay„ÄÇ let's try to do it for our other variable that
    we had as well„ÄÇ right„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: So I had this one here and just looking at the plots„ÄÇ I might expect that this
    one does a little bit better„ÄÇAnd I think what was it like 9%„ÄÇ So I'm going to
    copy these things down here„ÄÇAnd so I'm going to create a new„ÄÇA new linear regression
    object„ÄÇAnd then whatÔºå that I'm going to„ÄÇF it„ÄÇWhere was I fitting before„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: Here was how I was fitting before„ÄÇInstead of fitting„ÄÇTo the desks on today„ÄÇ
    Well„ÄÇ let me try to fit to how many„ÄÇOh this I wanted to get the number of positive
    cases„ÄÇ whereas let me go up and look at my data frame again„ÄÇ I wanted to fit to
    the average number of cases over the last seven days„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: So I'm going to do that now right I'm going to train my model by this new model
    based on this other variable„ÄÇ how can I use this to predict how many deaths there
    will be in two weeks and maybe right away I'm just going to score it as well„ÄÇ
    so maybe I'll just copy you this„ÄÇAnd then score it„ÄÇAnd I can see it's doing quite
    a bit better instead of explaining 9% of the variance„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: I'm explaining 20% of the variance if I was explaining 100% of the varianceÔºå
    well„ÄÇ that would be very remarkable because every point would be exactly on that
    line„ÄÇLet me try to plot it just like I did beforeÔºå so I'm going to copy this here„ÄÇAnd
    so I'm going to have to have this„ÄÇ and then remember that for this fit data frame„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: I had to generate that up here using a range of values„ÄÇ so I'm going to paste
    this here„ÄÇAnd so what am I going to do againÔºå I'm going to generate values from
    zero to 100„ÄÇ and that is telling me well was a positive„ÄÇSur day average cases„ÄÇAnd
    then I'm going get a prediction based on that„ÄÇ And then I can plot a line like
    that„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: I'm going do thatÔºå And I can see„ÄÇWellÔºå something a little bit weirdÔºå rightÔºå
    I guess„ÄÇI guess I didn't change everything rightÔºå I see the X axis is still how
    many deaths there were on today as opposed to what I'm actually training on„ÄÇ which
    shows the seven day averageÔºå right so let me fix that„ÄÇAnd run that again„ÄÇ And
    so that's a little bit better„ÄÇ I can see if the line doesn't extend very far„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: That makes sense previously when I was sayingÔºå wellÔºå how many deaths were there
    on a given day„ÄÇ the number was relatively small compared to the number of positive
    Covid cases„ÄÇ And and so maybe I'll redo this instead of going from„ÄÇ0 to 100Ôºå maybe
    I'll go from zero to like 900„ÄÇ and so I run that„ÄÇAnd and I can see this is a better
    F right now I'm explaining 20% of the variance instead of just nine„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: So I did something bad hereÔºå wellÔºå and I want to talk about that in the next
    video if I just want to leave you with a thought„ÄÇÂóØ„ÄÇLetÔºå let's say I'm teaching
    something in class and„ÄÇI work out an example„ÄÇAnd so maybe everybody sees that
    example and they try to learn from it if I put exactly that same answer or exactly
    that same example on any exam„ÄÇWhat does it mean that somebody does well on that
    examÔºå I think there's two possibilities„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: One is that maybe the person genuinely„ÄÇLearn something from that example and
    then even though they're seeing the same example again„ÄÇ they understand what's
    going on„ÄÇother possibility is that maybe somebody just memorized„ÄÇThe answer to
    the example„ÄÇ and then when they sit it on the examÔºå wellÔºå they just repeat it„ÄÇAnd
    that would be not so great„ÄÇ And so the same thing happens hereÔºå rightÔºå Im when
    I'm fitting„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: I'm really giving my linear regression model some examples„ÄÇüòäÔºåAnd then when I'm
    scoring it„ÄÇ well I'm actually using those same examples„ÄÇ And and so if this score
    were good„ÄÇ and I guess here it not greatÔºå but if it were goodÔºå then I wouldn't
    really knowÔºå well„ÄÇ did the model effectively memorize the answers or was it overfitting„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: Overfitting is what we mean when it basically memorizes it„ÄÇ So next time I'm
    going to talk about how we can actually deal with that problem and get a better
    sense of whether of whether it's doing a good job„ÄÇ![](img/a675287e777e7febf7b67a8d3ccaf6f7_4.png)
  prefs: []
  type: TYPE_NORMAL
