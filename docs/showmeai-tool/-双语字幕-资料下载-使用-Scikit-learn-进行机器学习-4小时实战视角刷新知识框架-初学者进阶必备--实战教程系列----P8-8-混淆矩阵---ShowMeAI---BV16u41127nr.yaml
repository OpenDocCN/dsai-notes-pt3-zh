- en: „ÄêÂèåËØ≠Â≠óÂπï+ËµÑÊñô‰∏ãËΩΩ„Äë‰ΩøÁî® Scikit-learn ËøõË°åÊú∫Âô®Â≠¶‰π†Ôºå4Â∞èÊó∂ÂÆûÊàòËßÜËßíÂà∑Êñ∞Áü•ËØÜÊ°ÜÊû∂ÔºåÂàùÂ≠¶ËÄÖËøõÈò∂ÂøÖÂ§áÔºÅÔºúÂÆûÊàòÊïôÁ®ãÁ≥ªÂàóÔºû - P8Ôºö8ÔºâÊ∑∑Ê∑ÜÁü©Èòµ
    - ShowMeAI - BV16u41127nr
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '![](img/7fa687d432e52faf3c8af2fb5cde9289_0.png)'
  prefs: []
  type: TYPE_IMG
- en: Hello in this video I may be talking a little bit about how we can score our
    models on our training data and scoring them is going to involve learning some
    new metrics and terminology„ÄÇ it turns out there's different kinds of errors and
    if sometimes well if we'll care more about one kind of error than another„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: we might want to use different metrics to deal with that taste„ÄÇSo for this I
    have some really simple dummy data Basically I have this data frame that has an
    x column and the x column is number and then the y column is a Boolean and it's
    true whenever x is positive and false when it's negative so not much data there
    and just for simplicity I'm trying to break in into the first half in the second
    half I wouldn't normally do this right because maybe the data is not shuffled
    and maybe I'm trying to getting very different data in the two half so this is
    just trying for an example there I have it I have my training data„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/7fa687d432e52faf3c8af2fb5cde9289_2.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/7fa687d432e52faf3c8af2fb5cde9289_3.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/7fa687d432e52faf3c8af2fb5cde9289_4.png)'
  prefs: []
  type: TYPE_IMG
- en: And my test data down here and if I want to try to figure out what is the relationship
    between Y and x„ÄÇAnd then measure the model's understanding of that relationship
    I'm going to use some sort of scoring function right I'm going to do this whole
    logistic regression remember this is not really a regression„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: it's actually a class ofifier right because I have this categorical data that
    I'm trying to predict„ÄÇAnd so I'm going to train one of those and then I want to
    score it„ÄÇFirst step„ÄÇ right is I'm going to say LR equals logistic regression„ÄÇ![](img/7fa687d432e52faf3c8af2fb5cde9289_6.png)
  prefs: []
  type: TYPE_NORMAL
- en: RightÔºå and then we say Lr„ÄÇt fit„ÄÇAnd when I'm fitting„ÄÇLet me I should just try
    to run this„ÄÇ![](img/7fa687d432e52faf3c8af2fb5cde9289_8.png)
  prefs: []
  type: TYPE_NORMAL
- en: Once I runÔºå I can actually set shift tab and into a hint„ÄÇ![](img/7fa687d432e52faf3c8af2fb5cde9289_10.png)
  prefs: []
  type: TYPE_NORMAL
- en: I'm have to give it the X data and the y dataÔºå and so I'm going to give it both
    those things from the training data first„ÄÇ![](img/7fa687d432e52faf3c8af2fb5cde9289_12.png)
  prefs: []
  type: TYPE_NORMAL
- en: And so I'm going to say training data and then the columns I want are just acts„ÄÇAnd
    then other thing I'm trying to predict is just the why man you just like that„ÄÇ![](img/7fa687d432e52faf3c8af2fb5cde9289_14.png)
  prefs: []
  type: TYPE_NORMAL
- en: And then after I do thatÔºå I can basically„ÄÇI run a command that's very similar
    and that command is score„ÄÇ I can evaluate how well it does„ÄÇThe test data„ÄÇAnd I
    get 0„ÄÇ75„ÄÇ So what is this score function doing„ÄÇ It turns out it's a shortcut and
    I'm just going to show you a little bit in the documentation what it's doing„ÄÇ
    I head over here I see that the score function„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/7fa687d432e52faf3c8af2fb5cde9289_16.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/7fa687d432e52faf3c8af2fb5cde9289_17.png)'
  prefs: []
  type: TYPE_IMG
- en: Or the logistic regression is giving me the mean accuracy„ÄÇ And if you look at
    other estimators„ÄÇ they might be doing other kinds of using other metrics for the
    scoring„ÄÇOkay so mean accuracy so that's the default here but it turns out there's
    lots of different metrics we could use and so if I go to the metrics page for
    PsyKt learn I can see that hey there's a whole bunch of metrics here related to
    classification clustering which we haven't talked about yet and then a whole bunch
    related to regression as well and so the one I'm using right now the default is
    that accuracy score right you saw that how it's saying here that we're just getting
    the accuracy accuracy is very simple it's well what percentage of the timesÔºü
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/7fa687d432e52faf3c8af2fb5cde9289_19.png)'
  prefs: []
  type: TYPE_IMG
- en: Did we get it right and so I certainly could have instead of using that score
    function I could have used this one myself and I think that's a good thing to
    do right now because once you understand how to use this manually without the
    shortcut then we'll understand how to use these other functions as well Okay so
    I can see this is my metrics submodule and so when I head back here I'm going
    to do this I'm going to say„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: And this was that page I was just on„ÄÇI am going to sayÔºå from„ÄÇFrom SK learn metrics„ÄÇImport„ÄÇ![](img/7fa687d432e52faf3c8af2fb5cde9289_21.png)
  prefs: []
  type: TYPE_NORMAL
- en: Accuracy score„ÄÇOkayÔºå and let me just run that and what I call accuracy score„ÄÇI
    hit shift tab here„ÄÇ Basically what I'm doing is I'm sayingÔºå wellÔºå what are the
    true valuesÔºü
  prefs: []
  type: TYPE_NORMAL
- en: And what did my model predict„ÄÇOkay and so there different ways I could do that„ÄÇ
    I mean I could say wellÔºå the true values are A and BÔºå but I actually predicted
    A and C„ÄÇ and it turns out if I do that well I're just 50% right right so this
    was my actual values and my predicted values„ÄÇSo let me actually try to get these
    from up aboveÔºå right so before I was trying this score thing„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: And then I was kind of giving my x values and my y valuesÔºå and so I'm going
    to pull pieces from this„ÄÇThe first piece I'm going to do is I'm going to actually
    figure out what the predicted values are„ÄÇSo those are going to be the predicted
    values I actually have to call predict here instead of score right when I'm predicting„ÄÇ
    I'm not giving it any y values right predict tells me what the y values are„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: And and then I also have to have my actual rightÔºå my actual„ÄÇWas just the second
    piece from before„ÄÇOn that column„ÄÇSo maybe actually let me just do thisÔºå I'm going
    to say„ÄÇLet me look at the actual values and the predicted values„ÄÇAs a last„ÄÇOkay„ÄÇ
    and I can see actual we're trueÔºå trueÔºå falseÔºå false„ÄÇBut I'm actually getting trueÔºå
    falseÔºå false„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: false„ÄÇ And so the second one is the errorÔºå rightÔºå So I'm going be wrong 25%
    of the time„ÄÇ And so accuracy is actually going to be 70„ÄÇ5%Ôºå which is what we saw
    before and we're going to see it here too„ÄÇ when we actually pass in„ÄÇThese two
    things I pass in the actual values and those predicted values„ÄÇI not get that at
    75%„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/7fa687d432e52faf3c8af2fb5cde9289_23.png)'
  prefs: []
  type: TYPE_IMG
- en: OkayÔºå now so that works fine but there's going to be cases where we don't want
    to just know how often we're right„ÄÇ but we want to know about you know about what
    kind of mistakes we're making right so for example„ÄÇ let's imagine different things
    that this Y column might be let's say that this Y column means it's a good investment„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/7fa687d432e52faf3c8af2fb5cde9289_25.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/7fa687d432e52faf3c8af2fb5cde9289_26.png)'
  prefs: []
  type: TYPE_IMG
- en: Maybe it's for a stock or something„ÄÇ I don't need to know about every good investment„ÄÇ
    but if I have some system that kind of tells me like hey these are some good investments
    and it's always right and it doesn't tell me about every good investment that's
    a pretty good system in contrast„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: maybe this is telling me I don't know is somebody contagious for CoVd-19 or
    whatever„ÄÇ right And in that caseÔºå it's much safer to make the mistake of saying
    they are contagious even though they're not„ÄÇ so there's different kinds of errorsÔºå
    false positivesÔºå the false negatives„ÄÇ And so there's a lot of metrics based on
    that And the simplest place to start is with something called a confusion matrix
    and a confusion matrix„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/7fa687d432e52faf3c8af2fb5cde9289_28.png)'
  prefs: []
  type: TYPE_IMG
- en: Shows the categories that things actually are and then how they mistakenly get
    classified as other things„ÄÇüòä„ÄÇ![](img/7fa687d432e52faf3c8af2fb5cde9289_30.png)
  prefs: []
  type: TYPE_NORMAL
- en: And so just like beforeÔºå just like we have an actual a predicted list„ÄÇ and we
    have a confusion matrix we're going to do the same thing„ÄÇSo imagine I had pictures
    of animals and youÔºå I had four dogsÔºå three cats and two mice„ÄÇAnd but then I have
    some machine learning system that's looking at those pictures„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: And as maybe predicting these other things„ÄÇWhat I could do is I could read a
    confusion matrix„ÄÇUsing Psyit learnÔºå rightÔºå this is also under metrics just like
    accuracy score„ÄÇAnd so I can create one of these„ÄÇ And and just like with the accuracy
    score„ÄÇ I can put the true values and then the predicted values or sometimes I
    I say actual„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/7fa687d432e52faf3c8af2fb5cde9289_32.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/7fa687d432e52faf3c8af2fb5cde9289_33.png)'
  prefs: []
  type: TYPE_IMG
- en: And predicted„ÄÇAndÔºå and this is a little bit confusingÔºå because„ÄÇEach one of these
    values is kind of showing us„ÄÇHow many categories fall into like a specific actual
    category in a predicted category„ÄÇAnd it's not really clear to line it upÔºå rightÔºå
    well is this first wrong dog or is it cat„ÄÇ And so what people will often do right
    is that they'll say labels„ÄÇLike this„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: And just to control the order„ÄÇ So for exampleÔºå I want to say like at a dog„ÄÇThe
    mouseÔºå just like that„ÄÇAnd then if I pass in these labels„ÄÇIt's going to be a little
    bit differentÔºå right„ÄÇ whereas if I say dog„ÄÇYou can see these numbers switched
    a little and another reason for this beside just controlling the order„ÄÇ so it
    makes sense is that I couldÔºå you know maybe there's things that I know exist but
    didn't even show up in the data right there's no horses„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: rightÔºü
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/7fa687d432e52faf3c8af2fb5cde9289_35.png)'
  prefs: []
  type: TYPE_IMG
- en: SoÔºå so let me actually„ÄÇI'm really trying to talk about what these numbers mean
    and I think it'll be a little easier to put in a data frame and I'm going to put
    this in a confusion matrix here„ÄÇAnd now I me to put this in a data frame„ÄÇA PD
    data frame„ÄÇInfusion matrix„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: And then when I'm printing a data frame from thisÔºå both the index and columnm
    labels„ÄÇAre going to be the same right I'm going to have„ÄÇE it just be like this„ÄÇ![](img/7fa687d432e52faf3c8af2fb5cde9289_37.png)
  prefs: []
  type: TYPE_NORMAL
- en: And and so when I'm looking at this confusion matrixÔºå what does it mean„ÄÇ So
    the row means what it actually is„ÄÇ![](img/7fa687d432e52faf3c8af2fb5cde9289_39.png)
  prefs: []
  type: TYPE_NORMAL
- en: And the column is going to be what it got„ÄÇClassified as so I can see in this„ÄÇ
    right that there's four dogs„ÄÇAnd of those four dogsÔºå it correctly classified three
    of them as dogs„ÄÇBut one of the dogs was mistakenly identified as a cat„ÄÇOkay„ÄÇ it
    looks like there are three cats in the system„ÄÇ Two of them were correctly identified
    as cats„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: And one was considered a dog„ÄÇAnd then I can see other things here like well
    the system's really good at mice right it always correctly calls the mice and
    doesn't mix them up with anything and so this is useful right when I have a this
    time matrix I can see what ways the classifier is confused since it's called you
    a confusion matrix right showing me how the model is confused„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: All rightÔºå so hopefully that's helpful now it's very common that we'll be having
    these confusion matrices„ÄÇüòä„ÄÇ![](img/7fa687d432e52faf3c8af2fb5cde9289_41.png)
  prefs: []
  type: TYPE_NORMAL
- en: where the class is instead of being you know different animals„ÄÇ it might just
    be true and false that would be for a binary class of fire where I just have these
    true and false values and so let me actually go back to what I had before right
    when I was computing this accuracy score„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/7fa687d432e52faf3c8af2fb5cde9289_43.png)'
  prefs: []
  type: TYPE_IMG
- en: '![](img/7fa687d432e52faf3c8af2fb5cde9289_44.png)'
  prefs: []
  type: TYPE_IMG
- en: And let me create a confusion matrix hereÔºå and maybe I just may copy some of
    this„ÄÇ![](img/7fa687d432e52faf3c8af2fb5cde9289_46.png)
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/7fa687d432e52faf3c8af2fb5cde9289_47.png)'
  prefs: []
  type: TYPE_IMG
- en: Out hereÔºå as you might grab this„ÄÇ![](img/7fa687d432e52faf3c8af2fb5cde9289_49.png)
  prefs: []
  type: TYPE_NORMAL
- en: And in this caseÔºå the labels„ÄÇAre false and true„ÄÇ![](img/7fa687d432e52faf3c8af2fb5cde9289_51.png)
  prefs: []
  type: TYPE_NORMAL
- en: And it doesn't do anything okayÔºå so I have these different categories and just
    like before„ÄÇ I think it's going to be helpful to put this in a data frame„ÄÇ![](img/7fa687d432e52faf3c8af2fb5cde9289_53.png)
  prefs: []
  type: TYPE_NORMAL
- en: Right„ÄÇ![](img/7fa687d432e52faf3c8af2fb5cde9289_55.png)
  prefs: []
  type: TYPE_NORMAL
- en: I'm going to put a data frame here just like that„ÄÇAnd so here again„ÄÇ the row
    is telling me what it actually is and then the column is telling me how those
    got classified and ideally in a perfect world everything will be on the diagonal
    right that means there were no mistakes made there was no confusion„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: OkayÔºå so I have that and it turns out there are special names for each of these
    four values„ÄÇ and so I'm just going to go through this quickly„ÄÇ![](img/7fa687d432e52faf3c8af2fb5cde9289_57.png)
  prefs: []
  type: TYPE_NORMAL
- en: ÂëÉ„ÄÇThe top left oneÔºå actuallyÔºå let's start with the bottom rightÔºå so if I go
    to I go to„ÄÇ let me put this in a date actual data frame„ÄÇThe last to my confusion
    matrix is a data frame now„ÄÇ![](img/7fa687d432e52faf3c8af2fb5cde9289_59.png)
  prefs: []
  type: TYPE_NORMAL
- en: OkayÔºå and and I goÔºå I love„ÄÇ1Ôºå1Ôºå that's going to be that bottom right„ÄÇ![](img/7fa687d432e52faf3c8af2fb5cde9289_61.png)
  prefs: []
  type: TYPE_NORMAL
- en: That's going to be called through„ÄÇPositives in your practice kind of remembering
    these words are important terminology„ÄÇ so I'm going to do this and then if I had
    been smart with this example„ÄÇ I would have made sure all these numbers were different
    so we could more easily identify„ÄÇRightAnd another number is on the top left„ÄÇAnd
    those are true negatives„ÄÇ right„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: So true means that that the model is doing the correct thingÔºå Right in this
    caseÔºå I have„ÄÇone„ÄÇ you know what I should really do is I should do it like this„ÄÇThrough
    positives„ÄÇThroughru negatives„ÄÇ rightÔºå people often abbreviate it this way„ÄÇAnd
    then there's the mistakesÔºå right„ÄÇ the mistakes are falseÔºå rightÔºå so I'm going
    to say false„ÄÇAnd false„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: And so what are these called the false positivesÔºüAllÔºå where are those„ÄÇ So false
    positive means that„ÄÇThis column right and so it should be false right that's what
    it actually is in the data„ÄÇ but it gets classified as true right so what does
    that mean that means I'm in row0 column1„ÄÇAnd then up I sit down hereÔºå rightÔºüSometimes„ÄÇIt
    actually is trueÔºå but the model says it's false„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: That's a false negative„ÄÇ![](img/7fa687d432e52faf3c8af2fb5cde9289_63.png)
  prefs: []
  type: TYPE_NORMAL
- en: And fall negative and just like that so these are the four different cases I'd
    have and a lot of the statistics we're going be looking at into the next video
    are combinations of these and I'll be kind of talking more about why those are
    meaningful„ÄÇ![](img/7fa687d432e52faf3c8af2fb5cde9289_65.png)
  prefs: []
  type: TYPE_NORMAL
