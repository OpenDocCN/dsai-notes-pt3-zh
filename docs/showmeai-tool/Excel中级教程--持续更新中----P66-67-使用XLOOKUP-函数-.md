# Excel中级教程！(持续更新中) - P66：67）使用XLOOKUP 函数 

![](img/797f4cc0ad75088c1560e826b4d80aeb_0.png)

在这个视频中，你将学习如何在微软Excel中使用Xlookup函数，多年来，Excel中最常用的函数之一是Vlookup函数，还有Hlookup，这两个函数都非常强大，但相对较新的Xlookup函数超越了这两者，许多用户将不再需要使用Vlookup或Hlookup。那么Xlookup的目的是什么？它基本上使你能够利用已有的信息查找相关信息，所以你可以看到这里我有一个虚构企业的员工列表。

我们左侧有员工姓名，员工编号、部门、薪资等。假设我需要根据员工编号查找员工，可能每次他们登录网站或填写表单时，输入他们的员工编号，我可以使用Xlookup在这个文档中搜索他们的员工编号，然后我可以获取他们的姓名，并且在这种情况下，我也希望能得到他们所属的部门和薪资，所以我将在H2单元格点击，写出使用Xlookup函数的公式，我会输入等于Xlookup，正如我输入时，你可以看到Excel推荐我使用Xlookup函数，我可以直接点击选择，或者继续输入。接下来，我会输入左括号，像往常一样，此时。

微软Excel正在给我一些提示，以帮助我成功编写剩下的公式，Excel现在在寻找查找值，换句话说，我知道的信息是什么？在这种情况下，我知道员工编号，正如我在例子中所说的，员工编号在他们上网或填写表单时记录，所以这是我们知道的，我们知道他们的编号，但不知道他们的姓名、部门和薪资，因此我可以输入一个特定的员工编号，也许就是这个。

在公式中，如果我愿意，可以直接输入，但在许多情况下，更强大的是点击一个单元格，最终输入你希望Xlookup查找的编号或项目。在我的例子中，我已经写好了这个编号，它在左侧的G2单元格中，所以我会点击G2，当然，我可以稍后更改这个编号，但公式总是会查看G2中的内容。

这就是它将要搜索的查找值。接下来，我输入一个逗号。你可以看到Excel现在在寻找查找数组。我希望Excel在G2中搜索的内容在哪里？我希望它在A列中搜索吗？不，不会在A列中找到这个编号。那B列呢？也不在那里。

我需要选择C列，因为员工编号存储在这个电子表格中。你可以看到Excel做了什么，它填入了C：C。换句话说，就是整列C。我会放一个逗号。接下来，Excel正在寻找所谓的返回数组。换句话说，我知道查找值。我已指定在C列查找这个查找值。

我想要返回的是什么？我想要看到的是什么？那么，在这种情况下，我希望它返回员工的名字。所以这很简单。我只需点击A列，就在这里选择整个列。或者，我也可以输入A：A，接下来加上一个逗号。那么，如果找不到呢？

如果Excel搜索所有员工编号但找不到这个数字呢？那么它无法返回名字，我希望它返回什么呢？我可以直接跳过这一步，删除那个逗号，输入右括号。如果你不想的话，甚至可以不放括号，然后按回车。

你可以看到它有效。所以在没有填写“如果找不到”时它也能工作。但在这种情况下，我认为我确实想填写一些内容。我会放一个引号，输入单词none，然后再放一个引号。然后我可以放入.Com，现在我只需告诉Excel我想要什么样的匹配？

我是否要求Excel找到这个员工编号的精确匹配？在我的情况下，是的，因为员工编号相近并不意味着太多，必须是完全一致的，注意这就是默认值。所以如果你跳过这一步，它会默认设置为精确匹配，这很好，这与Vlookup有一点不同。如果你不想要精确匹配，可以看到这里有其他选项，这些都是很好的选择。

我只需放一个零，这样就会是精确匹配了。我也可以不填写那个空白，放上一个逗号，最后一步是我想要什么样的搜索？我想从上到下搜索，还是从下到上？有升序的二分搜索和降序的二分搜索，这些最终并不是那么重要，所以我就停在精确匹配这里。

输入右括号。同样，我可以省略掉0，或者省略掉引号中的none，我本可以在这里停下来。但我会在0后停下来，按下键盘上的回车键。你可以看到，Excel使用了X查找公式来在C列中搜索这个数字。

找到了。让我们看看它找到哪里。好的，就在那里。对应的是在通讯部门的Nick Robinson。好的，我们回到顶部。Nick Robinson。所以它确实有效，找到了正确的员工。对于那些看过我其他Excel教程的人来说。

你知道我不需要为下一个员工编号重复那些步骤。我不需要从头开始公式。我只需点击尼克·罗宾逊。如果你仔细想想，表面上看我在点击尼克·罗宾逊，但实际上我并没有。这个单元格并不真正包含尼克·罗宾逊。它包含这个公式。

这个公式在这种情况下会生成尼克·罗宾逊。所以如果我点击右下角的单元格，即自动填充手柄，那小绿色方块，我可以点击并拖动，它会复制并扩展H2的内容到电子表格下方。我们继续往下，我不会在第6行停下，我会继续到第7行，你将看到使用自动填充手柄发生了什么。注意我的公式复制并粘贴了。

但它也扩展了数字，基本上在H2中你可以看到行号是G2，而在H3中你可以看到行号是G3。所以它扩展了这个数字，进行了调整，其他的也是如此。因此，我能够很快查找员工编号并返回员工姓名。现在这个返回了a0，为什么？因为G7在这种情况下是空的。现在，如果我随便输入一个不在我的列表中的员工编号，如果我尝试这样，注意它显示。

None，它会这样做是因为我在公式中包含了它。但如果完全为空，它只会显示0。现在，我刚刚演示了使用XLOOKUP来获取员工编号并向左查找员工姓名。

使用旧的VLOOKUP无法做到这一点，VLOOKUP无法向左获取信息。它必须向右查找。因此，XLOOKUP的一个优点就是不管是左、右、上、下，它都可以朝那个方向查找并找到信息。让我们再试一次，但这次用部门。我会输入等于XLOOKUP。

我可以基于员工姓名或员工编号来设置这个。其实没有关系。我再用员工编号一次，再次，我需要输入查找数组。换句话说，Excel应该查找哪个列或范围来寻找员工编号。好吧，是C列。所以我点击C以选择整列，返回数组是什么。

我关心的信息是什么，我想了解和查看的，在这种情况下是部门。所以我会点击D列。我会输入一个逗号和引号。我会输入单词none，以防输入的数字与任何员工编号不匹配。在这种情况下，我将跳过匹配模式和搜索模式，因为在这个例子中它们并没有太大关系。如果你记得，XLOOKUP默认是精确匹配。

所以它会尝试找到这个数字的精确匹配，这正是我想要的。因此，我将输入右括号，按下键盘上的回车，尼克·罗宾逊在通讯部工作。我可以使用自动填充手柄，双击它将其扩展到整列，这样我就不需要点击和拖动，你可以看到它找到了这些员工的部门，我们可以用同样的方法处理工资，X lookup 的查找值可以是员工编号，但我想向你展示它并不一定非得如此。所以这次我将选择员工姓名作为查找数组。

这次员工姓名在 A 列。返回数组是什么？我想查看的信息是他们的工资。所以这是 E 列。此时，我应该输入右括号，但我只是敲击回车，以演示其实你并不真的需要输入，它就能产生工资。我只需双击自动填充手柄将其填充到整列，之后就可以了。

我只是再复制粘贴一个员工编号，以便你可以看到它在所有单元格中都能正常工作。此时，如果我想，我可以选择 J 列，在“主页”选项卡的数字组中。我可以将该数字更改为货币格式，这样你就能知道这是工资。我可能还想选择这个范围，并通过设置背景颜色将其与电子表格的其他部分区分开来。

现在我可以使用这个电子表格的部分作为一个表单，来查找一个员工编号或一系列数字。因此，我将清除这些单元格的内容，并且我会选择其中一些数字，将它们粘贴进来，你可以看到姓名、部门和工资都被查找出来，方便我查看。

所以我希望你能看到使用 Xlookup 的一些潜在价值。它比旧的 Vlookup 更加简单、直接和强大，同时也替代了 H lookup。我喜欢它可以向左或向右查找，而且它默认精确匹配。现在，正如微软在其较新功能中常做的那样。

它正在逐步推出，目前在 Microsoft 365 版本的 Excel 和其他这些版本中可用。最终，我预计它会出现在所有现代版本的 Microsoft Excel 中。如果你的 Excel 版本中没有 Xlookup，你一定要查看我的 vlookup 教程，然后当然请在你获得 Xlookup 的访问权限后，回来观看这个视频。

![](img/797f4cc0ad75088c1560e826b4d80aeb_2.png)
