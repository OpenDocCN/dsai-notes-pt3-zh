# 【双语字幕+资料下载】PySpark 大数据处理入门，带你玩转Python+Spark大数据操作与分析！＜实战教程系列＞ - P3：L3- Pyspark DataFrames 处理缺失值 - ShowMeAI - BV1sL4y147dP

。

![](img/e973b83e1babc963d0d6504ca497ee4d_1.png)

嗨，我的名字是Krisna，欢迎来到我的UD频道。所以大家，我们将继续Pipar系列，我已经上传了两个关于Pi Sp的视频。今天我们实际上开始了对Pipar数据框的理解，今天我们将继续。这可能是教程3，关于数据框操作的第三部分，在这个视频中我们将看到如何处理缺失值。

空值。所以简而言之，这些事情我们都会尝试做，我们会看到如何丢弃列，我们会看到如何丢弃行，然后我们会看到在丢弃行时，可能基于空值尝试丢弃行，然后我们将尝试看看丢弃功能中的各种参数，以及如何通过均值、中位数或众数处理缺失值。所以在这里我将写作均值、中位数和众数，可能所有这些我们实际上都会再次看到。

主要的是我真的想向你展示我们如何处理缺失值。😊。![](img/e973b83e1babc963d0d6504ca497ee4d_3.png)

缺失值，这非常重要，因为在pandas中我们也会尝试在技能中做到这一点。我们有一些重要的函数。所以让我们继续。每当我们通常开始一个Pipar时，当我们使用Pipar工作时，我们真的需要启动一个Pipar会话。所以我希望到现在为止你们都熟悉了。因此我写`Pipar.sql`，我将要导入。

Spark会话。好的，然后我将创建一个变量并命名为spark。然后在这里我将写`spark session.build`。好的，点`app name`。让我将这个应用名称设置为practice。好的，因为我只是在练习一些东西。然后我写`get or create`并执行这个。

所以这可能需要一些时间来执行。是的，它已经成功执行了。现在为此，我刚刚创建了一个非常简单的数据集，内容如下。我有一个列，包含姓名、年龄、经验和薪水。这些都是我的候选人姓名，可能有一些值留空了，你可以看到一些值留空了。所以我们将尝试看看如何丢弃空值，或者如何处理这些缺失值。

所以让我们继续，首先，为了读取数据集，我将写`spark.read`。😊。点`CSsv`，在这里我将使用CSsv文件名`test2.cv`，它保存在与此特定文件相同的位置。无论如何，我将在这个GitHub中提供链接，并且我将使用`header=true`，可能还有`infer schema=true`。

我将能够正确获取数据集，所以当我读取这个时，你会看到这是我实际上获得的数据框，如果你想看到整个数据集，你可以使用点显示。这里就是你的整个数据集。你有空值，完美。那么。

让我做一件事。让我把这个保存在一个变量中。所以我会写 D F 下划线 co I spark。那么如果我去检查一下。点显示。这是我的整个数据集。好的，完美。到这里我们差不多没问题。我们在这方面工作得很好。我们知道实际上已经读取了一些数据集，现在，可能是第一个。

让我们开始看看如何删除列。删除列非常简单，伙计们。假设我想删除名称列。那么我只需使用 D F 点 drop 并提供我的列名，就像这样。对吧？所以列。😊，对，列名，假设我写 Df 点价格 spark。这里的列名将是名称。所以让我写成名称。

我基本上可以去查看我的点 show。然后你将能够看到所有实际写入的功能。这非常简单，我在之前的课程中也可能给你展示过，好的。基本上就是这样删除你的特征或列。但是我们主要关注的是删除非值。所以现在。

让我写 Df 点 by spark 点 show。所以这是我的数据集，现在让我们看看如何根据空值删除特定行。这里，我只需使用 D 点 by spark 点 na 好吧，有一个叫做 N 的东西。然后你有 drop、fill 和 replace。所以首先，我会从 drop 开始。现在，在这个特定的 drop 中，记住如果我什么都不提供。好的，然后执行它。

在这里。你会看到所有空值的行都会被删除。所以你会看到最后三行不在，对吧。所以在这里你可以看到到 shubum 这个特定的值是存在的。其余的所有行都被删除了。完美，对吧，所以完全没问题。

所以这里，简而言之，你所做的是每当你使用点和 a 点 drop 时，它只会删除那些实际存在 na 值或空值的行。好的，完美。这些都没问题。如果我去搜索 drop，有两个主要功能。一个是如何，另一个是阈值。还有一个是子集。

那么让我们尝试理解这个特定的功能。现在，首先，我将开始如何。😊。任何等于如何，我就这样写。好的。所以假设如果我写 D F 点 Pipar 点 any 点 drop。如果我的。如何的值可以有两个值，一个是 any，一个是 all。好的，一个是 any，一个是 all。

如果选中的值为任何下拉或行，且包含任何空值。即使只有一个空值，好吧，一个空值或两个空值，或者全部为空值。你知道，默认情况下，它会被删除。好的，但所有等于什么？我们何时使用所有，这基本上意味着假设在你的特征中，你有。

假设在你的行中，所有值都是空。在这种情况下，你有361个值。这不会被删除，但如果在某个记录中所有值都是空，那只有在这种情况下它才会被删除。好的，所以让我们看看这是否能工作。绝对不会工作，因为我知道至少有一个值是存在的。

1个值，1个非空值总是存在的，对吧？如果我使用的是所有，它将删除那些完全为空的记录。默认情况下，这个值应该是任何值，所以默认情况下，它是任何值，基本上意味着是否有一个空值或两个空值。

你只是要删除那些特定的记录，基本上很简单。这就是怎么回事。现在，让我们继续尝试理解阈值。这是什么阈值。我会告诉你这个阈值是什么。现在，让我先用这个，好的。我知道如何处理任何值，但还有一个选项叫做阈值。

在阈值中，我们所做的是假设我写，设定阈值为2。这基本上是说。在这个特定情况下，如果阈值值为2，好的，首先执行一下。你会看到最后一列被删除了。好的，最后一行被删除了，为什么被删除？因为我们设定了阈值值2，这表示至少需要两个非空值。

😊好的，至少两个非空值。现在，这里你有两个非空值，比如40000。好的。这里，你只有一个非空值。由于这个原因，它被删除了。如果你在这里有两个非空值。看看34和10，这没有被删除。这在这里也是一样，3410，对吧，34，10。如果我在这里给你展示3410和38000，至少这里你有三个非空值，那里你有两个非空值。

所以这里，每当我们设定某个阈值为2。这基本上会检查在特定行中，是否至少有两个非空值。如果有，它就会保留该行，否则，它就会删除，这就是你可以检查的。

所以如果我去查看一个，你会看到所有这些特定的行都在那，因为它会去检查。这里有非空值，如果我把它设为三，好的。让我们看看结果会是什么。😊现在，你可以看到至少剩下的所有内容都被删除了，对吧？看这里，你只有两个非空值，这里你加了三个。

这是3410，38000和nu。所以在这里你可以看到这个值。这是关于阈值的理解。现在，让我们继续下一个，称为子集。所以我将在这里写为subset，因为这是我draw feature中的第三个参数。请记住，这些特征如果你曾在pandas中工作过，都是相当简单的，我们正在处理的也是子集。

在子集中，我们实际上可以提供。假设我在子集里说，去掉阈值。我不想保留任何阈值。假设我只想从特定列中删除N值，可能只从经验列中。然后我可以将其作为子集，从经验列中你可以看到在记录中所有的na值。所有这些记录都被删除了，所以你可以这样应用。

假设你想在年龄中应用它，你也可以在年龄列中应用这个，任何没有值的记录都会被删除。所以这是关于子集的内容。我希望你们能理解，伙计们。这非常好，因为我们实际上正在尝试应用我们在pandas中所做的事情，这在处理缺失数据时非常方便，好的。😊，我们继续下一个内容。

让我们去填补缺失值，填补缺失值。现在。为了填补缺失值，我将使用Ipar.dot fill。🤧。好的，抱歉，any.dot fill。好的，里面这个fill将接受两个参数。一个是值，另一个是子集。好的，现在假设我这样给出值。

假设我说缺失值。如果我写.dot show。那么它将把所有的n值替换为缺失值。所以你可以看到这里有一个null值。所以缺失值，缺失值，缺失值缺失。假设你真的想在特定列中执行缺失值处理。

然后你可以像这样写你的列名。这将是我的X subset。好的。我也可以这样提供多个记录。看，我还可以提供多个exs，比如经验，commarma，可能是年龄。Goma。H。在列表中，当我这样提供时，这种功能将在两列中发生，简单得多。所以伙计们。

现在下一步，我们要做的是选择一个特定的列，可能会通过该特定列的均值或中位数来处理缺失值。所以现在如果我查看我的D.dot spice spark，看看我的.dot show值。

这是我的整个数据集。现在我将采取这个经验列，并可能用经验的均值替换空值。为此，我将使用一个**填补**函数。大家。

如果你了解**填补**函数，我们基本上是通过**Scikit-learn**来使用它，在**Pipar**中也有一个填补函数。所以我将复制并粘贴代码，让它非常简单，从**Pipar**的**Ml.feature**中填补，输入我的输入列，即年龄、经验和薪资。我可能想对这里的每一列都应用，然后我只是说，对于年龄、经验和薪资，我将找到这个**.format**来输出列，并将策略设置为**均值**，你也可以将策略更改为**中位数**、**众数**等。

我将执行这个，执行顺利，然后我们将写**fit**和**transform**。所以填补**.fit**和**Pipar**的**.transform**。一旦我执行，😊，你们将看到我们将创建多个列，命名为**underscoreco imputed**。所以你可以看到**age underscoreco imputed**，简而言之，我们尝试了一种均值功能，这基本上意味着空值被均值替换。在这里你可以看到，这个空值被替换为28，类似地，这个空值被替换为10，抱歉5。这是经验填补列，你会看到每当有空值时，它都被经验列的均值、年龄列的均值和薪资列的均值替换。如果你真的想使用**中位数**，只需将均值更改为中位数，然后在这里执行，现在你将能够看到中位数值，这里是你的初始空列，抱歉，这里是具有空值的列，这里是所有基本上填补了值的列。

我希望你们喜欢这个特别的视频，大家这是关于教程3的。在这个视频中，我们尝试了解如何删除列、删除行，以及如何检查与删除功能和处理缺失值相关的各种参数，使用**均值**、**中位数**和**众数**。

你也可以尝试**众数**。这取决于你，你完全可以试试看是否能够做到。所以我希望你喜欢这个特别的视频。如果你还没订阅频道，请订阅，我会在下个视频中见到大家，祝你有个美好的一天。

谢谢，再见。😊！[](img/e973b83e1babc963d0d6504ca497ee4d_5.png)
