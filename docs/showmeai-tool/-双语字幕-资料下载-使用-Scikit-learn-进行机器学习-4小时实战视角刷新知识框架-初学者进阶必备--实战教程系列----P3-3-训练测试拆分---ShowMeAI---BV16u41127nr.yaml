- en: „ÄêÂèåËØ≠Â≠óÂπï+ËµÑÊñô‰∏ãËΩΩ„Äë‰ΩøÁî® Scikit-learn ËøõË°åÊú∫Âô®Â≠¶‰π†Ôºå4Â∞èÊó∂ÂÆûÊàòËßÜËßíÂà∑Êñ∞Áü•ËØÜÊ°ÜÊû∂ÔºåÂàùÂ≠¶ËÄÖËøõÈò∂ÂøÖÂ§áÔºÅÔºúÂÆûÊàòÊïôÁ®ãÁ≥ªÂàóÔºû - P3Ôºö3ÔºâËÆ≠ÁªÉÊµãËØïÊãÜÂàÜ
    - ShowMeAI - BV16u41127nr
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '![](img/816ece20f67a7bafdafc76312ab6259f_0.png)'
  prefs: []
  type: TYPE_IMG
- en: So last time I talked about this issue of basically evaluating our model on
    the same data we fit it to„ÄÇ right the model can effectively memorize an answer
    and look like it is doing well even if it didn't really learn anything„ÄÇAnd so
    the way we'll deal with this problem is we'll use something an SK learn called
    a train test split„ÄÇ and this is a general strategyÔºå but this specific method will
    make it easy for us„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: And what we'll do is I'll take our original data frame and give us back two
    data frames„ÄÇWe'll train our model to one data frame and then we'll evaluate it
    on the other one on the data the model has not seen before„ÄÇ and so it's a better
    test of whether it's doing well„ÄÇAnd so I can see that there's a number of things
    I can pass into this one is I can say well what ratio of my data would I like
    to go into my test set I can say other things like try to stratify the data like
    let's say I was dealing with something categorical„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: I might want to make sure that I'd have a similar number of categories on both
    sides I'm not trying to do that here„ÄÇ but I will specify a trained test set„ÄÇ![](img/816ece20f67a7bafdafc76312ab6259f_2.png)
  prefs: []
  type: TYPE_NORMAL
- en: So let me import this thingÔºå I'm going to say„ÄÇFrom SKLn import oh it's SKLn„ÄÇt
    model selection„ÄÇImport„ÄÇ trainÔºå testÔºå split„ÄÇOkayÔºå and then I'm going to say try
    and test split„ÄÇAnd I'm going to try to try split on my data frame that I have
    originally„ÄÇAnd„ÄÇBasically„ÄÇ it's returning something called an array with two data
    frames in it„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: and so the way I can capture this is I can say well I have my train data frame
    and my test data frame is order is to to return them in„ÄÇAnd so let me take a look
    at these„ÄÇ Here's my train data frame„ÄÇAnd then here is my test data frame„ÄÇAnd you
    can see that it kind of shuffled things around right if I look at the index„ÄÇAnd
    I'm dealing with different data right so this is the data frame that my model
    is going to learn from and then this other one is the one I'm going to use to
    actually make sure it learns something„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: And so I can see right now if I look at thisÔºå there's 6Ôºå300 down here and then
    19Ôºå000 up here„ÄÇAnd that's because the default split is 0„ÄÇ25Ôºå so I could do something
    like this if I want„ÄÇAnd then that would make this first one bigger and the next
    one smaller„ÄÇ So I'm going to do that„ÄÇ Oh„ÄÇ and then let me just see what I did
    wrong here„ÄÇ I think I actually have to say test size„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: So I'm going say test size equals that„ÄÇAnd then this is going to be a little
    bit bigger„ÄÇ more data to test on„ÄÇAnd then a little bit less data to train on and
    so there's some trade offs there„ÄÇAnywayÔºå now what I'm going to do is I'm going
    to head back to this example that I had earlier where I was doing my training
    and ideas instead of fitting and scoring on the same data„ÄÇ I'm going to fit to
    my training data and then score on my test data„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: so I'm just to do it again from scratch for review and I'm going to say LR equals
    linear„ÄÇRegression„ÄÇ![](img/816ece20f67a7bafdafc76312ab6259f_4.png)
  prefs: []
  type: TYPE_NORMAL
- en: And ohÔºå there we goÔºå and that I say Lr„ÄÇ fit„ÄÇAnd I have my train„ÄÇData frame„ÄÇ
    and then I have a list of columns here„ÄÇAnd then here I may have my Y column„ÄÇRight„ÄÇ
    so that's the general strategy„ÄÇ And then what I want to do is I want to score
    it„ÄÇ when I'm scoring itÔºå I'm going to give it a Y column and an„ÄÇAnd an ex colony„ÄÇ
    And I'm sorry„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: I have to sayÔºå train Diaf here„ÄÇI'm going to give it that same information„ÄÇ but
    now I'm going to be doing the test data frame„ÄÇWhere as I may say test data frame
    and then same thing down hereÔºå test data frame„ÄÇAnd then what I'm going to do is
    for this„ÄÇImra passing in a list of columnsÔºå like before„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: And what was I doing last time I was looking at this positive„ÄÇA seven day average„ÄÇ
    And somebody' may pass that in„ÄÇJust like that and the same thing here„ÄÇ and then
    over here I can just look at that thing that I'm trying to predict my Y„ÄÇ which
    was this thing„ÄÇWhen me pass that in and then the same here„ÄÇ I'm going to do that„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: and I see that„ÄÇ okayÔºå my score is 0„ÄÇ16„ÄÇWhereas what would happen if I wanted
    to run it on my original training data frameÔºü
  prefs: []
  type: TYPE_NORMAL
- en: Like that training data frame„ÄÇAnd here it does better on the data I trained
    on„ÄÇ so this suggests that there is some overfitting hereÔºå right„ÄÇ the model does
    better the data it learned from instead of some new data it hasn't seen before
    and so that of course is a concern„ÄÇAnd so there's different things I can try to
    do to avoid that and we'll eventually talk about some of those things this semester„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: HelloÔºå today I'm going to be talking more about how we can determine whether
    or not a model is doing a good job or not„ÄÇ how can we interpret different scores
    and make sure that we aren't getting a good score just by chance„ÄÇAnd so I may
    be picking up last time with the model that's trying to predict COVID deaths two
    weeks out based on the current number of cases and so let me just quickly review
    what I did last time we were doing a train test split on our data frame and our
    data framework look like this right here„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: And it was per county„ÄÇ And then there's every day and the year there„ÄÇThen I
    created this linear regression modelÔºå which I imported from SK learned linearar
    model„ÄÇAnd then I did two things with itÔºå I fit it to my training data„ÄÇAnd then
    I scored it on my testing dataÔºå and these were the two pieces my training data
    and testing data came from here and so when I was doing this„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: what I basically did is I put in my Y valuesÔºå which is what I'm ultimately trying
    to predict„ÄÇAnd then here I put in my x values or my featuresÔºå which are things
    I know right nowÔºå so for example„ÄÇ right now I know the seven day rolling average
    of positive test cases and then two weeks out I'm trying to predict well how many
    deaths will there be„ÄÇThis can be a single seriesÔºå which is why we just put a string„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: I'm in the brackets after the data frame„ÄÇHere we actually have to pass in a
    full data frame because in general we might have multiple features and when I
    pass in a list to the brackets after a data frame while I get a smaller data frame„ÄÇ
    that's why I have the double brackets there„ÄÇ So anywayÔºå so I have this 0„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: 2 and and we know that the score will somewhere be be somewhere between 0 and1„ÄÇ
    So it's a little bit hard to say how good this score is right maybe you always
    get something like 0„ÄÇ2 by chance do we know So that's one of the things I want
    to talk about today And then the other thing that you might notice is if I rerun
    this a few times Oh and now I'm at 27%  32%„ÄÇ 24%Ôºå 242826„ÄÇSo you can see that based
    on how I do this train test split„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: I can do very different numbers and so that doesn't give us a lot of assurance
    so how can we get some more stable numbers out of the system I'll just give you
    kind of a hint of what the problem is if I look at train DF and I look at this
    column here„ÄÇ which is the thing we're trying to predict„ÄÇÂóØ„ÄÇLet me do that„ÄÇSo I
    have all those numbers there„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: Let me look at the variance of that column variance are just kind of a measure
    of how different values are from the average„ÄÇAnd then I'm also going to do that
    thingÔºå same thing for the test„ÄÇAnd so when I do it for the test„ÄÇ I see that actually
    they have quite different variances„ÄÇ and if I run this again„ÄÇWhile instrument
    randomly shake out differently now the test data actually has a higher variance
    than than the training data„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: and we eventually look at how this scoring function works„ÄÇ but it turns out
    that it's very much based on this variance„ÄÇWhich is why we have such a noisy measure„ÄÇ
    So let me head over to the slides and try to give a preview of the things we're
    going to talk about today„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/816ece20f67a7bafdafc76312ab6259f_6.png)'
  prefs: []
  type: TYPE_IMG
- en: We're going to be learning for new functions related model evaluation„ÄÇ so first
    we're going to learn these two functions hereÔºå which will let us score our models„ÄÇ![](img/816ece20f67a7bafdafc76312ab6259f_8.png)
  prefs: []
  type: TYPE_NORMAL
- en: SecondÔºå if our model is trying to mediocre like mine is rightÔºå I mean 0„ÄÇ2 is
    not great„ÄÇ how can we know if it's not just chance and then we're going to be
    using something called the permutation test score for that„ÄÇ and then finally„ÄÇTo
    get a less noisy measureÔºå we're going to be doing something called cross value
    scoring„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/816ece20f67a7bafdafc76312ab6259f_10.png)'
  prefs: []
  type: TYPE_IMG
- en: And so let me start here with these two metrics here„ÄÇ I have this R2 score and
    mean absolute error„ÄÇ and we'll talk about how those work„ÄÇ![](img/816ece20f67a7bafdafc76312ab6259f_12.png)
  prefs: []
  type: TYPE_NORMAL
- en: If I go back to my slides or go back to my notebook right here„ÄÇI'm doing the
    scoring here„ÄÇ I can also up hereÔºå I can sayÔºå from SKL dot matrix„ÄÇ![](img/816ece20f67a7bafdafc76312ab6259f_14.png)
  prefs: []
  type: TYPE_NORMAL
- en: Import„ÄÇThere's a couple things I want to do„ÄÇ I want to do the R2 scoreÔºå and
    then the mean„ÄÇAbsolute error score„ÄÇAnd so the way all of these metrics work is
    kind of like this„ÄÇ I'll call the metrics function„ÄÇAnd then I'll say something
    likeÔºå I mean„ÄÇ I should just check this here quick„ÄÇI'll say something like I had
    to make sure the order is different between my true and my predicted„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: I'll say you know what are the true values and then my predicted values„ÄÇAnd
    so for exampleÔºå up here„ÄÇ I know that these are my true values„ÄÇAnd„ÄÇThen my predicted
    valuesÔºå Well„ÄÇ how do I forget my predicted valuesÔºå I could just sayÔºå wellÔºå model„ÄÇ
    please predict for me what these y values should be based on these x values that
    I'm going give you„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: All so I'm going to do thatÔºå and so here I'm putting in x values and it's going
    to return back to me Y values„ÄÇAnd this weird anything thing that we'll eventually
    talk about„ÄÇ but I could take this and I could put this right here„ÄÇAnd so that
    I could use lots of different metric functions hereÔºå I couldÔºå for example„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: use the R2 score„ÄÇRight here and guess whatÔºå it turns out that this square here
    that's associated with the model is just defaultfiling to use R2 score„ÄÇ there's
    lots of different metrics I could have used insteadÔºå but this one is the default
    one„ÄÇSo let's talk a little bit about„ÄÇLet's talk a little bit about how this were
    computed„ÄÇ So the idea of it is that this is the thing I'm trying to predict right
    So this is my why column„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: And somebody going say why is here„ÄÇAnd I can just peek at that„ÄÇ What I want
    to do is I want to look at basically the squared residuals of this column relative
    to the mean„ÄÇ and so what does that mean„ÄÇ So I can take this„ÄÇ and I can subtract
    off the mean of this„ÄÇAnd then if I want toÔºå I can square all of that„ÄÇSo this is
    really a measure of kind of how bad the system is if I add all of these things
    off„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: So this is really well the variance of the system except I'm summing instead
    of averaging„ÄÇRight so this was my original kind of total error or variance in
    the system I might think of it as I'm just adding out so I wasm trying a sum of
    squares„ÄÇü§ßAnd then what I want to think about is what if instead of vugh„ÄÇMeasuring
    the distance from each shn„ÄÇEach value to the mean„ÄÇ What if I measure the distance
    to my actual prediction„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: So it'll be very similar hereÔºå I can sayÔºå what is kind of left over„ÄÇIf I subtract
    off my predictions„ÄÇ how do I get my predictionsÔºå WellÔºå that's this right here„ÄÇ
    I'm going to grab this piece„ÄÇAnd let me have my predictions here„ÄÇYeahÔºå then let
    me take a look at that„ÄÇSo the way I really think about it is that originally this
    was how much variance I had in the system and this is how much I have„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: After IÔºå after I do predictions rather than just subtracting off the mean„ÄÇAnd
    so what I could do is what I could say„ÄÇÂóØ„ÄÇI could sayÔºå wellÔºå how much is remaining„ÄÇ
    so I could say leftover divided by the total„ÄÇAnd„ÄÇWhy is thatÔºüOhÔºå let me just put
    that here„ÄÇI can say that left over divided by the totalÔºå and I'm likeÔºå okay„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: why left 79% of the variance on the table basicallyÔºüWhich means that I took
    away 20%„ÄÇü§ßAnd you can see that that's exactly what this is up here right so really
    this is the the math that people will really kind of use to evaluate how good„ÄÇA
    regression is typically we can do that more simply with R2 score„ÄÇ and even more
    simply that's the default vi say linear a regression dot score„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: Let me give you an example of another metric people might use„ÄÇSo maybe I want
    to just getÔºå well„ÄÇ what is the average errorÔºüAnd so on that caseÔºå I would go back
    to this piece„ÄÇRightSo this is all of the errors„ÄÇAnd if I want to get the average„ÄÇ
    I should probably just think about the absolute error„ÄÇAnd then I could take the
    mean of that„ÄÇRight„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: so this would be the average„ÄÇAbsolute error„ÄÇAnd it turns out that that is just„ÄÇRather
    than be collectulating that myselfÔºå I could just grab this mean absolute error
    here„ÄÇ there's lots of different metrics in here and I think if I hit shift tab„ÄÇWell„ÄÇ
    maybe it's just regular tab„ÄÇ I can see all the different metrics that come here„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: And most of them I have never used„ÄÇ so I paste this here and I seeÔºå wellÔºå that's
    kind of strange„ÄÇ It should be the same It should be the same number„ÄÇWhy is that
    not the same number„ÄÇBecause on„ÄÇI wanted to get the error of my predictions not
    relative to the mean„ÄÇ and so I'm sorry this was the thing that I wanted toÔºå this
    is the thing I had wanted to grab„ÄÇRight„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: so I wanted to say„ÄÇYou knowÔºå here are all my errors„ÄÇ take the absolute value
    of them„ÄÇ right some errors are positive or negative„ÄÇ I just want to have the absolute
    value„ÄÇ then I have the average„ÄÇAnd why is that„ÄÇÂóØ„ÄÇIn balance syntax„ÄÇ that usually
    probably means I have a mismatch in terms of my parentheses„ÄÇI see„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: So this one has is matched up there„ÄÇ So I don't know why I grab that squared„ÄÇ
    Okay„ÄÇ so I can see that this is all my errors„ÄÇAnd then I'm taking the absolute
    and I'm picking the average„ÄÇ and I'll thankfullyÔºå okayÔºå well actually get the
    same thing that I have down here„ÄÇAnd so again„ÄÇ rightÔºå this is just a shortcut
    for this kind of more complicated math„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: but it's another metric in terms of how these metrics work„ÄÇÂëÉ„ÄÇThis one is kind
    of counting all errors more equallyÔºå you know„ÄÇ error that's twice as big is just
    twice as bad„ÄÇBecause this one up here where Im doing the when I'm doing where
    is it right here when I'm doing the R R squared score„ÄÇ because that one is squaring
    my errorsÔºå this will tend to make it look worse if I have a few errors that are
    really big as opposed to many small errors„ÄÇ
  prefs: []
  type: TYPE_NORMAL
- en: OkayÔºå so those were a couple metricsÔºå which was one of the things we wanted
    to answer in the slide„ÄÇ I'm just going to head back here„ÄÇ![](img/816ece20f67a7bafdafc76312ab6259f_16.png)
  prefs: []
  type: TYPE_NORMAL
