- en: ã€åŒè¯­å­—å¹•+èµ„æ–™ä¸‹è½½ã€‘â€œå½“å‰æœ€å¥½çš„ TensorFlow æ•™ç¨‹ï¼â€ï¼Œçœ‹å®Œå°±èƒ½è‡ªå·±åŠ¨æ‰‹åšé¡¹ç›®å•¦ï¼ï¼œå®æˆ˜æ•™ç¨‹ç³»åˆ—ï¼ - P18ï¼šL18- å›¾åƒçš„è‡ªå®šä¹‰æ•°æ®é›†
    - ShowMeAI - BV1em4y1U7ib
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ã€åŒè¯­å­—å¹•+èµ„æ–™ä¸‹è½½ã€‘â€œå½“å‰æœ€å¥½çš„ TensorFlow æ•™ç¨‹ï¼â€ï¼Œçœ‹å®Œå°±èƒ½è‡ªå·±åŠ¨æ‰‹åšé¡¹ç›®å•¦ï¼ï¼œå®æˆ˜æ•™ç¨‹ç³»åˆ—ï¼ - P18ï¼šL18- å›¾åƒçš„è‡ªå®šä¹‰æ•°æ®é›†
    - ShowMeAI - BV1em4y1U7ib
- en: In this videoï¼Œ we will learn various ways that we can efficiently load a custom
    image dataset setã€‚ Perhaps you've scraped this data onlineï¼Œ or maybe you've created
    it yourselfã€‚ So I'm going to show you three different methods which are all efficient
    and good methodsã€‚ but one might be more convenient depending on how your dataset
    is already structuredã€‚
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ä¸ªè§†é¢‘ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¤šç§é«˜æ•ˆåŠ è½½è‡ªå®šä¹‰å›¾åƒæ•°æ®é›†çš„æ–¹æ³•ã€‚ä¹Ÿè®¸ä½ å·²ç»åœ¨çº¿æŠ“å–äº†è¿™äº›æ•°æ®ï¼Œæˆ–è€…è‡ªå·±åˆ›å»ºäº†å®ƒã€‚å› æ­¤ï¼Œæˆ‘å°†å‘ä½ å±•ç¤ºä¸‰ç§ä¸åŒçš„æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•éƒ½æ˜¯é«˜æ•ˆä¸”è‰¯å¥½çš„ï¼Œä½†å…¶ä¸­ä¸€ç§å¯èƒ½æ›´æ–¹ä¾¿ï¼Œå…·ä½“å–å†³äºä½ çš„æ•°æ®é›†ç»“æ„ã€‚
- en: '![](img/5a48387aad10b0cf4a2d2bc3dacad647_1.png)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5a48387aad10b0cf4a2d2bc3dacad647_1.png)'
- en: '![](img/5a48387aad10b0cf4a2d2bc3dacad647_2.png)'
  id: totrans-3
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5a48387aad10b0cf4a2d2bc3dacad647_2.png)'
- en: So the first method is that we have images in different subfolders so as usual
    we have a good old MNT and in this case we have you know the folder 01 to eta
    up to9 so if you just take a look at one subfoldder in this case we just have
    five images but of course you can imagine having you as many as you want so here
    we have all of the images corresponding to that class and then for the ninth one
    we have all the digit of9 and of course in this case the label is exactly the
    same as the class name but you can also imagine having something else if you would
    have let's say a cat and dog data set then you would just replace the zero with
    let's say cats and then you would have another one for dogs in this case it just
    so happens that the labels are exactly what the class names are so stepping into
    the code these are all the imports that we're going to use and then I'm actuallyã€‚
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: ç¬¬ä¸€ä¸ªæ–¹æ³•æ˜¯æˆ‘ä»¬å°†å›¾åƒæ”¾åœ¨ä¸åŒçš„å­æ–‡ä»¶å¤¹ä¸­ã€‚é€šå¸¸æˆ‘ä»¬ä¼šæœ‰ä¸€ä¸ªå¥½çš„è€MNTï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æœ‰01åˆ°9çš„æ–‡ä»¶å¤¹ã€‚å¦‚æœä½ æŸ¥çœ‹å…¶ä¸­ä¸€ä¸ªå­æ–‡ä»¶å¤¹ï¼Œæˆ‘ä»¬åªæœ‰äº”å¼ å›¾åƒï¼Œä½†å½“ç„¶ä½ å¯ä»¥æƒ³è±¡æœ‰å¾ˆå¤šå¼ ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æœ‰æ‰€æœ‰ä¸è¯¥ç±»å¯¹åº”çš„å›¾åƒï¼Œå¯¹äºç¬¬ä¹ä¸ªæ–‡ä»¶å¤¹ï¼Œæˆ‘ä»¬æœ‰æ•°å­—9ï¼Œå½“ç„¶åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ ‡ç­¾ä¸ç±»åå®Œå…¨ç›¸åŒï¼Œä½†ä½ ä¹Ÿå¯ä»¥æƒ³è±¡å…¶ä»–æƒ…å†µï¼Œæ¯”å¦‚è¯´çŒ«å’Œç‹—çš„æ•°æ®é›†ï¼Œé‚£ä¹ˆä½ åªéœ€å°†0æ›¿æ¢ä¸ºçŒ«ï¼Œç„¶åå†ä¸ºç‹—åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ ‡ç­¾æ­£å¥½å°±æ˜¯ç±»åã€‚å› æ­¤ï¼Œè¿›å…¥ä»£ç ï¼Œè¿™äº›æ˜¯æˆ‘ä»¬å°†ä½¿ç”¨çš„æ‰€æœ‰å¯¼å…¥ã€‚
- en: '![](img/5a48387aad10b0cf4a2d2bc3dacad647_4.png)'
  id: totrans-5
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5a48387aad10b0cf4a2d2bc3dacad647_4.png)'
- en: '![](img/5a48387aad10b0cf4a2d2bc3dacad647_5.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5a48387aad10b0cf4a2d2bc3dacad647_5.png)'
- en: going to show you two methods to load this data so let's start with specifying
    what we want as the image height so image height is going to be 28ã€‚ the image
    width is going to be 28 as well and then let's say we want the batch size of two
    just because we have so few examples and then let's also create just a very simple
    k sequential model just to make sure or let me actually copy paste that in so
    this is just to demonstrate that this works and that we can overfit this small
    data set and then let's go to the first methodã€‚
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘å°†å‘ä½ å±•ç¤ºä¸¤ç§åŠ è½½æ­¤æ•°æ®çš„æ–¹æ³•ï¼Œå› æ­¤æˆ‘ä»¬å…ˆæŒ‡å®šå›¾åƒé«˜åº¦ï¼Œå›¾åƒé«˜åº¦å°†æ˜¯28ï¼Œå›¾åƒå®½åº¦ä¹Ÿå°†æ˜¯28ã€‚ç„¶åæˆ‘ä»¬è®¾å®šæ‰¹å¤„ç†å¤§å°ä¸º2ï¼Œå› ä¸ºæˆ‘ä»¬åªæœ‰è¿™ä¹ˆå°‘çš„ç¤ºä¾‹ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜å°†åˆ›å»ºä¸€ä¸ªéå¸¸ç®€å•çš„kåºåˆ—æ¨¡å‹ï¼Œåªæ˜¯ä¸ºäº†æ¼”ç¤ºè¿™èƒ½å·¥ä½œï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥å¯¹è¿™ä¸ªå°æ•°æ®é›†è¿›è¡Œè¿‡æ‹Ÿåˆã€‚ç°åœ¨è®©æˆ‘ä»¬è¿›å…¥ç¬¬ä¸€ç§æ–¹æ³•ã€‚
- en: which is using data set from directory So what we're going to do to use this
    is the Ds train is Tf ks that preprocessing that imageã€‚Data set from directoryã€‚Allrightï¼Œ
    and then first of allã€‚ we're gonna specify the folder for where all of the images
    are or rather where the subfolds areã€‚ So that's in this case that's in dataã€‚ and
    then it's in Mist subfoldsã€‚
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å°†ä½¿ç”¨æ¥è‡ªç›®å½•çš„æ•°æ®é›†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è¦åšçš„æ˜¯å°†Ds trainä½œä¸ºTf ksï¼Œå¤„ç†è¿™ä¸ªå›¾åƒã€‚æ¥è‡ªç›®å½•çš„æ•°æ®é›†ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬è¦æŒ‡å®šå›¾åƒæ‰€åœ¨çš„æ–‡ä»¶å¤¹ï¼Œæˆ–è€…è¯´å­æ–‡ä»¶å¤¹çš„ä½ç½®ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå®ƒä½äºdataä¸­ï¼Œç„¶ååœ¨Mistå­æ–‡ä»¶å¤¹ä¸‹ã€‚
- en: then we're gonna do labels is inferredã€‚ and and that just means that the labels
    are inferred from the structure of the subfolds in alphabetical orderã€‚ And then
    label modeï¼Œ we're gonna specify to integerã€‚ and you have a different options hereã€‚
    but integer is the most common one but you can also use categorical or binary
    and that would mean that this would be a categorical vectorã€‚ So basically it would
    be for you know one hot encodings anywaysã€‚
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åæˆ‘ä»¬å°†è¿›è¡Œæ ‡ç­¾æ¨æ–­ã€‚è¿™æ„å‘³ç€æ ‡ç­¾æ˜¯æ ¹æ®å­æ–‡ä»¶å¤¹çš„ç»“æ„æŒ‰å­—æ¯é¡ºåºæ¨æ–­çš„ã€‚æ¥ç€æˆ‘ä»¬å°†æŒ‡å®šæ ‡ç­¾æ¨¡å¼ä¸ºæ•´æ•°ã€‚è¿™é‡Œæœ‰ä¸åŒçš„é€‰é¡¹ï¼Œä½†æ•´æ•°æ˜¯æœ€å¸¸è§çš„é€‰é¡¹ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ç±»åˆ«æˆ–äºŒè¿›åˆ¶ï¼Œè¿™æ„å‘³ç€è¿™å°†æ˜¯ä¸€ä¸ªç±»åˆ«å‘é‡ã€‚æ‰€ä»¥åŸºæœ¬ä¸Šè¿™ä¼šç”¨äºä¸€çƒ­ç¼–ç ç­‰ç­‰ã€‚
- en: then you can also send in something called class namesã€‚ So in this case our
    class names would just be0ï¼Œ1 to3 etcï¼Œ right this makes senseã€‚ But let's say that
    we would replace 1 and 0 hereã€‚ That means that indexã€‚0 would actually represent
    the digit1ã€‚ but of courseï¼Œ that would be kind of confusingã€‚
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åä½ è¿˜å¯ä»¥å‘é€ä¸€äº›å«åšç±»åçš„ä¸œè¥¿ã€‚æ‰€ä»¥åœ¨è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬çš„ç±»åå°†æ˜¯ 0ï¼Œ1 åˆ° 3 ç­‰ç­‰ï¼Œè¿™æ ·ç†è§£æ˜¯å¯¹çš„ã€‚ä½†å‡è®¾æˆ‘ä»¬åœ¨è¿™é‡Œæ›¿æ¢ 1 å’Œ 0ã€‚è¿™æ„å‘³ç€ç´¢å¼•
    0 å®é™…ä¸Šä»£è¡¨æ•°å­— 1ã€‚ä½†æ˜¯ï¼Œå½“ç„¶ï¼Œè¿™ä¼šæœ‰ç‚¹æ··æ·†ã€‚
- en: So let's just change those backã€‚ Then we can specify color modeã€‚ And in this
    caseã€‚ we're gonna specify grayscaleã€‚ You can also specify RGB hereã€‚ and then you
    specify the batch sizeã€‚ let's say twoã€‚ rather we had argumentã€‚ Yeahï¼Œ we had batch
    size equals hereã€‚ So we let's do batch sizeã€‚Which is going to be twoã€‚
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥è®©æˆ‘ä»¬æŠŠé‚£äº›æ”¹å›å»ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥æŒ‡å®šé¢œè‰²æ¨¡å¼ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ã€‚æˆ‘ä»¬è¦æŒ‡å®šç°åº¦ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨è¿™é‡ŒæŒ‡å®š RGBã€‚ç„¶åä½ æŒ‡å®šæ‰¹é‡å¤§å°ã€‚å‡è®¾æ˜¯ä¸¤ä¸ªã€‚æˆ‘ä»¬æœ‰å‚æ•°ã€‚æ˜¯çš„ï¼Œæˆ‘ä»¬è¿™é‡Œæœ‰æ‰¹é‡å¤§å°ç­‰äºã€‚æ‰€ä»¥æˆ‘ä»¬æ¥åšæ‰¹é‡å¤§å°ã€‚å°†æ˜¯ä¸¤ä¸ªã€‚
- en: and then we can do image size is going to be image height and then image widthã€‚And
    it'sã€‚ it's going toï¼Œ so it's going to reshape ifã€‚Not in this sizeã€‚Then we're going
    to do shuffle equals true so that we get a randomized orderã€‚ then we can specify
    a seedï¼Œ and this is important if you want to haveã€‚
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åæˆ‘ä»¬å¯ä»¥åšå›¾åƒå¤§å°ï¼Œå°†æ˜¯å›¾åƒé«˜åº¦å’Œå›¾åƒå®½åº¦ã€‚å®ƒä¼šé‡æ–°è°ƒæ•´å¤§å°ï¼Œå¦‚æœä¸æ˜¯è¿™ä¸ªå°ºå¯¸ã€‚ç„¶åæˆ‘ä»¬å°†è®¾ç½® shuffle ç­‰äº trueï¼Œä»¥ä¾¿æˆ‘ä»¬è·å¾—éšæœºé¡ºåºã€‚ç„¶åæˆ‘ä»¬å¯ä»¥æŒ‡å®šç§å­ï¼Œå¦‚æœä½ æƒ³è¦çš„è¯ï¼Œè¿™å¾ˆé‡è¦ã€‚
- en: let's say you're splitting it into a validation set and a training set and you
    want the exact same training and validation set every time you run it then it's
    important to set the seedã€‚ and then we can also do something like validation splitã€‚Let's
    set it to 0ã€‚1ã€‚
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: å‡è®¾ä½ å°†å…¶åˆ†ä¸ºéªŒè¯é›†å’Œè®­ç»ƒé›†ï¼Œå¹¶ä¸”æ¯æ¬¡è¿è¡Œæ—¶å¸Œæœ›å¾—åˆ°å®Œå…¨ç›¸åŒçš„è®­ç»ƒå’ŒéªŒè¯é›†ï¼Œé‚£ä¹ˆè®¾ç½®ç§å­æ˜¯å¾ˆé‡è¦çš„ã€‚ç„¶åæˆ‘ä»¬ä¹Ÿå¯ä»¥åšç±»ä¼¼éªŒè¯æ‹†åˆ†çš„äº‹æƒ…ã€‚è®©æˆ‘ä»¬å°†å…¶è®¾ç½®ä¸º
    0.1ã€‚
- en: so 10% of the images are going to be in a validation dataã€‚Then to make sure
    that this is the trainingï¼Œ we can specify subset equals trainingã€‚![](img/5a48387aad10b0cf4a2d2bc3dacad647_7.png)
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥ 10% çš„å›¾åƒå°†ä¼šåœ¨éªŒè¯æ•°æ®ä¸­ã€‚ç„¶åä¸ºäº†ç¡®ä¿è¿™æ˜¯è®­ç»ƒï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šå­é›†ç­‰äºè®­ç»ƒã€‚![](img/5a48387aad10b0cf4a2d2bc3dacad647_7.png)
- en: Trainingã€‚ğŸ˜”ï¼ŒAnd then what we would do for the validation is simply just copy
    paste all of thatã€‚![](img/5a48387aad10b0cf4a2d2bc3dacad647_9.png)
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: è®­ç»ƒã€‚ğŸ˜” ç„¶åæˆ‘ä»¬å¯¹éªŒè¯æ‰€åšçš„åªæ˜¯ç®€å•å¤åˆ¶ç²˜è´´æ‰€æœ‰å†…å®¹ã€‚![](img/5a48387aad10b0cf4a2d2bc3dacad647_9.png)
- en: And then we wouldï¼Œ first of allï¼Œ change the name toï¼Œ let's sayï¼Œ D validationã€‚And
    then right here we would split it to validation and this way it's going to randomly
    split it into a validation data that is 10% of the original data that's in the
    subfoldsã€‚
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åæˆ‘ä»¬é¦–å…ˆå°†åç§°æ›´æ”¹ä¸ºï¼Œæ¯”å¦‚è¯´ï¼ŒD validationã€‚ç„¶ååœ¨è¿™é‡Œæˆ‘ä»¬ä¼šå°†å…¶æ‹†åˆ†ä¸ºéªŒè¯ï¼Œè¿™æ ·å®ƒå°†éšæœºæ‹†åˆ†ä¸ºåŸå§‹æ•°æ®çš„ 10% çš„éªŒè¯æ•°æ®ï¼Œå­˜æ”¾åœ¨å­æ–‡ä»¶å¤¹ä¸­ã€‚
- en: So now when we have used this image data set from directory It's going to be
    in a tensorflow data set format and now we know exactly what to do from previous
    videos So let's say we wanted to do some data augmentation then that would be
    pretty straightforwardã€‚
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨å½“æˆ‘ä»¬ä½¿ç”¨æ¥è‡ªç›®å½•çš„è¿™ä¸ªå›¾åƒæ•°æ®é›†æ—¶ï¼Œå®ƒå°†ä¼šæ˜¯ä¸€ä¸ª TensorFlow æ•°æ®é›†æ ¼å¼ï¼Œç°åœ¨æˆ‘ä»¬çŸ¥é“è¯¥æ€ä¹ˆåšæ¥è‡ªä¹‹å‰çš„è§†é¢‘ã€‚å‡è®¾æˆ‘ä»¬æƒ³åšä¸€äº›æ•°æ®å¢å¼ºï¼Œé‚£å°†æ˜¯ç›¸å½“ç®€å•çš„ã€‚
- en: we would doï¼Œ as we did in the data augmentation tutorial and let me just give
    a simple exampleã€‚ we would do image is Tf image randomã€‚Brightnessï¼Œ and then let's
    send in Xã€‚Specify some max deltaã€‚ and then we would return image and Yã€‚So that's
    just a veryï¼Œ very simple data augmentationã€‚ We would do DS S train equalsã€‚D Strain
    dot map and then augmentã€‚ğŸ˜”ã€‚
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å°†åƒåœ¨æ•°æ®å¢å¼ºæ•™ç¨‹ä¸­é‚£æ ·åšï¼Œç»™æˆ‘ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚æˆ‘ä»¬ä¼šä½¿ç”¨å›¾åƒæ˜¯ Tf å›¾åƒéšæœºçš„ **äº®åº¦**ï¼Œç„¶åè®©æˆ‘ä»¬ä¼ å…¥ Xã€‚æŒ‡å®šä¸€äº›æœ€å¤§å¢é‡ã€‚ç„¶åæˆ‘ä»¬ä¼šè¿”å›å›¾åƒå’Œ
    Yã€‚æ‰€ä»¥è¿™åªæ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„æ•°æ®å¢å¼ºã€‚æˆ‘ä»¬ä¼šåš DS S train ç­‰äº D Strain.dot map ç„¶å augmentã€‚ğŸ˜”
- en: And then let's say you wanted to train on thisã€‚ You would do four epochs in
    range ofï¼Œ I don't knowã€‚10 or the number of epochs of your choiceã€‚ So let's just
    be clear hereã€‚ This is for custom loopsã€‚And then you would do for x and Y in the
    S trainã€‚ and then you would doï¼Œ you knowï¼Œ train hereã€‚ But let's just doã€‚A pass
    on that right nowï¼Œ but that's we've covered this in previous tutorialsã€‚
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åå‡è®¾ä½ æƒ³è¦è®­ç»ƒè¿™ä¸ªã€‚ä½ ä¼šåœ¨èŒƒå›´å†…è¿›è¡Œå››ä¸ªæ—¶æœŸï¼Œæˆ‘ä¸çŸ¥é“ï¼Œ10 æˆ–ä½ é€‰æ‹©çš„æ—¶æœŸæ•°ã€‚æ‰€ä»¥è®©æˆ‘ä»¬æ˜ç¡®ä¸€ä¸‹ã€‚è¿™æ˜¯ä¸ºè‡ªå®šä¹‰å¾ªç¯è€Œåšçš„ã€‚ç„¶åä½ ä¼šå¯¹ S train
    ä¸­çš„ x å’Œ Y è¿›è¡Œæ“ä½œã€‚ç„¶åä½ ä¼šè¿›è¡Œè®­ç»ƒã€‚ä½†ç°åœ¨æˆ‘ä»¬å…ˆä¸æ·±å…¥è¿™ä¸ªï¼Œä½†æˆ‘ä»¬åœ¨ä¹‹å‰çš„æ•™ç¨‹ä¸­å·²ç»è®¨è®ºè¿‡äº†ã€‚
- en: And thenï¼Œ of courseï¼Œ if wantï¼Œ if you wanted to do with model dot compileï¼Œ that
    works as wellã€‚ So you would justï¼Œ let meï¼Œ I'm just gonna copy it in so that we
    don't have toã€‚Spend unnecessary necessary time on this so then and again this
    is all covered from previous tutorials but here we do model the compile with Adamom
    optimizer sparse categorical cross entropy and then we do model that fit on that
    for 10 epos let's say so yeah if we just run this we can see right here that it
    found 50 files and then it's using 45 of those for training and then again for
    the validation it's using five of those for the validation and just to be clear
    these 45 rather none of these images inside of these 45 are going to be equal
    to the5 for the validation so they are unique and we not we're not training on
    the images for the validation dataã€‚
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: å½“ç„¶ï¼Œå¦‚æœä½ æƒ³è¦ä½¿ç”¨model.dot compileï¼Œé‚£ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚æ‰€ä»¥ä½ åªéœ€è¦ï¼Œè®©æˆ‘å¤åˆ¶ä¸€ä¸‹ï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸å¿…åœ¨è¿™ä¸Šé¢èŠ±è´¹ä¸å¿…è¦çš„æ—¶é—´ã€‚æ‰€ä»¥å†ä¸€æ¬¡ï¼Œè¿™äº›åœ¨ä¹‹å‰çš„æ•™ç¨‹ä¸­éƒ½æœ‰ä»‹ç»ï¼Œä½†åœ¨è¿™é‡Œæˆ‘ä»¬ç”¨Adamä¼˜åŒ–å™¨å’Œç¨€ç–åˆ†ç±»äº¤å‰ç†µæ¥ç¼–è¯‘æ¨¡å‹ï¼Œç„¶åæˆ‘ä»¬ç”¨model.fitè¿›è¡Œ10ä¸ªå‘¨æœŸçš„è®­ç»ƒã€‚å‡è®¾æˆ‘ä»¬åªéœ€è¿è¡Œè¿™ä¸ªï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°å®ƒæ‰¾åˆ°50ä¸ªæ–‡ä»¶ï¼Œç„¶åä½¿ç”¨å…¶ä¸­45ä¸ªè¿›è¡Œè®­ç»ƒï¼Œè€ŒéªŒè¯ä½¿ç”¨å…¶ä¸­5ä¸ªã€‚ä¸ºäº†æ˜ç¡®ï¼Œè¿™45ä¸ªä¸­æ²¡æœ‰ä»»ä½•ä¸€å¼ å›¾ç‰‡ä¼šä¸è¿™5ä¸ªç”¨äºéªŒè¯çš„å›¾ç‰‡ç›¸åŒï¼Œå› æ­¤å®ƒä»¬æ˜¯ç‹¬ç‰¹çš„ï¼Œæˆ‘ä»¬æ²¡æœ‰åœ¨éªŒè¯æ•°æ®ä¸Šè¿›è¡Œè®­ç»ƒã€‚
- en: Alrightï¼Œ and then we can see just every110 boxã€‚ we have 100% training accuracyã€‚
    which means that we overfit to those 45 training examplesã€‚ Alrightï¼Œ so that's
    the method oneã€‚ and that works fineã€‚ then for the method 2ã€‚We're going to use
    image data generator and then flow from directory and what we're going to do first
    is define this image data generatorã€‚So we're going to do data generatorã€‚Is image
    data generatorï¼Œ and we imported this at the topã€‚
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: å¥½çš„ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯110ä¸ªæ¡†ï¼Œæˆ‘ä»¬æœ‰100%çš„è®­ç»ƒå‡†ç¡®ç‡ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯¹è¿™45ä¸ªè®­ç»ƒæ ·æœ¬è¿‡æ‹Ÿåˆã€‚å¥½çš„ï¼Œè¿™å°±æ˜¯æ–¹æ³•ä¸€ã€‚è¿™ä¸ªæ–¹æ³•å¾ˆå¥½ã€‚ç„¶åå¯¹äºæ–¹æ³•äºŒï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å›¾åƒæ•°æ®ç”Ÿæˆå™¨ï¼Œç„¶åä»ç›®å½•ä¸­æµå¼ä¼ è¾“ã€‚æˆ‘ä»¬é¦–å…ˆè¦å®šä¹‰è¿™ä¸ªå›¾åƒæ•°æ®ç”Ÿæˆå™¨ã€‚æ‰€ä»¥æˆ‘ä»¬è¦åšçš„æ˜¯data_generator=ImageDataGeneratorï¼Œæˆ‘ä»¬åœ¨é¡¶éƒ¨å¯¼å…¥äº†è¿™ä¸ªã€‚
- en: so we imported this right here on this lineã€‚So we're going to do image data
    generator and then we're going to doã€‚ first of allï¼Œ we're going to specify rescale
    and we're going to do one divided by 255ã€‚And we're just doing this to make sure
    that it's in floatã€‚But we're going to divide by 255 to normalize the images and
    then we can specify a lot of data augmentation inside of this image data generatorã€‚
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥æˆ‘ä»¬åœ¨è¿™ä¸€è¡Œå¯¼å…¥äº†è¿™ä¸ªã€‚æ‰€ä»¥æˆ‘ä»¬è¦åšçš„æ˜¯å›¾åƒæ•°æ®ç”Ÿæˆå™¨ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬å°†æŒ‡å®šé‡ç¼©æ”¾ï¼Œå¹¶å°†å…¶è®¾ç½®ä¸º1/255ã€‚æˆ‘ä»¬è¿™æ ·åšæ˜¯ä¸ºäº†ç¡®ä¿å®ƒæ˜¯æµ®ç‚¹æ•°ã€‚æˆ‘ä»¬å°†é€šè¿‡255è¿›è¡Œé™¤æ³•æ¥æ ‡å‡†åŒ–å›¾åƒï¼Œç„¶åæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªå›¾åƒæ•°æ®ç”Ÿæˆå™¨ä¸­æŒ‡å®šå¾ˆå¤šæ•°æ®å¢å¼ºã€‚
- en: so let's just give an example we can do rotation range and there are a ton of
    different arguments that you can send into this I'm going to put the documentation
    part on the screen so you can see but there's really a lot so there are more than
    what I'm showing you right hereã€‚
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥æˆ‘ä»¬æ¥ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥åšæ—‹è½¬èŒƒå›´ï¼Œå¹¶ä¸”ä½ å¯ä»¥ä¼ å…¥å¾ˆå¤šä¸åŒçš„å‚æ•°ã€‚æˆ‘ä¼šæŠŠæ–‡æ¡£éƒ¨åˆ†æ”¾åœ¨å±å¹•ä¸Šï¼Œè®©ä½ å¯ä»¥çœ‹åˆ°ï¼Œä½†å®é™…ä¸Šæœ‰å¾ˆå¤šï¼Œæ‰€ä»¥æ¯”æˆ‘ç°åœ¨å±•ç¤ºçš„è¦å¤šã€‚
- en: '![](img/5a48387aad10b0cf4a2d2bc3dacad647_11.png)'
  id: totrans-24
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5a48387aad10b0cf4a2d2bc3dacad647_11.png)'
- en: But then you can do something like zoom range and you can do in a twopleï¼Œ let's
    say 0ã€‚990ã€‚99ã€‚ And what this is going to do is zoom out 1% and then zoom out 1%
    in a within that rangeã€‚ but it's going to do it randomlyã€‚ So I meanï¼Œ that's veryï¼Œ
    very few right let's do 5% at leastã€‚And then we can do horizontal flip and we
    can set it to falseã€‚
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åä½ å¯ä»¥åšåƒç¼©æ”¾èŒƒå›´è¿™æ ·çš„æ“ä½œï¼Œå‡è®¾æ˜¯0.99åˆ°0.99ã€‚è¿™å°†æ„å‘³ç€ç¼©å°1%ï¼Œç„¶ååœ¨è¿™ä¸ªèŒƒå›´å†…å†ç¼©å°1%ã€‚ä½†æ˜¯è¿™å°†æ˜¯éšæœºè¿›è¡Œçš„ã€‚æ‰€ä»¥ï¼Œæˆ‘çš„æ„æ€æ˜¯ï¼Œè¿™éå¸¸ï¼Œéå¸¸å°‘ï¼Œè®©æˆ‘ä»¬è‡³å°‘è®¾å®š5%ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥è¿›è¡Œæ°´å¹³ç¿»è½¬ï¼Œå¹¶å°†å…¶è®¾ç½®ä¸ºfalseã€‚
- en: we don't want to flip the digits that would ruin some of themã€‚So then we can
    do vertical flip as wellã€‚ And againï¼Œ they are false by defaultã€‚ I'm just kind
    of showing you how you would do itã€‚you can specify more things like data format
    and we can do channels lastã€‚ and this is kind of the standard way Tensorflow wanted
    inã€‚
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ä¸æƒ³ç¿»è½¬æ•°å­—ï¼Œè¿™ä¼šæ¯æ‰å…¶ä¸­çš„ä¸€äº›ã€‚å› æ­¤æˆ‘ä»¬ä¹Ÿå¯ä»¥è¿›è¡Œå‚ç›´ç¿»è½¬ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä»¬ä¹Ÿæ˜¯falseã€‚æˆ‘åªæ˜¯å±•ç¤ºä¸€ä¸‹ä½ ä¼šæ€ä¹ˆåšã€‚ä½ å¯ä»¥æŒ‡å®šæ›´å¤šå†…å®¹ï¼Œæ¯”å¦‚æ•°æ®æ ¼å¼ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®é€šé“ä¸ºæœ€åã€‚è¿™æ˜¯TensorFlowå¸Œæœ›çš„æ ‡å‡†æ–¹å¼ã€‚
- en: but you can you can also have channels firstï¼Œ if you'd likeã€‚And then you can
    also specify validation split similarly to what we did aboveã€‚ but let's just set
    0 for this for nowã€‚ and then D type is going to be TF float 32ã€‚![](img/5a48387aad10b0cf4a2d2bc3dacad647_13.png)
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†æ˜¯å¦‚æœä½ æ„¿æ„ï¼Œä½ ä¹Ÿå¯ä»¥å…ˆæœ‰é€šé“ã€‚ç„¶åä½ ä¹Ÿå¯ä»¥åƒæˆ‘ä»¬ä¹‹å‰é‚£æ ·æŒ‡å®šéªŒè¯æ‹†åˆ†ã€‚ä¸è¿‡æˆ‘ä»¬ç°åœ¨å°±å°†è¿™ä¸ªè®¾ç½®ä¸º0ã€‚ç„¶åDç±»å‹å°†æ˜¯TF float 32ã€‚![](img/5a48387aad10b0cf4a2d2bc3dacad647_13.png)
- en: And then when we have the data the image data generatorã€‚ we're going to construct
    this train generator because you know so far we haven't specified the directory
    for any of the imagesã€‚ so now we've just sort of specified how we want the data
    to be processedã€‚So what we do is we do datagenã€‚ flow from directoryï¼Œ all rightã€‚
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: å½“æˆ‘ä»¬æœ‰æ•°æ®çš„å›¾åƒæ•°æ®ç”Ÿæˆå™¨æ—¶ï¼Œæˆ‘ä»¬å°†æ„å»ºè¿™ä¸ªè®­ç»ƒç”Ÿæˆå™¨ï¼Œå› ä¸ºåˆ°ç›®å‰ä¸ºæ­¢æˆ‘ä»¬å°šæœªä¸ºä»»ä½•å›¾åƒæŒ‡å®šç›®å½•ã€‚æ‰€ä»¥ç°åœ¨æˆ‘ä»¬åªæ˜¯æŒ‡å®šäº†æ•°æ®å¤„ç†æ–¹å¼ã€‚å› æ­¤æˆ‘ä»¬æ‰€åšçš„å°±æ˜¯ä½¿ç”¨
    datagenã€‚é€šè¿‡ç›®å½•æµåŠ¨ã€‚
- en: so we do flow from directory on this data generatorï¼Œ on this image data generator
    objectã€‚And then here we specify data and then mist subfolders againï¼Œ and then
    target sizeã€‚We're gonna specify imageã€‚Image heightï¼Œ image widthã€‚Then we specify
    the batch sizeã€‚ let's say batch sizeï¼Œ which is two color modeï¼Œ gray scale in this
    caseã€‚
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥æˆ‘ä»¬é€šè¿‡ç›®å½•ä»è¿™ä¸ªæ•°æ®ç”Ÿæˆå™¨æµåŠ¨ï¼Œåœ¨è¿™ä¸ªå›¾åƒæ•°æ®ç”Ÿæˆå™¨å¯¹è±¡ä¸Šã€‚ç„¶ååœ¨è¿™é‡Œæˆ‘ä»¬æŒ‡å®šæ•°æ®ï¼Œç„¶åå†æŒ‡å®šå­æ–‡ä»¶å¤¹ï¼Œç„¶åæ˜¯ç›®æ ‡å¤§å°ã€‚æˆ‘ä»¬å°†æŒ‡å®šå›¾åƒã€‚å›¾åƒé«˜åº¦ï¼Œå›¾åƒå®½åº¦ã€‚ç„¶åæˆ‘ä»¬æŒ‡å®šæ‰¹å¤§å°ã€‚å‡è®¾æ‰¹å¤§å°ä¸ºäºŒï¼Œé¢œè‰²æ¨¡å¼ä¸ºç°åº¦ã€‚
- en: but you can set it to RGB as wellï¼Œ class mode is going to be a sparse and it's
    going to be sparse because we want it to be in a you know the integer representing
    that oneã€‚ we don't want one hot encodingsã€‚And then we can do shuffle again we
    want the data to be randomized then we can do subset training and in this case
    since we're setting the validation split to zeroã€‚
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†ä½ ä¹Ÿå¯ä»¥å°†å…¶è®¾ç½®ä¸ºRGBï¼Œç±»åˆ«æ¨¡å¼å°†æ˜¯ç¨€ç–çš„ï¼Œè¿™æ ·åšæ˜¯å› ä¸ºæˆ‘ä»¬å¸Œæœ›å®ƒæ˜¯ä¸€ä¸ªè¡¨ç¤ºé‚£ä¸€ä¸ªçš„æ•´æ•°ã€‚æˆ‘ä»¬ä¸æƒ³è¦ç‹¬çƒ­ç¼–ç ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥å†æ¬¡è¿›è¡ŒéšæœºåŒ–ï¼Œæˆ‘ä»¬å¸Œæœ›æ•°æ®è¢«éšæœºåŒ–ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥åšå­é›†è®­ç»ƒï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”±äºæˆ‘ä»¬å°†éªŒè¯åˆ†å‰²è®¾ç½®ä¸ºé›¶ã€‚
- en: this is going to be the entire one but you could specify you could just as we
    did previously you could copy this and then specify validation generator and then
    specify validation right here so if you're using a validation data here you're
    going specify you're just gonna copy paste all of this and then specify subset
    is validation let's say you would have them in different folders you would have
    a training folder and then a validation folder you would just change the folder
    right here and perhaps you don't want to do data augmentation so you would have
    to then also specify a new data generatorã€‚
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™å°†æ˜¯æ•´ä¸ªè¿‡ç¨‹ï¼Œä½†ä½ å¯ä»¥åƒä¹‹å‰é‚£æ ·å¤åˆ¶è¿™ä¸ªï¼Œç„¶åæŒ‡å®šéªŒè¯ç”Ÿæˆå™¨ï¼Œç„¶ååœ¨è¿™é‡ŒæŒ‡å®šéªŒè¯ã€‚æ‰€ä»¥å¦‚æœä½ åœ¨è¿™é‡Œä½¿ç”¨éªŒè¯æ•°æ®ï¼Œä½ å°†åªéœ€å¤åˆ¶ç²˜è´´æ‰€æœ‰å†…å®¹ï¼Œç„¶åæŒ‡å®šå­é›†ä¸ºéªŒè¯ã€‚å‡è®¾ä½ å°†å®ƒä»¬æ”¾åœ¨ä¸åŒçš„æ–‡ä»¶å¤¹ä¸­ï¼Œä½ å°†æœ‰ä¸€ä¸ªè®­ç»ƒæ–‡ä»¶å¤¹å’Œä¸€ä¸ªéªŒè¯æ–‡ä»¶å¤¹ï¼Œä½ åªéœ€åœ¨è¿™é‡Œæ›´æ”¹æ–‡ä»¶å¤¹ï¼Œä¹Ÿè®¸ä½ ä¸æƒ³è¿›è¡Œæ•°æ®å¢å¼ºï¼Œå› æ­¤ä½ è¿˜éœ€è¦æŒ‡å®šä¸€ä¸ªæ–°çš„æ•°æ®ç”Ÿæˆå™¨ã€‚
- en: But yeahï¼Œ so then we're going to do specify see as wellã€‚ which is important
    if we want the same result for different runsã€‚And thenï¼Œ yeahã€‚ so that's it for
    the actual generatorã€‚Let me just show you an example exampleã€‚ so let's do a training
    loopã€‚And let's just do passã€‚
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†å¯¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†æŒ‡å®š seeï¼Œè¿™åœ¨æˆ‘ä»¬å¸Œæœ›ä¸åŒè¿è¡Œå¾—åˆ°ç›¸åŒç»“æœæ—¶å¾ˆé‡è¦ã€‚ç„¶åï¼Œå¥½çš„ã€‚è¿™å°±æ˜¯å®é™…ç”Ÿæˆå™¨çš„å†…å®¹ã€‚è®©æˆ‘ç»™ä½ å±•ç¤ºä¸€ä¸ªç¤ºä¾‹ã€‚æˆ‘ä»¬æ¥åšä¸€ä¸ªè®­ç»ƒå¾ªç¯ã€‚è®©æˆ‘ä»¬åªæ˜¯æ‰§è¡Œä¼ é€’ã€‚
- en: but here you could specify one sort of one training stepã€‚And then I'm gonna
    show youï¼Œ first of allã€‚ with custom loopsã€‚ And then this is a little bit different
    than what we saw previouslyã€‚ So let's say in range of I don't knowï¼Œ10 again or
    number of epos of your choiceã€‚ What we got to do here is we got to count the number
    of batchesã€‚ So let's say we start at0ã€‚
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†åœ¨è¿™é‡Œä½ å¯ä»¥æŒ‡å®šä¸€ä¸ªè®­ç»ƒæ­¥éª¤ã€‚ç„¶åæˆ‘å°†é¦–å…ˆå‘ä½ å±•ç¤ºè‡ªå®šä¹‰å¾ªç¯ã€‚è¿™ä¸æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„ç¨æœ‰ä¸åŒã€‚æ‰€ä»¥å‡è®¾åœ¨æˆ‘ä¸çŸ¥é“çš„èŒƒå›´å†…ï¼Œå†åš10æ¬¡æˆ–è€…ä½ é€‰æ‹©çš„è®­ç»ƒå‘¨æœŸã€‚æˆ‘ä»¬éœ€è¦åœ¨è¿™é‡Œè®¡ç®—æ‰¹æ¬¡æ•°ã€‚å› æ­¤å‡è®¾æˆ‘ä»¬ä»0å¼€å§‹ã€‚
- en: We're gonna do4 x and y in D S trainã€‚ we're gonna iterate up the number of batches
    by one rightã€‚ So we've now gone through one more batchã€‚ So we're gonna step oneã€‚
    Then we're gonnaã€‚Do trainingã€‚ so we're going to call trainingã€‚Right here and againã€‚
    this is in the custom loops tutorial if you're unfamiliar with thisã€‚
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å°†æ‰§è¡Œ4 x å’Œ y åœ¨ D S è®­ç»ƒä¸­ã€‚æˆ‘ä»¬å°†é€šè¿‡å¢åŠ æ‰¹æ¬¡æ•°æ¥è¿­ä»£ä¸€æ¬¡ã€‚ç°åœ¨æˆ‘ä»¬å·²ç»å¤„ç†äº†ä¸€ä¸ªé¢å¤–çš„æ‰¹æ¬¡ã€‚æˆ‘ä»¬å°†æ­¥è¿›ä¸€æ¬¡ã€‚ç„¶åæˆ‘ä»¬å°†è¿›è¡Œè®­ç»ƒã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†åœ¨è¿™é‡Œè°ƒç”¨è®­ç»ƒï¼Œå¹¶ä¸”è¿™åœ¨è‡ªå®šä¹‰å¾ªç¯æ•™ç¨‹ä¸­ï¼Œå¦‚æœä½ å¯¹æ­¤ä¸ç†Ÿæ‚‰çš„è¯ã€‚
- en: And then we're going to do if no batches is greater equal to 25ã€‚ So basically
    if it's equal to 25ã€‚And why I'm choosing 25 here is because that's the length
    of our data set or to be specificã€‚ the length of our train data set divided by
    the batch sizeã€‚So if that's the caseã€‚ then we've now gone through the entire data
    set and we need to breakã€‚
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åæˆ‘ä»¬è¦æ£€æŸ¥å¦‚æœæ‰¹æ•°å¤§äºç­‰äº25ã€‚å› æ­¤åŸºæœ¬ä¸Šå¦‚æœç­‰äº25ã€‚æˆ‘é€‰æ‹©25çš„åŸå› æ˜¯å› ä¸ºé‚£æ˜¯æˆ‘ä»¬çš„æ•°æ®é›†é•¿åº¦ï¼Œæˆ–è€…æ›´å…·ä½“åœ°è¯´ï¼Œæ˜¯æˆ‘ä»¬çš„è®­ç»ƒæ•°æ®é›†é•¿åº¦é™¤ä»¥æ‰¹å¤§å°ã€‚æ‰€ä»¥å¦‚æœæ˜¯è¿™ç§æƒ…å†µã€‚é‚£ä¹ˆæˆ‘ä»¬ç°åœ¨å·²ç»éå†äº†æ•´ä¸ªæ•°æ®é›†ï¼Œæˆ‘ä»¬éœ€è¦ä¸­æ–­ã€‚
- en: And the reason we need to break is because we have a generator object that's
    going to go on forever if we don't breakã€‚ So this is how you would specify the
    custom training loop set up andã€‚Let me just copy in the codeã€‚Right heres to save
    some timeã€‚ So let me go through itã€‚ if you would do model compileã€‚ Yesã€‚ were redoing
    model compile just to reset the optimizer stateã€‚
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬éœ€è¦ä¸­æ–­çš„åŸå› æ˜¯å› ä¸ºæˆ‘ä»¬æœ‰ä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡ï¼Œå¦‚æœä¸ä¸­æ–­å®ƒå°†æ°¸è¿œè¿è¡Œã€‚æ‰€ä»¥è¿™æ˜¯ä½ å¦‚ä½•æŒ‡å®šè‡ªå®šä¹‰è®­ç»ƒå¾ªç¯è®¾ç½®çš„æ–¹å¼ã€‚è®©æˆ‘å¤åˆ¶ä¸€ä¸‹ä»£ç ã€‚èŠ‚çœä¸€äº›æ—¶é—´ã€‚è®©æˆ‘è¿‡ä¸€ä¸‹ï¼Œå¦‚æœä½ è¦è¿›è¡Œæ¨¡å‹ç¼–è¯‘ã€‚æ˜¯çš„ï¼Œæˆ‘ä»¬é‡æ–°è¿›è¡Œæ¨¡å‹ç¼–è¯‘åªæ˜¯ä¸ºäº†é‡ç½®ä¼˜åŒ–å™¨çŠ¶æ€ã€‚
- en: so then we would have atom sparse categorical columnmetric accuracy nothing
    odd here and then when we do model fitã€‚ we send in the train generator that we
    you know constructed over here and then we do steps per epoch which is exactly
    the same as we did here if the number of batches equals 25 So the steps per epoch
    is 25 verbose equals2 just that is normal and thenã€‚
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åæˆ‘ä»¬å°†ä½¿ç”¨ç¨€ç–åˆ†ç±»åˆ—åº¦é‡å‡†ç¡®ç‡ï¼Œè¿™é‡Œæ²¡æœ‰ä»€ä¹ˆå¥‡æ€ªçš„ï¼Œç„¶åå½“æˆ‘ä»¬è¿›è¡Œæ¨¡å‹æ‹Ÿåˆæ—¶ï¼Œæˆ‘ä»¬å°†å‘é€æˆ‘ä»¬åœ¨è¿™é‡Œæ„å»ºçš„è®­ç»ƒç”Ÿæˆå™¨ï¼Œç„¶åè¿›è¡Œæ¯ä¸ªæ—¶æœŸçš„æ­¥éª¤ï¼Œä¸è¿™é‡Œçš„æ­¥éª¤å®Œå…¨ç›¸åŒï¼Œå¦‚æœæ‰¹é‡æ•°é‡ä¸º25ã€‚é‚£ä¹ˆæ¯ä¸ªæ—¶æœŸçš„æ­¥éª¤æ˜¯25ï¼Œverboseè®¾ç½®ä¸º2ï¼Œè¿™å¾ˆæ­£å¸¸ã€‚
- en: If we had a validation generatorï¼Œ we would do validation data is equal to that
    validation generatorã€‚ and then again the validation steps would be similarly as
    the steps per epochã€‚ which is the length of validation set divided by the batch
    sizeã€‚ Allrightã€‚ so that hopefully gives you a clear view of two different methods
    that you can use assuming that the data is structured in a subfold wayã€‚
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªéªŒè¯ç”Ÿæˆå™¨ï¼Œæˆ‘ä»¬ä¼šå°†éªŒè¯æ•°æ®è®¾ç½®ä¸ºç­‰äºè¯¥éªŒè¯ç”Ÿæˆå™¨ã€‚ç„¶åéªŒè¯æ­¥éª¤å°†ä¸æ¯ä¸ªæ—¶æœŸçš„æ­¥éª¤ç±»ä¼¼ï¼Œå³éªŒè¯é›†çš„é•¿åº¦é™¤ä»¥æ‰¹é‡å¤§å°ã€‚å¥½çš„ã€‚è¿™å¸Œæœ›èƒ½ä¸ºä½ æä¾›ä¸¤ç§ä¸åŒæ–¹æ³•çš„æ¸…æ™°è§†è§’ï¼Œå‡è®¾æ•°æ®æ˜¯ä»¥å­æ–‡ä»¶å¤¹çš„æ–¹å¼ç»“æ„åŒ–çš„ã€‚
- en: '![](img/5a48387aad10b0cf4a2d2bc3dacad647_15.png)'
  id: totrans-39
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5a48387aad10b0cf4a2d2bc3dacad647_15.png)'
- en: So the second way that your dataset might be structured is that you have all
    of the images in a folder and then you have a corresponding CSV file and a CSV
    file tells you the fine name and then the label so for exampleã€‚ in this case it
    says that 0 underscore 1 JPEG is a target labels so the digit is0ã€‚
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: ç¬¬äºŒç§ä½ çš„æ•°æ®é›†å¯èƒ½ç»“æ„åŒ–çš„æ–¹å¼æ˜¯ï¼Œä½ å°†æ‰€æœ‰å›¾åƒæ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œç„¶åæœ‰ä¸€ä¸ªå¯¹åº”çš„CSVæ–‡ä»¶ï¼ŒCSVæ–‡ä»¶å‘Šè¯‰ä½ æ–‡ä»¶åå’Œæ ‡ç­¾ã€‚ä¾‹å¦‚ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒè¯´æ˜0_1
    JPEGæ˜¯ç›®æ ‡æ ‡ç­¾ï¼Œæ‰€ä»¥æ•°å­—æ˜¯0ã€‚
- en: the label of that is0ï¼Œ and then it does that for all of the images in the folder
    and it gives all of the corresponding labelsã€‚So if that's the way which is also
    a common way to structure your dataã€‚ then I'm going show you exactly what you
    want to do  moving on to the code these are the imports that we're going to use
    and I guess it's nothing weird there the first thing we're going to do is we're
    going to specify the directory so the red oh my God the directory is data and
    then Mmunist images CSv that's just what I decided to call it and the first thing
    we're going to do is we're going to do data frame is pandas do read CSVã€‚
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: æ ‡ç­¾æ˜¯0ï¼Œç„¶åå¯¹æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰å›¾åƒéƒ½è¿™æ ·å¤„ç†ï¼Œå¹¶ç»™å‡ºæ‰€æœ‰å¯¹åº”çš„æ ‡ç­¾ã€‚æ‰€ä»¥å¦‚æœè¿™æ˜¯æ•°æ®ç»“æ„åŒ–çš„ä¸€ç§å¸¸è§æ–¹å¼ï¼Œé‚£ä¹ˆæˆ‘å°†å‘Šè¯‰ä½ è¯¥å¦‚ä½•è¿›è¡Œã€‚æ¥ä¸‹æ¥æ˜¯ä»£ç ï¼Œè¿™äº›æ˜¯æˆ‘ä»¬å°†è¦ä½¿ç”¨çš„å¯¼å…¥ï¼Œæˆ‘æƒ³è¿™æ²¡æœ‰ä»€ä¹ˆå¥‡æ€ªçš„ã€‚æˆ‘ä»¬è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯æŒ‡å®šç›®å½•ï¼Œå“¦æˆ‘çš„å¤©ï¼Œç›®å½•æ˜¯æ•°æ®ï¼Œç„¶åæ˜¯Mmunist
    images CSVï¼Œè¿™å°±æ˜¯æˆ‘å†³å®šçš„åç§°ã€‚æˆ‘ä»¬è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯ä½¿ç”¨pandasè¯»å–CSVä»¥åˆ›å»ºæ•°æ®æ¡†ã€‚
- en: '![](img/5a48387aad10b0cf4a2d2bc3dacad647_17.png)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5a48387aad10b0cf4a2d2bc3dacad647_17.png)'
- en: '![](img/5a48387aad10b0cf4a2d2bc3dacad647_18.png)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5a48387aad10b0cf4a2d2bc3dacad647_18.png)'
- en: And then so we're going to read the CSE file with pandasã€‚ We're going to specify
    the directory and we're going to doã€‚Then we're going to add train dot CSVã€‚ Now
    that we have the CSV fileï¼Œ what we can do is we can do file pathsã€‚We can do data
    frame and then we can obtain from that columnï¼Œ remember we call that column file
    nameã€‚
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åæˆ‘ä»¬å°†ä½¿ç”¨pandasè¯»å–CSVæ–‡ä»¶ã€‚æˆ‘ä»¬å°†æŒ‡å®šç›®å½•ï¼Œç„¶åè¿›è¡Œã€‚ç„¶åæˆ‘ä»¬å°†æ·»åŠ train.csvã€‚ç°åœ¨æˆ‘ä»¬æœ‰äº†CSVæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å¤„ç†æ–‡ä»¶è·¯å¾„ã€‚æˆ‘ä»¬å¯ä»¥åˆ›å»ºæ•°æ®æ¡†ï¼Œç„¶åä»è¯¥åˆ—ä¸­è·å–ï¼Œè®°ä½æˆ‘ä»¬ç§°ä¹‹ä¸ºæ–‡ä»¶åçš„é‚£ä¸€åˆ—ã€‚
- en: And then we can do that valuesã€‚ That's gonna to give us all of rightï¼Œ let meã€‚
    let me print it actuallyã€‚ It's going to become a little bit clearerï¼Œ I thinkã€‚Soã€‚Like
    thatã€‚Whatã€‚Oh file padsã€‚ All rightï¼Œ so as you can see hereï¼Œ we basically get a
    list of all of the the file names and in this wayã€‚ and in this caseï¼Œ they're actually
    pretty nice formattedã€‚ you have you knowã€‚
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åæˆ‘ä»¬å¯ä»¥å¤„ç†è¿™äº›å€¼ã€‚è¿™å°†ç»™æˆ‘ä»¬æ‰€æœ‰çš„æ­£ç¡®ç»“æœï¼Œè®©æˆ‘å®é™…æ‰“å°ä¸€ä¸‹ã€‚è¿™æ ·ä¼šæ›´æ¸…æ™°ã€‚æˆ‘æƒ³ã€‚æ‰€ä»¥ï¼Œåƒè¿™æ ·ã€‚å“¦ï¼Œæ–‡ä»¶è·¯å¾„ã€‚å¥½çš„ï¼Œæ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šå¾—åˆ°äº†æ‰€æœ‰æ–‡ä»¶åçš„åˆ—è¡¨ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒä»¬æ ¼å¼å¾ˆå¥½ã€‚ä½ çŸ¥é“ã€‚
- en: you have the label right here and then you have the index for that oneã€‚ So this
    is a a digit0ã€‚ digit0ï¼Œ digit1 and so onã€‚ But anywaysï¼Œ then we have the file pads
    and we can get the labelsã€‚ we can do that by doing pretty much same thingï¼Œ but
    we do label and then we do dot valuesã€‚Now that we have the file pads and the labels
    and the labels in this case are going to be integerã€‚
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ åœ¨è¿™é‡Œæœ‰æ ‡ç­¾ï¼Œç„¶åä½ æœ‰é‚£ä¸ªçš„ç´¢å¼•ã€‚æ‰€ä»¥è¿™æ˜¯ digit0ã€digit0ã€digit1ï¼Œä¾æ­¤ç±»æ¨ã€‚ä¸è¿‡ï¼Œä¸ç®¡æ€æ ·ï¼Œæˆ‘ä»¬æœ‰æ–‡ä»¶è·¯å¾„ï¼Œæˆ‘ä»¬å¯ä»¥è·å–æ ‡ç­¾ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡åšå‡ ä¹ç›¸åŒçš„äº‹æƒ…æ¥åšåˆ°è¿™ä¸€ç‚¹ï¼Œä½†æˆ‘ä»¬åšæ ‡ç­¾ï¼Œç„¶åæˆ‘ä»¬åš
    dot valuesã€‚ç°åœ¨æˆ‘ä»¬æœ‰äº†æ–‡ä»¶è·¯å¾„å’Œæ ‡ç­¾ï¼Œè€Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ ‡ç­¾å°†æ˜¯æ•´æ•°ã€‚
- en: what we do then is we do Dtrain is Tf dot data do data set dot from tensor slices
    All right so what we do then is we send in the file padsã€‚And then the labelsã€‚
    all rightï¼Œ and we do this becauseã€‚The first one in thisã€‚ so the first value in
    this file paths list is going to be equal to the label of the first element in
    this labels listã€‚ so that we use from from tensor slices to sort of map them together
    similar to as you would do zip in Python What we do then is we do a function for
    read imageã€‚
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åæˆ‘ä»¬åšçš„æ˜¯ Dtrain æ˜¯ Tf dot data do data set dot from tensor slicesã€‚å¥½å§ï¼Œæ‰€ä»¥æˆ‘ä»¬åšçš„æ˜¯å‘é€æ–‡ä»¶è·¯å¾„ã€‚ç„¶åæ˜¯æ ‡ç­¾ã€‚å¥½çš„ï¼Œæˆ‘ä»¬è¿™æ ·åšæ˜¯å› ä¸ºåœ¨è¿™ä¸ªåˆ—è¡¨ä¸­ï¼Œç¬¬ä¸€ä¸ªå€¼å°†ç­‰äºè¿™ä¸ªæ ‡ç­¾åˆ—è¡¨ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ çš„æ ‡ç­¾ã€‚å› æ­¤æˆ‘ä»¬ä½¿ç”¨
    from from tensor slices å°†å®ƒä»¬æ˜ å°„åœ¨ä¸€èµ·ï¼Œç±»ä¼¼äºä½ åœ¨ Python ä¸­ä½¿ç”¨ zipã€‚ç„¶åæˆ‘ä»¬åšä¸€ä¸ªè¯»å–å›¾åƒçš„å‡½æ•°ã€‚
- en: So we send in the image file and we also send in the labelã€‚ So the first thing
    we do is we do Tf do o do read fileã€‚ So we're going to read that file from that
    image fileã€‚And alsoï¼Œ ratherã€‚ we need to specify the directory first and then we
    need to add the image fileã€‚Rightã€‚
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥æˆ‘ä»¬å‘é€å›¾åƒæ–‡ä»¶ï¼Œä¹Ÿå‘é€æ ‡ç­¾ã€‚æˆ‘ä»¬é¦–å…ˆåšçš„æ˜¯ TF do o do è¯»å–æ–‡ä»¶ã€‚æ‰€ä»¥æˆ‘ä»¬å°†ä»å›¾åƒæ–‡ä»¶ä¸­è¯»å–é‚£ä¸ªæ–‡ä»¶ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæŒ‡å®šç›®å½•ï¼Œç„¶åæ·»åŠ å›¾åƒæ–‡ä»¶ã€‚å¯¹å§ã€‚
- en: so we're reading that fileï¼Œ then we're going do TF dot image dot decocode imageã€‚And
    then we're going to send in that imageï¼Œ we're going to do channels equals1 because
    we have grayscaleã€‚ then we're going to do D type is Tf floatat 32ï¼Œ and then we
    just return image and then the labelã€‚And just for illustrationï¼Œ let me also show
    youï¼Œ or rather not show you wouldã€‚
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬æ­£åœ¨è¯»å–é‚£ä¸ªæ–‡ä»¶ï¼Œç„¶åæˆ‘ä»¬å°†åš TF dot image dot decode imageã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†å‘é€å›¾åƒï¼Œé€šé“è®¾ç½®ä¸º 1ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰ç°åº¦å›¾åƒã€‚ç„¶åæˆ‘ä»¬å°†
    D type è®¾ç½®ä¸º Tf floatat 32ï¼Œç„¶åæˆ‘ä»¬åªè¿”å›å›¾åƒå’Œæ ‡ç­¾ã€‚ä¸ºäº†è¯´æ˜ï¼Œè®©æˆ‘ä¹Ÿç»™ä½ å±•ç¤ºä¸€ä¸‹ï¼Œæˆ–è€…è¯´ä¸å±•ç¤ºä½ å°†ä¼šã€‚
- en: you would do something like define augmentã€‚ if you want data augmentationï¼Œ you
    do image and labelã€‚ and thenã€‚I guess data augmentation hereï¼Œ but in this case
    let's just return image and label and then you would do map similarly as we did
    beforeã€‚ so DSre dot mapï¼Œ we would send that to read image and then you know dot
    map augment and then we can do dot batch of twoã€‚Yeahã€‚So now that we have the Ds
    trainã€‚ so that that's all for loading the dataã€‚
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ å¯ä»¥å®šä¹‰å¢å¼ºã€‚å¦‚æœä½ æƒ³è¦æ•°æ®å¢å¼ºï¼Œä½ éœ€è¦å›¾åƒå’Œæ ‡ç­¾ã€‚ç„¶åï¼Œæˆ‘æƒ³è¿™é‡Œæ˜¯æ•°æ®å¢å¼ºï¼Œä½†åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªè¿”å›å›¾åƒå’Œæ ‡ç­¾ï¼Œç„¶åä½ ä¼šåƒä¹‹å‰ä¸€æ ·åšæ˜ å°„ã€‚æ‰€ä»¥ DSre
    dot mapï¼Œæˆ‘ä»¬ä¼šå‘é€ç»™è¯»å–å›¾åƒï¼Œç„¶åä½ çŸ¥é“çš„ dot map augmentï¼Œç„¶åæˆ‘ä»¬å¯ä»¥è¿›è¡Œä¸¤ä¸ªçš„ dot batchã€‚å¥½çš„ã€‚å› æ­¤ï¼Œç°åœ¨æˆ‘ä»¬æœ‰äº† Ds
    trainã€‚è¿™å°±æ˜¯åŠ è½½æ•°æ®çš„å…¨éƒ¨å†…å®¹ã€‚
- en: And I just want to show you how you would set it up for training and it's pretty
    basicã€‚ We would do forpoC in range of 10ã€‚Then we would do4 x and Y in DS S trainã€‚
    So we would train hereã€‚ in this caseï¼Œ we're just going do pass orã€‚Let's do printã€‚
    Nowï¼Œ let's just do passã€‚ Alrightã€‚ so then let me copy in just to show you that
    it worksï¼Œ soã€‚
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘åªæƒ³ç»™ä½ å±•ç¤ºå¦‚ä½•ä¸ºè®­ç»ƒè®¾ç½®ï¼Œå®ƒéå¸¸åŸºæœ¬ã€‚æˆ‘ä»¬å°†åš for poC åœ¨ 10 çš„èŒƒå›´å†…ã€‚ç„¶åæˆ‘ä»¬å°†åš 4 x å’Œ Y åœ¨ DS S trainã€‚å› æ­¤æˆ‘ä»¬å°†åœ¨è¿™é‡Œè®­ç»ƒã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªä¼š
    passã€‚è®©æˆ‘ä»¬åšæ‰“å°ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬åªåš passã€‚å¥½çš„ã€‚é‚£ä¹ˆè®©æˆ‘å¤åˆ¶ä¸€ä¸‹ï¼Œç»™ä½ å±•ç¤ºå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚
- en: Here we have the same model as we saw previouslyï¼Œ simple modelã€‚And then we have
    model compileã€‚ and then model fitã€‚And all of this should be very familiar from
    previous videosã€‚ then if we just run itã€‚We can see that we're overfitting pretty
    quickly because we have so few imagesã€‚ but that's kind of what we expectã€‚So that's
    the method toã€‚
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™é‡Œæˆ‘ä»¬æœ‰ä¸ä¹‹å‰çœ‹åˆ°çš„ç›¸åŒçš„æ¨¡å‹ï¼Œç®€å•æ¨¡å‹ã€‚ç„¶åæˆ‘ä»¬æœ‰ model compileã€‚æ¥ä¸‹æ¥æ˜¯ model fitã€‚æ‰€æœ‰è¿™äº›åœ¨ä¹‹å‰çš„è§†é¢‘ä¸­åº”è¯¥éå¸¸ç†Ÿæ‚‰ã€‚ç„¶åå¦‚æœæˆ‘ä»¬è¿è¡Œå®ƒï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å¾ˆå¿«å°±è¿‡æ‹Ÿåˆäº†ï¼Œå› ä¸ºå›¾åƒå¤ªå°‘äº†ã€‚ä½†è¿™æ­£æ˜¯æˆ‘ä»¬æ‰€æœŸå¾…çš„ã€‚è¿™å°±æ˜¯æ–¹æ³•ã€‚
- en: and hopefully this gives you a nice way to a nice general way how you would
    do thisã€‚![](img/5a48387aad10b0cf4a2d2bc3dacad647_20.png)
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: å¸Œæœ›è¿™èƒ½ç»™ä½ ä¸€ä¸ªå¾ˆå¥½çš„æ–¹æ³•ï¼Œå±•ç¤ºå¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ã€‚![](img/5a48387aad10b0cf4a2d2bc3dacad647_20.png)
- en: '![](img/5a48387aad10b0cf4a2d2bc3dacad647_21.png)'
  id: totrans-54
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5a48387aad10b0cf4a2d2bc3dacad647_21.png)'
- en: Alrightï¼Œ so the third way is if you would just have all of the images in a single
    single folderã€‚ so in this case we have no CSV fileï¼Œ we just have all of them thrown
    into a single folder but we're assuming here that there is some nice format so
    that we can interpret the label for that image just by having the file name so
    in this case we as we said before the first digit here is representing the class
    of that image and in the second value is just the index so we can actually just
    from the file nameã€‚
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: å¥½çš„ï¼Œç¬¬ä¸‰ç§æ–¹å¼æ˜¯å¦‚æœä½ å°†æ‰€æœ‰å›¾åƒæ”¾åœ¨ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶å¤¹ä¸­ã€‚å› æ­¤åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ²¡æœ‰CSVæ–‡ä»¶ï¼Œåªæ˜¯å°†æ‰€æœ‰æ–‡ä»¶æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œä½†æˆ‘ä»¬å‡è®¾è¿™é‡Œæœ‰æŸç§è‰¯å¥½çš„æ ¼å¼ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥é€šè¿‡æ–‡ä»¶åè§£é‡Šè¯¥å›¾åƒçš„æ ‡ç­¾ã€‚å› æ­¤åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ­£å¦‚æˆ‘ä»¬ä¹‹å‰æ‰€è¯´ï¼Œé¦–ä½æ•°å­—ä»£è¡¨å›¾åƒçš„ç±»åˆ«ï¼Œç¬¬äºŒä¸ªå€¼åªæ˜¯ç´¢å¼•ï¼Œå› æ­¤æˆ‘ä»¬å®é™…ä¸Šå¯ä»¥ä»…é€šè¿‡æ–‡ä»¶åè¿›è¡Œå¤„ç†ã€‚
- en: we can interpret what the label should be for that imageã€‚![](img/5a48387aad10b0cf4a2d2bc3dacad647_23.png)
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥è§£é‡Šè¯¥å›¾åƒçš„æ ‡ç­¾åº”è¯¥æ˜¯ä»€ä¹ˆã€‚![](img/5a48387aad10b0cf4a2d2bc3dacad647_23.png)
- en: So going to the codeï¼Œ these aret inputs that we're going to useï¼Œ we're also
    going to use Pathlibã€‚ it's in the standard libraryï¼Œ and I'm going to show you
    in just in a minute what we are going to use it forã€‚So let's start with specifyingï¼Œ
    I guessï¼Œ the batch sizeï¼Œ let's do two and then image height is 28ã€‚ image width
    is 28ã€‚And then we're going to specify the directoryã€‚
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥è¿›å…¥ä»£ç ï¼Œè¿™äº›æ˜¯æˆ‘ä»¬å°†è¦ä½¿ç”¨çš„è¾“å…¥ï¼Œæˆ‘ä»¬è¿˜å°†ä½¿ç”¨`Pathlib`ã€‚å®ƒåœ¨æ ‡å‡†åº“ä¸­ï¼Œæˆ‘å°†åœ¨ç¨åç»™ä½ å±•ç¤ºæˆ‘ä»¬å°†ç”¨å®ƒåšä»€ä¹ˆã€‚å› æ­¤ï¼Œè®©æˆ‘ä»¬å¼€å§‹æŒ‡å®šï¼Œæˆ‘æƒ³ï¼Œæˆ‘ä»¬å°†æ‰¹å¤§å°è®¾ç½®ä¸º2ï¼Œç„¶åå›¾åƒé«˜åº¦ä¸º28ï¼Œå›¾åƒå®½åº¦ä¸º28ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†æŒ‡å®šç›®å½•ã€‚
- en: which is data and then emist images onlyã€‚ So first of allã€‚ to create the Tensorflow
    data set we're going to do Ds train is Tf dot data dot data dot list filesã€‚Then
    we're going to do a stringï¼Œ and here were going to specify we're going to use
    the pathlibã€‚So not to go too much in depthï¼Œ this is we're using pathlib here because
    that is the format that list files wants the defaulted directory inã€‚
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: ä¹Ÿå°±æ˜¯æ•°æ®ï¼Œå¹¶ä¸”ä»…é™äºEMNISTå›¾åƒã€‚å› æ­¤é¦–å…ˆï¼Œè¦åˆ›å»ºTensorFlowæ•°æ®é›†ï¼Œæˆ‘ä»¬å°†æ‰§è¡Œ`Ds_train = TF.data.Dataset.list_files`ã€‚ç„¶åæˆ‘ä»¬å°†æ‰§è¡Œä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°†æŒ‡å®šä½¿ç”¨`pathlib`ã€‚æ‰€ä»¥ä¸æ·±å…¥æ¢è®¨ï¼Œæˆ‘ä»¬ä½¿ç”¨`pathlib`æ˜¯å› ä¸ºè¿™æ˜¯`list_files`å¸Œæœ›çš„é»˜è®¤ç›®å½•æ ¼å¼ã€‚
- en: So we're just going to do pathlibã€‚t path then we're going to do the directoryã€‚Then
    we're going do plusï¼Œ and thenã€‚t Jpegï¼Œ al rightã€‚ so it's basically going to find
    all of the files in that directory which is right here that ends with a JpeEg
    fileã€‚ Alrightï¼Œ so what you would do then is we would define a process to actually
    you knowã€‚
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥æˆ‘ä»¬å°†ä½¿ç”¨`pathlib.Path`ï¼Œç„¶åè·å–ç›®å½•ã€‚æ¥ç€åŠ ä¸Š`.jpeg`ï¼Œå¥½çš„ã€‚æ‰€ä»¥å®ƒåŸºæœ¬ä¸Šä¼šæ‰¾åˆ°è¯¥ç›®å½•ä¸­ä»¥`.jpeg`ç»“å°¾çš„æ‰€æœ‰æ–‡ä»¶ã€‚å¥½çš„ï¼Œé‚£ä¹ˆä½ æ¥ä¸‹æ¥è¦åšçš„æ˜¯å®šä¹‰ä¸€ä¸ªå¤„ç†å‡½æ•°ã€‚
- en: given the file padï¼Œ we need to process the image just as we saw for for from
    the previous file So we're going to do define process pathã€‚We're gonna send in
    the file packã€‚And then we're going to do image is TFI O read file of the file
    pathã€‚Then we're going to do image is Tf image dodecode JpeEG of that imageï¼Œ and
    then channels equals1ã€‚Then for the labels and this is going to depend on the file
    format of of your imagesã€‚
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: ç»™å®šæ–‡ä»¶è·¯å¾„ï¼Œæˆ‘ä»¬éœ€è¦å¤„ç†å›¾åƒï¼Œå°±åƒæˆ‘ä»¬åœ¨ä¹‹å‰çš„æ–‡ä»¶ä¸­çœ‹åˆ°çš„é‚£æ ·ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†å®šä¹‰å¤„ç†è·¯å¾„ã€‚æˆ‘ä»¬ä¼šå‘é€æ–‡ä»¶åŒ…ã€‚ç„¶åæˆ‘ä»¬å°†ä½¿ç”¨`TFIO.read_file`è¯»å–æ–‡ä»¶è·¯å¾„ä¸­çš„å›¾åƒã€‚æ¥ç€æˆ‘ä»¬ä¼šè¿›è¡Œ`TF.image.decode_jpeg`ï¼Œç„¶åé€šé“è®¾ç½®ä¸º1ã€‚ç„¶åï¼Œæ ‡ç­¾å°†å–å†³äºå›¾åƒçš„æ–‡ä»¶æ ¼å¼ã€‚
- en: so this is going to be different for every scenario I'm just showing you one
    wayã€‚ So label here is TF strings dots we're going do Tf strings dot split we're
    going to do the file path and then we're going to specify the split So in this
    case we're splitting by the path separator I believe it's called and then in our
    caseã€‚
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥è¿™å¯¹äºæ¯ç§åœºæ™¯éƒ½æ˜¯ä¸åŒçš„ï¼Œæˆ‘åªæ˜¯ç»™ä½ å±•ç¤ºä¸€ç§æ–¹æ³•ã€‚å› æ­¤è¿™é‡Œçš„æ ‡ç­¾æ˜¯`TF.strings`ï¼Œæˆ‘ä»¬å°†æ‰§è¡Œ`TF.strings.split`ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ–‡ä»¶è·¯å¾„ï¼Œç„¶åæŒ‡å®šåˆ†å‰²ã€‚æ‰€ä»¥åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ˜¯æŒ‰è·¯å¾„åˆ†éš”ç¬¦åˆ†å‰²çš„ï¼Œæˆ‘è®¤ä¸ºå®ƒè¢«ç§°ä¸ºï¼Œç„¶ååœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ã€‚
- en: Maybe I can actually do thisã€‚ So for x and y in the S trainï¼Œ I can do as to
    Y printã€‚ Y TF strings do splitã€‚And then or ratherï¼Œ we just have a file pathï¼Œ so
    file pathã€‚So we're gonna split the file pathã€‚By this and you're just going to
    see what it looks likeã€‚And in this wayï¼Œ I think you can easier follow the the
    logic I hadã€‚ So here we have dataã€‚
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: ä¹Ÿè®¸æˆ‘å¯ä»¥è¿™æ ·åšã€‚å› æ­¤å¯¹äº`x`å’Œ`y`åœ¨`S_train`ä¸­ï¼Œæˆ‘å¯ä»¥æ‰§è¡Œ`Y.print`ã€‚`Y.TF.strings.split`ã€‚è€Œä¸”æˆ–è€…è¯´ï¼Œæˆ‘ä»¬åªæ˜¯æœ‰ä¸€ä¸ªæ–‡ä»¶è·¯å¾„ï¼Œæ‰€ä»¥æ–‡ä»¶è·¯å¾„ã€‚æˆ‘ä»¬å°†é€šè¿‡è¿™ä¸ªæ¥åˆ†å‰²æ–‡ä»¶è·¯å¾„ã€‚ä½ å°†çœ‹åˆ°å®ƒçš„æ ·å­ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘è®¤ä¸ºä½ å¯ä»¥æ›´å®¹æ˜“åœ°è·Ÿéšæˆ‘æ‰€é‡‡ç”¨çš„é€»è¾‘ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬æœ‰æ•°æ®ã€‚
- en: emmin images onlyã€‚ and then we have thisã€‚ Andï¼Œ of courseã€‚ here is the important
    information about the fileã€‚ So what we're going to do is we're going to take the
    the second index of this listã€‚ So we're going to take this partã€‚Now in our caseï¼Œ
    and this is dependent on your dataset againã€‚ but in our case we can just take
    this one right here and convert it to a numberã€‚
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: ä»…é™äºemminå›¾åƒã€‚ç„¶åæˆ‘ä»¬æœ‰è¿™ä¸ªã€‚å½“ç„¶ï¼Œè¿™é‡Œæ˜¯å…³äºæ–‡ä»¶çš„é‡è¦ä¿¡æ¯ã€‚é‚£ä¹ˆæˆ‘ä»¬è¦åšçš„æ˜¯å–è¿™ä¸ªåˆ—è¡¨çš„ç¬¬äºŒä¸ªç´¢å¼•ã€‚æˆ‘ä»¬å°†å–è¿™éƒ¨åˆ†ã€‚åœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œè¿™å–å†³äºæ‚¨çš„æ•°æ®é›†ï¼Œä½†åœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å–è¿™ä¸ªå¹¶å°†å…¶è½¬æ¢ä¸ºæ•°å­—ã€‚
- en: so how we can do that is let's see we can do label is Tfstrsã€‚ substr of label
    position zero and then the length is one and if you would have you know varying
    length of of your class names and you could perhaps you split again if you would
    have something like you know catsã€‚
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹å‘¢ï¼Ÿè®©æˆ‘ä»¬çœ‹çœ‹ï¼Œæˆ‘ä»¬å¯ä»¥åšlabelæ˜¯`Tfstrs.substr`ï¼Œä»labelä½ç½®é›¶å¼€å§‹ï¼Œé•¿åº¦ä¸ºä¸€ã€‚å¦‚æœæ‚¨çš„ç±»åç§°é•¿åº¦ä¸ä¸€ï¼Œæ‚¨å¯ä»¥å†æ¬¡åˆ†å‰²ï¼Œä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æœ‰åƒçŒ«è¿™æ ·çš„ä¸œè¥¿ã€‚
- en: dogsï¼Œ horses something like thatï¼Œ and you would have that these two are different
    in length you would need to split it some in some wayã€‚But this is just how you
    would handle stringsã€‚And then labelï¼Œ we can do TF strings do2 numberã€‚ and we send
    in the label and we can also specify the out type to be TF in 64ã€‚So in in this
    caseã€‚ then we have processed image and also the labelã€‚ So then what we would doã€‚Is
    DSstrain is DSstraininã€‚
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: ç‹—ï¼Œé©¬ä¹‹ç±»çš„ï¼Œå¦‚æœè¿™ä¸¤è€…çš„é•¿åº¦ä¸åŒï¼Œæ‚¨éœ€è¦ä»¥æŸç§æ–¹å¼è¿›è¡Œåˆ†å‰²ã€‚ä½†è¿™åªæ˜¯å¤„ç†å­—ç¬¦ä¸²çš„æ–¹å¼ã€‚ç„¶ålabelï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨`TF strings do2 number`ï¼Œä¼ å…¥labelï¼Œå¹¶ä¸”æˆ‘ä»¬ä¹Ÿå¯ä»¥æŒ‡å®šè¾“å‡ºç±»å‹ä¸ºTF
    in 64ã€‚æ‰€ä»¥åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æœ‰å¤„ç†è¿‡çš„å›¾åƒå’Œæ ‡ç­¾ã€‚é‚£ä¹ˆæˆ‘ä»¬è¦åšçš„æ˜¯`DSstrain`æ˜¯`DSstrainin`ã€‚
- en: mapã€‚And then we would just do a process pathã€‚And then we would do batch and
    then send in the batch sizeã€‚Alrightï¼Œ and then I'm gonna copy the model again and
    just make sure that this worksã€‚ So we haveã€‚ you knowï¼Œ againï¼Œ the model that we
    have previously simple modelã€‚ we have model compile similar as before model that
    fit and we send in that D S trainã€‚
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: æ˜ å°„ã€‚ç„¶åæˆ‘ä»¬åªéœ€åšä¸€ä¸ªå¤„ç†è·¯å¾„ã€‚æ¥ç€æˆ‘ä»¬ä¼šè¿›è¡Œæ‰¹å¤„ç†å¹¶ä¼ å…¥æ‰¹é‡å¤§å°ã€‚å¥½çš„ï¼Œæˆ‘å°†å†æ¬¡å¤åˆ¶æ¨¡å‹ï¼Œç¡®ä¿å®ƒèƒ½æ­£å¸¸å·¥ä½œã€‚å› æ­¤ï¼Œæˆ‘ä»¬æœ‰ï¼Œæ‚¨çŸ¥é“çš„ï¼Œä¹‹å‰çš„ç®€å•æ¨¡å‹ã€‚æˆ‘ä»¬æ¨¡å‹ç¼–è¯‘ä¸ä¹‹å‰ç›¸ä¼¼ï¼Œæ¨¡å‹æ‹Ÿåˆï¼Œå¹¶ä¼ å…¥`D
    S train`ã€‚
- en: So let's run it to make sure it worksã€‚ Oh yeahã€‚ So here we need to also take
    index2ã€‚ So let's rerun itã€‚All rightï¼Œ so then we see after tinyny buckï¼Œ we'll get
    100% training accuracyã€‚All rightï¼Œ so thank you so much for watching the video
    that was three ways that you can load a custom data set for images in TensorFlow
    hopefully you found the video useful and I hope to see you in the next videoã€‚
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥è®©æˆ‘ä»¬è¿è¡Œä¸€ä¸‹ï¼Œç¡®ä¿å®ƒèƒ½æ­£å¸¸å·¥ä½œã€‚å“¦ï¼Œå¯¹äº†ã€‚è¿™é‡Œæˆ‘ä»¬è¿˜éœ€è¦å–`index2`ã€‚æ‰€ä»¥è®©æˆ‘ä»¬é‡æ–°è¿è¡Œä¸€ä¸‹ã€‚å¥½çš„ï¼Œæˆ‘ä»¬çœ‹åˆ°åœ¨tiny buckä¹‹åï¼Œæˆ‘ä»¬å°†è·å¾—100%çš„è®­ç»ƒå‡†ç¡®ç‡ã€‚éå¸¸æ„Ÿè°¢æ‚¨è§‚çœ‹è¿™ä¸ªè§†é¢‘ï¼Œè¿™é‡Œä»‹ç»äº†ä¸‰ç§åŠ è½½è‡ªå®šä¹‰å›¾åƒæ•°æ®é›†çš„æ–¹æ³•ï¼Œå¸Œæœ›æ‚¨è§‰å¾—è¿™ä¸ªè§†é¢‘æœ‰ç”¨ï¼ŒæœŸå¾…åœ¨ä¸‹ä¸ªè§†é¢‘ä¸­è§åˆ°æ‚¨ã€‚
- en: '![](img/5a48387aad10b0cf4a2d2bc3dacad647_25.png)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5a48387aad10b0cf4a2d2bc3dacad647_25.png)'
- en: '![](img/5a48387aad10b0cf4a2d2bc3dacad647_26.png)'
  id: totrans-69
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5a48387aad10b0cf4a2d2bc3dacad647_26.png)'
