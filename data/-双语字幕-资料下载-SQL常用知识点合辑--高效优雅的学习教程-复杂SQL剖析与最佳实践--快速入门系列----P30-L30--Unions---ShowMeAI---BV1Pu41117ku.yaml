- en: ã€åŒè¯­å­—å¹•+èµ„æ–™ä¸‹è½½ã€‘SQLå¸¸ç”¨çŸ¥è¯†ç‚¹åˆè¾‘â€”â€”é«˜æ•ˆä¼˜é›…çš„å­¦ä¹ æ•™ç¨‹ï¼Œå¤æ‚SQLå‰–æä¸æœ€ä½³å®è·µï¼ï¼œå¿«é€Ÿå…¥é—¨ç³»åˆ—ï¼ - P30ï¼šL30- Unions - ShowMeAI
    - BV1Pu41117ku
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ã€åŒè¯­å­—å¹•+èµ„æ–™ä¸‹è½½ã€‘SQLå¸¸ç”¨çŸ¥è¯†ç‚¹åˆè¾‘â€”â€”é«˜æ•ˆä¼˜é›…çš„å­¦ä¹ æ•™ç¨‹ï¼Œå¤æ‚SQLå‰–æä¸æœ€ä½³å®è·µï¼ï¼œå¿«é€Ÿå…¥é—¨ç³»åˆ—ï¼ - P30ï¼šL30- è”åˆ - ShowMeAI
    - BV1Pu41117ku
- en: '![](img/04095bb29a99dad8fca5419a36682056_0.png)'
  id: totrans-1
  prefs: []
  type: TYPE_IMG
  zh: '![](img/04095bb29a99dad8fca5419a36682056_0.png)'
- en: å“¦ã€‚We covered everything about jointsã€‚ youll learn that with joints we can combine
    columns from multiple tablesã€‚ but in SQL we can also combine rows from multiple
    tablesï¼Œ and this is extremely powerfulã€‚ Let me show you how that worksã€‚ğŸ˜Šï¼ŒFirstï¼Œ
    let's have a quick look at our orders tableã€‚ so select everything from the orders
    tableã€‚Nowï¼Œ if you look at the dataã€‚ğŸ˜Šã€‚
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: å“¦ã€‚æˆ‘ä»¬å·²ç»æ¶µç›–äº†æ‰€æœ‰å…³äºè¿æ¥çš„å†…å®¹ã€‚ä½ å°†äº†è§£åˆ°ï¼Œé€šè¿‡è¿æ¥æˆ‘ä»¬å¯ä»¥ç»„åˆæ¥è‡ªå¤šä¸ªè¡¨çš„åˆ—ã€‚ä½†åœ¨SQLä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç»„åˆæ¥è‡ªå¤šä¸ªè¡¨çš„è¡Œï¼Œè¿™ä¸ªåŠŸèƒ½æå…¶å¼ºå¤§ã€‚è®©æˆ‘ç»™ä½ å±•ç¤ºä¸€ä¸‹å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚ğŸ˜Šï¼Œé¦–å…ˆï¼Œè®©æˆ‘ä»¬å¿«é€ŸæŸ¥çœ‹æˆ‘ä»¬çš„è®¢å•è¡¨ã€‚æ‰€ä»¥ä»è®¢å•è¡¨ä¸­é€‰æ‹©æ‰€æœ‰å†…å®¹ã€‚ç°åœ¨ï¼Œå¦‚æœä½ æŸ¥çœ‹æ•°æ®ã€‚ğŸ˜Šã€‚
- en: We can see that the first order was placed in the current year 2019ã€‚ all the
    other orders were placed in previous yearsã€‚Now let's say we want to create a reportã€‚
    get all the orders and next to each order add a labelï¼Œ if the order is placed
    in the current yearã€‚ the label is going to be active and if the order was placed
    in previous yearsã€‚
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¬¬ä¸€ä¸ªè®¢å•æ˜¯åœ¨å½“å‰å¹´ä»½2019å¹´ä¸‹å•çš„ã€‚æ‰€æœ‰å…¶ä»–è®¢å•éƒ½æ˜¯åœ¨ä¹‹å‰çš„å¹´ä»½ä¸‹å•çš„ã€‚ç°åœ¨å‡è®¾æˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ªæŠ¥å‘Šï¼Œè·å–æ‰€æœ‰è®¢å•ï¼Œå¹¶åœ¨æ¯ä¸ªè®¢å•æ—è¾¹æ·»åŠ ä¸€ä¸ªæ ‡ç­¾ï¼Œå¦‚æœè®¢å•æ˜¯åœ¨å½“å‰å¹´ä»½ä¸‹å•ï¼Œæ ‡ç­¾å°†æ˜¯activeï¼Œå¦‚æœè®¢å•æ˜¯åœ¨ä¹‹å‰çš„å¹´ä»½ä¸‹å•ã€‚
- en: we want to label it as archived soã€‚ğŸ˜Šï¼ŒLet's change our query and add a condition
    hereã€‚ Firstã€‚ we want to get all the orders in the current hereï¼Œ So whereã€‚Orderã€‚Date
    is greater than or equal to 2019ï¼Œ0ï¼Œ1ï¼Œ01ã€‚NowI just want to highlight that this
    is not the ideal way to get the orders in the current year because here we have
    hard coded 2019ã€‚ so if we execute the score in next yearï¼Œ we're not going to get
    the right resultã€‚
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬æƒ³å°†å…¶æ ‡è®°ä¸ºå½’æ¡£ã€‚æ‰€ä»¥ã€‚ğŸ˜Šï¼Œè®©æˆ‘ä»¬æ›´æ”¹æŸ¥è¯¢å¹¶åœ¨è¿™é‡Œæ·»åŠ ä¸€ä¸ªæ¡ä»¶ã€‚é¦–å…ˆã€‚æˆ‘ä»¬æƒ³è·å–å½“å‰å¹´çš„æ‰€æœ‰è®¢å•ï¼Œæ‰€ä»¥æ¡ä»¶æ˜¯ã€‚è®¢å•æ—¥æœŸå¤§äºæˆ–ç­‰äº2019å¹´01æœˆ01æ—¥ã€‚ç°åœ¨æˆ‘åªæ˜¯æƒ³å¼ºè°ƒï¼Œè¿™ä¸æ˜¯è·å–å½“å‰å¹´è®¢å•çš„ç†æƒ³æ–¹å¼ï¼Œå› ä¸ºè¿™é‡Œæˆ‘ä»¬ç¡¬ç¼–ç äº†2019ã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬åœ¨æ˜å¹´æ‰§è¡Œè¿™ä¸ªæŸ¥è¯¢ï¼Œæˆ‘ä»¬ä¸ä¼šå¾—åˆ°æ­£ç¡®çš„ç»“æœã€‚
- en: but don't worry about this for now later in the course I will show you how to
    get the orders in the current year without hard coding a date hereã€‚ğŸ˜Šï¼ŒSo let's
    execute this queryã€‚ğŸ˜Šï¼ŒNow we get only one orderï¼Œ let's hand pick a couple of columns
    hereã€‚So order IDã€‚And or na dateã€‚And alsoï¼Œ I want to add a string literal hereã€‚ğŸ˜Šï¼ŒLike
    activeã€‚Rightã€‚Let's execute this queryã€‚This is what we getã€‚ we have three columnsï¼Œ
    order IDï¼Œ order dateã€‚
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†ç°åœ¨ä¸ç”¨æ‹…å¿ƒï¼Œç¨ååœ¨è¯¾ç¨‹ä¸­æˆ‘ä¼šå‘Šè¯‰ä½ å¦‚ä½•åœ¨ä¸åœ¨è¿™é‡Œç¡¬ç¼–ç æ—¥æœŸçš„æƒ…å†µä¸‹è·å–å½“å‰å¹´çš„è®¢å•ã€‚ğŸ˜Šï¼Œæ‰€ä»¥è®©æˆ‘ä»¬æ‰§è¡Œè¿™ä¸ªæŸ¥è¯¢ã€‚ğŸ˜Šï¼Œç°åœ¨æˆ‘ä»¬åªå¾—åˆ°ä¸€ä¸ªè®¢å•ï¼Œè®©æˆ‘ä»¬æŒ‘é€‰å‡ ä¸ªåˆ—ã€‚æ¯”å¦‚è®¢å•IDã€‚è¿˜æœ‰è®¢å•æ—¥æœŸã€‚å¹¶ä¸”ï¼Œæˆ‘æƒ³åœ¨è¿™é‡Œæ·»åŠ ä¸€ä¸ªå­—ç¬¦ä¸²å­—é¢é‡ã€‚ğŸ˜Šï¼Œæ¯”å¦‚activeã€‚å¯¹å§ã€‚è®©æˆ‘ä»¬æ‰§è¡Œè¿™ä¸ªæŸ¥è¯¢ã€‚è¿™å°±æ˜¯æˆ‘ä»¬å¾—åˆ°çš„ç»“æœã€‚æˆ‘ä»¬æœ‰ä¸‰åˆ—ï¼Œè®¢å•IDï¼Œè®¢å•æ—¥æœŸã€‚
- en: and an activeï¼Œ and in this column currently we have this string value activeã€‚ğŸ˜Šã€‚Now
    let's rename this column tooã€‚Statusã€‚And execute the queryiumã€‚ğŸ˜Šï¼ŒThat is betterã€‚Now
    we want to write another query similar to this that will return to orders in the
    previous yearsã€‚ but with a different label archiveï¼Œ so to save timeã€‚ğŸ˜Šï¼ŒI'm going
    to copy this few linesã€‚
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: è¿˜æœ‰ä¸€ä¸ªactiveï¼Œåœ¨è¿™ä¸€åˆ—ä¸­æˆ‘ä»¬ç›®å‰æœ‰è¿™ä¸ªå­—ç¬¦ä¸²å€¼activeã€‚ğŸ˜Šã€‚ç°åœ¨è®©æˆ‘ä»¬ä¹ŸæŠŠè¿™ä¸€åˆ—é‡å‘½åä¸ºçŠ¶æ€ã€‚å¹¶æ‰§è¡ŒæŸ¥è¯¢ã€‚ğŸ˜Šï¼Œè¿™æ›´å¥½äº†ã€‚ç°åœ¨æˆ‘ä»¬æƒ³å†™ä¸€ä¸ªç±»ä¼¼äºè¿™ä¸ªçš„æŸ¥è¯¢ï¼Œè¿”å›å‰å‡ å¹´çš„è®¢å•ï¼Œä½†æœ‰ä¸€ä¸ªä¸åŒçš„æ ‡ç­¾å½’æ¡£ï¼Œæ‰€ä»¥ä¸ºäº†èŠ‚çœæ—¶é—´ã€‚ğŸ˜Šï¼Œæˆ‘å°†å¤åˆ¶è¿™å‡ è¡Œã€‚
- en: And paste them right after our first select statement Now note that here we
    have a syntax error because we didn't terminate the first select statement with
    a semicolonã€‚ but don't worry about itï¼Œ we're going to get back to this in a secondã€‚So
    for the second queryiumã€‚
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åå°†å®ƒä»¬ç²˜è´´åœ¨æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªé€‰æ‹©è¯­å¥åé¢ã€‚è¯·æ³¨æ„ï¼Œè¿™é‡Œæˆ‘ä»¬æœ‰ä¸€ä¸ªè¯­æ³•é”™è¯¯ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰ç”¨åˆ†å·ç»ˆæ­¢ç¬¬ä¸€ä¸ªé€‰æ‹©è¯­å¥ã€‚ä½†ç°åœ¨ä¸ç”¨æ‹…å¿ƒï¼Œæˆ‘ä»¬é©¬ä¸Šä¼šå›åˆ°è¿™ä¸ªé—®é¢˜ã€‚æ‰€ä»¥å¯¹äºç¬¬äºŒä¸ªæŸ¥è¯¢ã€‚
- en: we want to return a different label archiveã€‚ğŸ˜Šï¼ŒAnd we want to change our condition
    to less than 2019ã€‚Nowã€‚Select only these few lines and execute this query either
    by clicking on this icon here or using the keyboard shortcut that you learned
    earlier in the courseã€‚
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬æƒ³è¿”å›ä¸€ä¸ªä¸åŒçš„æ ‡ç­¾å½’æ¡£ã€‚ğŸ˜Šï¼Œè€Œä¸”æˆ‘ä»¬æƒ³å°†æ¡ä»¶æ›´æ”¹ä¸ºå°äº2019ã€‚ç°åœ¨ã€‚åªéœ€é€‰æ‹©è¿™å‡ è¡Œå¹¶é€šè¿‡ç‚¹å‡»è¿™é‡Œçš„å›¾æ ‡æˆ–ä½¿ç”¨ä½ åœ¨è¯¾ç¨‹ä¸­å­¦åˆ°çš„é”®ç›˜å¿«æ·é”®æ¥æ‰§è¡Œè¿™ä¸ªæŸ¥è¯¢ã€‚
- en: There you goã€‚Here are all the orders from the previous years with the label
    archiveã€‚This query returns nine recordsï¼Œ the previous query returned one record
    Now using the union operatorã€‚ we can combine data from these two queriesã€‚In between
    our select statementsã€‚ we type out union now let's execute query one more timeã€‚
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: çœ‹ï¼è¿™é‡Œæ˜¯æ‰€æœ‰æ¥è‡ªå‰å‡ å¹´çš„è®¢å•ï¼Œå¸¦æœ‰å½’æ¡£æ ‡ç­¾ã€‚è¿™ä¸ªæŸ¥è¯¢è¿”å›äº†ä¹æ¡è®°å½•ï¼Œè€Œä¹‹å‰çš„æŸ¥è¯¢è¿”å›äº†ä¸€æ¡è®°å½•ã€‚ç°åœ¨ä½¿ç”¨è”åˆæ“ä½œç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸¤ä¸ªæŸ¥è¯¢çš„æ•°æ®ç»“åˆåœ¨ä¸€èµ·ã€‚åœ¨æˆ‘ä»¬çš„é€‰æ‹©è¯­å¥ä¹‹é—´ï¼Œè¾“å…¥unionã€‚ç°åœ¨è®©æˆ‘ä»¬å†æ‰§è¡Œä¸€æ¬¡æŸ¥è¯¢ã€‚
- en: So here's our first order in the current year that is active and below that
    we have all the orders in the previous yearsã€‚ so using the union operator we can
    combine records from multiple queries Now in this exampleã€‚ both our queries are
    against the same tableï¼Œ but we can also have queries against different tables
    and then combine the result into one result setã€‚ğŸ˜Šï¼ŒLet me show you another exampleã€‚So
    I'm going to delete everything hereã€‚ğŸ˜Šã€‚
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥è¿™æ˜¯æˆ‘ä»¬å½“å‰å¹´ä»½çš„ç¬¬ä¸€å¼ æ´»åŠ¨è®¢å•ï¼Œä¸‹é¢æ˜¯ä¹‹å‰å¹´ä»½çš„æ‰€æœ‰è®¢å•ã€‚å› æ­¤ï¼Œé€šè¿‡ä½¿ç”¨`union`è¿ç®—ç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥åˆå¹¶å¤šä¸ªæŸ¥è¯¢çš„è®°å½•ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çš„ä¸¤ä¸ªæŸ¥è¯¢éƒ½æ˜¯é’ˆå¯¹åŒä¸€å¼ è¡¨ï¼Œä½†æˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹ä¸åŒçš„è¡¨è¿›è¡ŒæŸ¥è¯¢ï¼Œç„¶åå°†ç»“æœåˆå¹¶æˆä¸€ä¸ªç»“æœé›†ã€‚ğŸ˜Š
    è®©æˆ‘ç»™ä½ å±•ç¤ºå¦ä¸€ä¸ªä¾‹å­ã€‚æˆ‘è¦æŠŠè¿™é‡Œçš„æ‰€æœ‰å†…å®¹åˆ é™¤ã€‚ğŸ˜Š
- en: Let's select the first nameã€‚From the customers tableï¼Œ and then we can union
    that withã€‚ğŸ˜Šã€‚Select the name from the shippers's tableï¼Œ Let's execute the queryiumã€‚So
    in one result setã€‚ we can see all the customers and all the shippersã€‚As far as
    I knowã€‚ there is no real world use case for this particular queryã€‚
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ä»å®¢æˆ·è¡¨ä¸­é€‰æ‹©åï¼Œç„¶åæˆ‘ä»¬å¯ä»¥å°†å…¶ä¸ã€‚ğŸ˜Š å‘è´§äººè¡¨ä¸­çš„å§“åè¿›è¡Œ`union`ã€‚è®©æˆ‘ä»¬æ‰§è¡ŒæŸ¥è¯¢ã€‚è¿™æ ·åœ¨ä¸€ä¸ªç»“æœé›†ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„å®¢æˆ·å’Œæ‰€æœ‰çš„å‘è´§äººã€‚æ®æˆ‘æ‰€çŸ¥ï¼Œè¿™ä¸ªç‰¹å®šæŸ¥è¯¢åœ¨ç°å®ä¸–ç•Œä¸­æ²¡æœ‰å®é™…åº”ç”¨æ¡ˆä¾‹ã€‚
- en: but what I want to point out is that with union you can combine results from
    multiple queriesã€‚ğŸ˜Šã€‚These queries can be against the same table or different tablesã€‚In
    your database you could have a table like archived orders and in another table
    like ordersã€‚ and then you could combine all the archived and active orders into
    one result setã€‚
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†æˆ‘æƒ³æŒ‡å‡ºçš„æ˜¯ï¼Œé€šè¿‡`union`ä½ å¯ä»¥åˆå¹¶å¤šä¸ªæŸ¥è¯¢çš„ç»“æœã€‚ğŸ˜Š è¿™äº›æŸ¥è¯¢å¯ä»¥é’ˆå¯¹åŒä¸€å¼ è¡¨æˆ–ä¸åŒçš„è¡¨ã€‚åœ¨ä½ çš„æ•°æ®åº“ä¸­ï¼Œä½ å¯èƒ½ä¼šæœ‰ä¸€å¼ ç±»ä¼¼â€œå½’æ¡£è®¢å•â€çš„è¡¨ï¼Œå’Œå¦ä¸€å¼ â€œè®¢å•â€è¡¨ã€‚ç„¶åä½ å¯ä»¥å°†æ‰€æœ‰å½’æ¡£çš„å’Œæ´»åŠ¨çš„è®¢å•åˆå¹¶æˆä¸€ä¸ªç»“æœé›†ã€‚
- en: Just remember that the number of columns that each query returns should be equalã€‚
    otherwise you're going to get an errorã€‚ for exampleã€‚ let's select the first name
    and last name from customers and then union thatã€‚ğŸ˜Šã€‚With the name of shippersï¼Œ
    let me execute this query will'll get an error because the first part of this
    query returns two columnsã€‚
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: åªéœ€è®°ä½ï¼Œæ¯ä¸ªæŸ¥è¯¢è¿”å›çš„åˆ—æ•°åº”è¯¥ç›¸ç­‰ã€‚å¦åˆ™ä½ ä¼šå¾—åˆ°ä¸€ä¸ªé”™è¯¯ã€‚ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬ä»å®¢æˆ·ä¸­é€‰æ‹©åå’Œå§“ï¼Œç„¶åå°†å…¶`union`ã€‚ğŸ˜Š ç”¨å‘è´§äººå§“åæ¥åšï¼Œè®©æˆ‘æ‰§è¡Œè¿™ä¸ªæŸ¥è¯¢ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸ºè¿™ä¸ªæŸ¥è¯¢çš„ç¬¬ä¸€éƒ¨åˆ†è¿”å›äº†ä¸¤åˆ—ã€‚
- en: but the second part returns one columnã€‚ so my skill doesn't know how to combine
    these recordsã€‚ and one last thing before we finish this tutorialã€‚If you look at
    the result hereã€‚The name of this column is based on the first queryï¼Œ so the first
    query returns first nameã€‚ and that's why this column is called first nameã€‚If we
    change the order of this queriesã€‚
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†ç¬¬äºŒéƒ¨åˆ†è¿”å›äº†ä¸€åˆ—ã€‚å› æ­¤æˆ‘çš„æŠ€èƒ½ä¸çŸ¥é“å¦‚ä½•åˆå¹¶è¿™äº›è®°å½•ã€‚åœ¨æˆ‘ä»¬å®Œæˆè¿™ä¸ªæ•™ç¨‹ä¹‹å‰è¿˜æœ‰æœ€åä¸€ä»¶äº‹ã€‚å¦‚æœä½ æŸ¥çœ‹è¿™é‡Œçš„ç»“æœï¼Œè¿™ä¸€åˆ—çš„åç§°åŸºäºç¬¬ä¸€ä¸ªæŸ¥è¯¢ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªæŸ¥è¯¢è¿”å›äº†åã€‚ä¹Ÿæ­£å› å¦‚æ­¤ï¼Œè¿™ä¸€åˆ—è¢«ç§°ä¸ºåã€‚å¦‚æœæˆ‘ä»¬æ”¹å˜è¿™äº›æŸ¥è¯¢çš„é¡ºåºã€‚
- en: And move this union up hereã€‚Now let's run this queryã€‚ğŸ˜Šï¼ŒAs we can seeï¼Œ our column
    is called nameã€‚ so whatever we have in the first query is used to determine the
    name of these columns here we can also rename the column to let's say full nameã€‚![](img/04095bb29a99dad8fca5419a36682056_2.png)
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: å¹¶æŠŠè¿™ä¸ª`union`æ”¾åˆ°è¿™é‡Œã€‚ç°åœ¨è®©æˆ‘ä»¬è¿è¡Œè¿™ä¸ªæŸ¥è¯¢ã€‚ğŸ˜Š å¦‚æˆ‘ä»¬æ‰€è§ï¼Œæˆ‘ä»¬çš„åˆ—å«åšå§“åã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨ç¬¬ä¸€ä¸ªæŸ¥è¯¢ä¸­çš„å†…å®¹ç”¨äºç¡®å®šè¿™äº›åˆ—çš„åç§°ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†åˆ—é‡å‘½åä¸ºâ€œå…¨åâ€ã€‚![](img/04095bb29a99dad8fca5419a36682056_2.png)
- en: Thereä¸€ä¸ªã€‚![](img/04095bb29a99dad8fca5419a36682056_4.png)
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: æœ‰ä¸€ä¸ªã€‚![](img/04095bb29a99dad8fca5419a36682056_4.png)
- en: Al rightï¼Œ here's your exercise for this tutorialã€‚Write a query to produce this
    report so here we have four columnsã€‚ customer IDï¼Œ first nameï¼Œ points and type
    as you know we don't have this column in the customers table so we have calculated
    the values in this column based on the points each customer hasã€‚
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: å¥½çš„ï¼Œè¿™é‡Œæ˜¯ä½ æœ¬æ•™ç¨‹çš„ç»ƒä¹ ã€‚å†™ä¸€ä¸ªæŸ¥è¯¢æ¥ç”Ÿæˆè¿™ä¸ªæŠ¥å‘Šï¼Œè¿™é‡Œæˆ‘ä»¬æœ‰å››åˆ—ï¼šå®¢æˆ·IDã€åã€ç§¯åˆ†å’Œç±»å‹ã€‚æ­£å¦‚ä½ æ‰€çŸ¥ï¼Œæˆ‘ä»¬åœ¨å®¢æˆ·è¡¨ä¸­æ²¡æœ‰è¿™ä¸ªåˆ—ï¼Œæ‰€ä»¥æˆ‘ä»¬æ ¹æ®æ¯ä¸ªå®¢æˆ·çš„ç§¯åˆ†è®¡ç®—äº†è¿™ä¸€åˆ—çš„å€¼ã€‚
- en: If they have less than 2000 pointsï¼Œ their type is bronzeã€‚ If they have between
    2000 to 3000 pointsã€‚ they are silver customersï¼Œ and if they have more than 3000
    pointsï¼Œ there are gold customersã€‚ Also note that here we have sorted the result
    by the first nameã€‚ So go ahead and spend two minutes to write this queryã€‚Alrightï¼Œ
    firstã€‚
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä»–ä»¬çš„ç§¯åˆ†å°‘äº2000ï¼Œä»–ä»¬çš„ç±»å‹æ˜¯é’é“œï¼›å¦‚æœä»–ä»¬çš„ç§¯åˆ†åœ¨2000åˆ°3000ä¹‹é—´ï¼Œä»–ä»¬æ˜¯é“¶å®¢æˆ·ï¼›å¦‚æœä»–ä»¬çš„ç§¯åˆ†è¶…è¿‡3000ï¼Œä»–ä»¬æ˜¯é‡‘å®¢æˆ·ã€‚åŒæ—¶è¯·æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œæ˜¯æŒ‰åå¯¹ç»“æœè¿›è¡Œäº†æ’åºã€‚é‚£ä¹ˆç°åœ¨è¯·èŠ±ä¸¤åˆ†é’Ÿæ—¶é—´æ¥å†™è¿™ä¸ªæŸ¥è¯¢ã€‚å¥½çš„ï¼Œé¦–å…ˆã€‚
- en: let's get the bronze customersã€‚ So select everything from customers whereã€‚ğŸ˜Šã€‚Points
    is less than 2000ã€‚Now here going to pick three columnsï¼Œ customer I Dã€‚First nameã€‚And
    pointsã€‚And finallyï¼Œ we add a new column with a string literalã€‚ğŸ˜Šï¼ŒFronanceã€‚Let's
    run this query and see what we getã€‚ So these are all the bronze customersã€‚
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬è·å–é’é“œå®¢æˆ·ã€‚æ‰€ä»¥ä»å®¢æˆ·ä¸­é€‰æ‹©æ‰€æœ‰è®°å½•ï¼Œæ¡ä»¶æ˜¯ğŸ˜Šï¼Œç§¯åˆ†å°‘äº2000ã€‚ç°åœ¨æˆ‘ä»¬è¦é€‰æ‹©ä¸‰åˆ—ï¼šå®¢æˆ·IDã€åå­—å’Œç§¯åˆ†ã€‚æœ€åï¼Œæˆ‘ä»¬æ·»åŠ ä¸€ä¸ªæ–°åˆ—ï¼Œå†…å®¹ä¸ºå­—ç¬¦ä¸²å­—é¢é‡ğŸ˜Šï¼ŒFronanceã€‚è®©æˆ‘ä»¬è¿è¡Œè¿™ä¸ªæŸ¥è¯¢ï¼Œçœ‹çœ‹ç»“æœã€‚è¿™é‡Œæ˜¯æ‰€æœ‰çš„é’é“œå®¢æˆ·ã€‚
- en: but the name of this column is bronzeã€‚ We don't want thatã€‚ So let's rename this
    two type Now this is off the screenã€‚ So I'm going to break this up into multiple
    lines that makes our query cleaner and easier to readã€‚ğŸ˜Šã€‚So there you goã€‚Let's
    run the query one more timeã€‚Now the column is called type Beaiã€‚
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†æ˜¯è¿™ä¸ªåˆ—çš„åç§°æ˜¯é’é“œã€‚æˆ‘ä»¬ä¸æƒ³è¦è¿™ä¸ªåç§°ã€‚æ‰€ä»¥è®©æˆ‘ä»¬æŠŠå®ƒé‡å‘½åä¸ºç±»å‹ã€‚ç°åœ¨è¿™éƒ¨åˆ†è¶…å‡ºäº†å±å¹•èŒƒå›´ã€‚æ‰€ä»¥æˆ‘ä¼šæŠŠå®ƒåˆ†æˆå¤šè¡Œï¼Œä½¿æˆ‘ä»¬çš„æŸ¥è¯¢æ›´æ¸…æ™°ã€æ›´æ˜“è¯»ã€‚ğŸ˜Šã€‚å¥½å§ï¼Œè®©æˆ‘ä»¬å†è¿è¡Œä¸€æ¬¡æŸ¥è¯¢ã€‚ç°åœ¨è¿™ä¸ªåˆ—å«ç±»å‹
    Beaiã€‚
- en: Now we should do a unionã€‚And repeat this query but extract the silver customersã€‚
    so I'm going to paste this query hereã€‚ğŸ˜Šï¼ŒAnd then make a couple of changes hereã€‚I'm
    going to replace bronze with silverã€‚And change the condition toã€‚Between 2000 and
    3000ã€‚ let's run our query and see what we getã€‚We have all the bronze customers
    firstã€‚
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬åº”è¯¥è¿›è¡Œä¸€æ¬¡åˆå¹¶ã€‚å¹¶é‡å¤è¿™ä¸ªæŸ¥è¯¢ï¼Œä½†æå–ç™½é“¶å®¢æˆ·ã€‚æ‰€ä»¥æˆ‘ä¼šæŠŠè¿™ä¸ªæŸ¥è¯¢ç²˜è´´åˆ°è¿™é‡Œã€‚ğŸ˜Šï¼Œç„¶åè¿›è¡Œä¸€äº›æ›´æ”¹ã€‚æˆ‘å°†æŠŠé’é“œæ›¿æ¢ä¸ºç™½é“¶ã€‚å¹¶å°†æ¡ä»¶æ”¹ä¸ºåœ¨2000åˆ°3000ä¹‹é—´ã€‚è®©æˆ‘ä»¬è¿è¡ŒæŸ¥è¯¢ï¼Œçœ‹çœ‹ç»“æœã€‚æˆ‘ä»¬é¦–å…ˆå¾—åˆ°äº†æ‰€æœ‰çš„é’é“œå®¢æˆ·ã€‚
- en: followed by all the silver customersã€‚ So the order of these records are based
    on our queries In our first queryã€‚ we got the bronze customersã€‚ That's why they
    are listed firstã€‚ But this is not what we wantã€‚ We want to order the result by
    the first name of our customersã€‚ So let's apply an order by at the endã€‚So order
    by first nameã€‚Now there is one more piece remainingã€‚
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: æ¥ä¸‹æ¥æ˜¯æ‰€æœ‰çš„ç™½é“¶å®¢æˆ·ã€‚è¿™äº›è®°å½•çš„é¡ºåºæ˜¯æ ¹æ®æˆ‘ä»¬çš„æŸ¥è¯¢ç»“æœã€‚åœ¨ç¬¬ä¸€ä¸ªæŸ¥è¯¢ä¸­ï¼Œæˆ‘ä»¬å¾—åˆ°äº†é’é“œå®¢æˆ·ï¼Œæ‰€ä»¥å®ƒä»¬æ’åœ¨æœ€å‰é¢ã€‚ä½†è¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚æˆ‘ä»¬æƒ³è¦æŒ‰å®¢æˆ·çš„åå­—å¯¹ç»“æœè¿›è¡Œæ’åºã€‚æ‰€ä»¥è®©æˆ‘ä»¬åœ¨æœ€åæ·»åŠ ä¸€ä¸ªæ’åºã€‚æŒ‰ç…§åå­—æ’åºã€‚ç°åœ¨è¿˜æœ‰ä¸€éƒ¨åˆ†å†…å®¹æ²¡æœ‰å¤„ç†ã€‚
- en: we should do a union one more timeã€‚I'm ready to query to get the gold customersã€‚
    So I'm going to select these few lines andã€‚ğŸ˜Šï¼ŒPas them hereã€‚Nowhou us change silver
    to goldã€‚And the condition2 points greater than 3000ã€‚And finally we do on order
    byã€‚Let's run the query one more timeã€‚ğŸ˜Šï¼ŒAnd here's the end resultã€‚
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬åº”è¯¥å†è¿›è¡Œä¸€æ¬¡åˆå¹¶ã€‚æˆ‘å‡†å¤‡æŸ¥è¯¢ä»¥è·å–é»„é‡‘å®¢æˆ·ã€‚æ‰€ä»¥æˆ‘å°†é€‰æ‹©è¿™å‡ è¡Œå¹¶ğŸ˜Šï¼ŒæŠŠå®ƒä»¬ç²˜è´´åˆ°è¿™é‡Œã€‚ç°åœ¨å°†ç™½é“¶æ”¹ä¸ºé»„é‡‘ã€‚å¹¶å°†æ¡ä»¶æ›´æ”¹ä¸ºç§¯åˆ†å¤§äº3000ã€‚æœ€åæˆ‘ä»¬å†åšä¸€æ¬¡æ’åºã€‚è®©æˆ‘ä»¬å†è¿è¡Œä¸€æ¬¡æŸ¥è¯¢ã€‚ğŸ˜Šï¼Œè¿™æ˜¯æœ€ç»ˆç»“æœã€‚
- en: our customers are sorted by their first nameã€‚ We see all the bronzeï¼Œ silver
    and gold customersã€‚![](img/04095bb29a99dad8fca5419a36682056_6.png)
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬çš„å®¢æˆ·æŒ‰åå­—æ’åºã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„é’é“œã€ç™½é“¶å’Œé»„é‡‘å®¢æˆ·ã€‚![](img/04095bb29a99dad8fca5419a36682056_6.png)
