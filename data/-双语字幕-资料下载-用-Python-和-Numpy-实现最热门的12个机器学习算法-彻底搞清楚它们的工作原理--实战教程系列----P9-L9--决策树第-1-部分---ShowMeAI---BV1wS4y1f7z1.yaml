- en: ã€åŒè¯­å­—å¹•+èµ„æ–™ä¸‹è½½ã€‘ç”¨ Python å’Œ Numpy å®ç°æœ€çƒ­é—¨çš„12ä¸ªæœºå™¨å­¦ä¹ ç®—æ³•ï¼Œå½»åº•ææ¸…æ¥šå®ƒä»¬çš„å·¥ä½œåŸç†ï¼ï¼œå®æˆ˜æ•™ç¨‹ç³»åˆ—ï¼ - P9ï¼šL9- å†³ç­–æ ‘ç¬¬
    1 éƒ¨åˆ† - ShowMeAI - BV1wS4y1f7z1
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ã€åŒè¯­å­—å¹•+èµ„æ–™ä¸‹è½½ã€‘ç”¨ Python å’Œ Numpy å®ç°æœ€çƒ­é—¨çš„12ä¸ªæœºå™¨å­¦ä¹ ç®—æ³•ï¼Œå½»åº•ææ¸…æ¥šå®ƒä»¬çš„å·¥ä½œåŸç†ï¼ï¼œå®æˆ˜æ•™ç¨‹ç³»åˆ—ï¼ - P9ï¼šL9- å†³ç­–æ ‘ç¬¬
    1 éƒ¨åˆ† - ShowMeAI - BV1wS4y1f7z1
- en: Hiï¼Œ everybodyã€‚ Welcome to a new machine learning from Sc tutorialã€‚ Todayã€‚ we
    are going to implement a decision tree using only built in Python modules and
    nuyã€‚ A decision tree is a very simple but powerful conceptã€‚ The idea is to build
    a tree that splits our data such that we have the best separation of our classesã€‚
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: å¤§å®¶å¥½ï¼Œæ¬¢è¿æ¥åˆ°æ–°çš„æœºå™¨å­¦ä¹ æ•™ç¨‹ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°†ä»…ä½¿ç”¨å†…ç½®çš„Pythonæ¨¡å—å’ŒNumpyå®ç°ä¸€ä¸ªå†³ç­–æ ‘ã€‚å†³ç­–æ ‘æ˜¯ä¸€ä¸ªéå¸¸ç®€å•ä½†å¼ºå¤§çš„æ¦‚å¿µã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯æ„å»ºä¸€æ£µæ ‘æ¥åˆ†å‰²æ•°æ®ï¼Œä»¥å®ç°ç±»åˆ«ä¹‹é—´çš„æœ€ä½³åˆ†ç¦»ã€‚
- en: A decision tree is also the basis for the very popular random forest modelã€‚
    which we will implement in the next tutorialã€‚ So I hope you will stick with meã€‚ğŸ˜Šï¼ŒAnd
    as alwaysã€‚ we will start with the theory firstã€‚ So let's look at an example to
    understand the concept and the math behind the decision treeã€‚ Let's say we want
    to predict if a person is walking or taking the bus to go to workã€‚
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: å†³ç­–æ ‘ä¹Ÿæ˜¯éå¸¸æµè¡Œçš„éšæœºæ£®æ—æ¨¡å‹çš„åŸºç¡€ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ä¸ªæ•™ç¨‹ä¸­å®ç°ã€‚å› æ­¤ï¼Œæˆ‘å¸Œæœ›ä½ ä»¬èƒ½è·Ÿç€æˆ‘ã€‚ğŸ˜Šï¼Œå’Œå¾€å¸¸ä¸€æ ·ï¼Œæˆ‘ä»¬é¦–å…ˆä»ç†è®ºå¼€å§‹ã€‚æ‰€ä»¥è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ï¼Œä»¥ç†è§£å†³ç­–æ ‘èƒŒåçš„æ¦‚å¿µå’Œæ•°å­¦åŸç†ã€‚å‡è®¾æˆ‘ä»¬æƒ³é¢„æµ‹ä¸€ä¸ªäººæ˜¯èµ°è·¯è¿˜æ˜¯ä¹˜å…¬äº¤è½¦å»ä¸Šç­ã€‚
- en: and we have 10 observations or 10 samples with two different featuresã€‚So we
    have the feature if it is raining and then we have the featureï¼Œ how much time
    do they haveï¼Ÿ
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬æœ‰10ä¸ªè§‚å¯Ÿå€¼æˆ–10ä¸ªæ ·æœ¬ï¼Œå…·æœ‰ä¸¤ä¸ªä¸åŒçš„ç‰¹å¾ã€‚æ‰€ä»¥æˆ‘ä»¬æœ‰ä¸€ä¸ªç‰¹å¾ï¼Œå³æ˜¯å¦åœ¨ä¸‹é›¨ï¼Œç„¶åæˆ‘ä»¬æœ‰å¦ä¸€ä¸ªç‰¹å¾ï¼Œä»–ä»¬æœ‰å¤šé•¿æ—¶é—´ï¼Ÿ
- en: And then we have the prediction or the class labelï¼Œ yes or noã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_1.png)
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åæˆ‘ä»¬å¾—å‡ºé¢„æµ‹æˆ–ç±»åˆ«æ ‡ç­¾ï¼Œæ˜¯æˆ–å¦ã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_1.png)
- en: And now we want to build our tree that splits our dataã€‚ so we put all the samples
    in the root node and then we apply a question so we ask if it is raining and if
    the answer is yesã€‚ then we go to the right and we put all the samples where the
    answer is yesã€‚ so these three into the right note and if the answer is noã€‚
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬æƒ³æ„å»ºä¸€ä¸ªå°†æ•°æ®åˆ†å‰²çš„æ ‘ã€‚æ‰€ä»¥æˆ‘ä»¬æŠŠæ‰€æœ‰æ ·æœ¬æ”¾åœ¨æ ¹èŠ‚ç‚¹ï¼Œç„¶åæˆ‘ä»¬æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é—®æ˜¯å¦åœ¨ä¸‹é›¨ï¼Œå¦‚æœç­”æ¡ˆæ˜¯â€œæ˜¯â€ã€‚ç„¶åæˆ‘ä»¬å‘å³ç§»åŠ¨ï¼ŒæŠŠæ‰€æœ‰ç­”æ¡ˆä¸ºâ€œæ˜¯â€çš„æ ·æœ¬æ”¾è¿›å»ã€‚æ‰€ä»¥è¿™ä¸‰ä¸ªæ”¾åœ¨å³èŠ‚ç‚¹ï¼Œå¦‚æœç­”æ¡ˆæ˜¯å¦ã€‚
- en: then we go to the left and put all the other samples in the left nodeã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_3.png)
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åæˆ‘ä»¬å‘å·¦ç§»åŠ¨ï¼ŒæŠŠæ‰€æœ‰å…¶ä»–æ ·æœ¬æ”¾å…¥å·¦èŠ‚ç‚¹ã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_3.png)
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_4.png)'
  id: totrans-7
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_4.png)'
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_5.png)'
  id: totrans-8
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_5.png)'
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_6.png)'
  id: totrans-9
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_6.png)'
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_7.png)'
  id: totrans-10
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_7.png)'
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_8.png)'
  id: totrans-11
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_8.png)'
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_9.png)'
  id: totrans-12
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_9.png)'
- en: And here on the rightï¼Œ we can immediately say that the answer is noï¼Œ They don't
    walkã€‚ So we put theã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_11.png)
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™é‡Œåœ¨å³ä¾§ï¼Œæˆ‘ä»¬å¯ä»¥ç«‹å³è¯´ç­”æ¡ˆæ˜¯å¦ï¼Œä»–ä»¬ä¸èµ°è·¯ã€‚æ‰€ä»¥æˆ‘ä»¬æŠŠã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_11.png)
- en: Or return the class label 0ã€‚ And here on the leftï¼Œ we can further split the
    data and grow our treeã€‚ So we ask the next questionã€‚ So do they have more than
    10 minutes and againã€‚ if the answer is yes and we go to the right and put all
    of theã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_13.png)
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ–è¿”å›ç±»åˆ«æ ‡ç­¾0ã€‚è¿™é‡Œåœ¨å·¦ä¾§ï¼Œæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥åˆ†å‰²æ•°æ®å¹¶æ‰©å±•æˆ‘ä»¬çš„æ ‘ã€‚æ‰€ä»¥æˆ‘ä»¬é—®ä¸‹ä¸€ä¸ªé—®é¢˜ã€‚é‚£å°±æ˜¯ä»–ä»¬æ˜¯å¦æœ‰è¶…è¿‡10åˆ†é’Ÿï¼Œå¦‚æœç­”æ¡ˆæ˜¯â€œæ˜¯â€ï¼Œæˆ‘ä»¬å°±å‘å³ç§»åŠ¨ï¼ŒæŠŠæ‰€æœ‰çš„ã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_13.png)
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_14.png)'
  id: totrans-15
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_14.png)'
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_15.png)'
  id: totrans-16
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_15.png)'
- en: Samples where where they have more than 10 minutes in the right note and all
    the other ones in the left note and then again here we can say that the answer
    is yes or the class label is1 and here the class label is 0ã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_17.png)
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: æ ·æœ¬å¦‚æœæœ‰è¶…è¿‡10åˆ†é’Ÿçš„æ—¶é—´å°±æ”¾åœ¨å³èŠ‚ç‚¹ï¼Œæ‰€æœ‰å…¶ä»–æ ·æœ¬æ”¾åœ¨å·¦èŠ‚ç‚¹ï¼Œç„¶ååœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥è¯´ç­”æ¡ˆæ˜¯â€œæ˜¯â€æˆ–ç±»åˆ«æ ‡ç­¾æ˜¯1ï¼Œè€Œè¿™é‡Œçš„ç±»åˆ«æ ‡ç­¾æ˜¯0ã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_17.png)
- en: And we could also stop with the growing here and return the most common class
    labelã€‚ So here we can say that it's more likely that they will walkã€‚m but we could
    also further split our data and but we don't want to grow our data too much because
    we don't want to overfit our dataã€‚ but we also want to have a good predictionã€‚
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œåœæ­¢ç”Ÿé•¿å¹¶è¿”å›æœ€å¸¸è§çš„ç±»åˆ«æ ‡ç­¾ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¯´ï¼Œä»–ä»¬æ›´æœ‰å¯èƒ½èµ°è·¯ã€‚ä½†æˆ‘ä»¬ä¹Ÿå¯ä»¥è¿›ä¸€æ­¥åˆ†å‰²æ•°æ®ï¼Œä½†æˆ‘ä»¬ä¸æƒ³è®©æ•°æ®è¿‡åº¦ç”Ÿé•¿ï¼Œå› ä¸ºæˆ‘ä»¬ä¸æƒ³è¿‡æ‹Ÿåˆæ•°æ®ã€‚ä½†æˆ‘ä»¬ä¹Ÿå¸Œæœ›æœ‰ä¸€ä¸ªå¥½çš„é¢„æµ‹ã€‚
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_19.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_19.png)'
- en: So this is the concept of how the decision tree works and now the only thing
    that we have to find out is at what at which node we want to apply which question
    so why do we ask for rain at first and not for the time and why do we ask for
    the time is greater than 10 and why don't we ask for if it's greater than 5 or
    greater than 20ã€‚
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥è¿™æ˜¯å†³ç­–æ ‘å·¥ä½œçš„æ¦‚å¿µï¼Œç°åœ¨æˆ‘ä»¬å”¯ä¸€éœ€è¦æ‰¾å‡ºçš„å°±æ˜¯åœ¨ä»€ä¹ˆèŠ‚ç‚¹ä¸Šåº”ç”¨å“ªä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸€å¼€å§‹é—®é›¨è€Œä¸æ˜¯å¤©æ°”ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬é—®æ—¶é—´æ˜¯å¦å¤§äº10ï¼Œä¸ºä»€ä¹ˆä¸é—®æ˜¯å¦å¤§äº5æˆ–å¤§äº20ã€‚
- en: so this is the best the so-called bestã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_21.png)
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥è¿™å°±æ˜¯æ‰€è°“çš„æœ€ä½³ã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_21.png)
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_22.png)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_22.png)'
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_23.png)'
  id: totrans-23
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_23.png)'
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_24.png)'
  id: totrans-24
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_24.png)'
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_25.png)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_25.png)'
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_26.png)'
  id: totrans-26
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_26.png)'
- en: Split feature and best split value or split threshold that we want to find outã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_28.png)
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ’åˆ†ç‰¹å¾å’Œæˆ‘ä»¬æƒ³è¦æ‰¾å‡ºçš„æœ€ä½³åˆ’åˆ†å€¼æˆ–åˆ’åˆ†é˜ˆå€¼ã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_28.png)
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_29.png)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_29.png)'
- en: Soï¼Œ the concept is toã€‚At each noteï¼Œ we want to find the best split value and
    the best split threshold and store themã€‚And this is our training phase and later
    when we want to predict a new test sampleã€‚ then we start at the top and then we
    traverse our tree and apply the questions or the features that we start and go
    to the left or to the right until we reach a leaf node so a leaf node the node
    at the bottomã€‚ and then we apply the most common label that we stored based on
    our test samplesã€‚
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥ï¼Œæ¦‚å¿µæ˜¯ã€‚åœ¨æ¯ä¸ªèŠ‚ç‚¹ï¼Œæˆ‘ä»¬æƒ³æ‰¾åˆ°æœ€ä½³çš„åˆ’åˆ†å€¼å’Œæœ€ä½³çš„åˆ’åˆ†é˜ˆå€¼å¹¶å­˜å‚¨å®ƒä»¬ã€‚è¿™æ˜¯æˆ‘ä»¬çš„è®­ç»ƒé˜¶æ®µï¼Œåæ¥å½“æˆ‘ä»¬æƒ³é¢„æµ‹ä¸€ä¸ªæ–°çš„æµ‹è¯•æ ·æœ¬æ—¶ï¼Œæˆ‘ä»¬ä»é¡¶éƒ¨å¼€å§‹ï¼Œéå†æˆ‘ä»¬çš„æ ‘ï¼Œåº”ç”¨å¼€å§‹çš„é—®é¢˜æˆ–ç‰¹å¾ï¼Œç„¶åå‘å·¦æˆ–å‘å³ç§»åŠ¨ï¼Œç›´åˆ°åˆ°è¾¾å¶å­èŠ‚ç‚¹ï¼Œå¶å­èŠ‚ç‚¹æ˜¯åº•éƒ¨çš„èŠ‚ç‚¹ã€‚ç„¶åæˆ‘ä»¬åº”ç”¨åŸºäºæµ‹è¯•æ ·æœ¬å­˜å‚¨çš„æœ€å¸¸è§æ ‡ç­¾ã€‚
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_31.png)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_31.png)'
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_32.png)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_32.png)'
- en: So this is the conceptã€‚ And now how do we find out the best splitã€‚ So for thisï¼Œ
    we need some mathã€‚ So we calculate the entropy and the entropy is also is the
    a measure for uncertaintyã€‚ So the formula is minusï¼Œ and then we have the sum of
    p of x times lock of p of x and p of x is the number of occurrences over the total
    number of samplesã€‚ So in our example we have 110 samples and five times the answer
    is or the label is 0 and five times the answer isã€‚
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥è¿™æ˜¯è¿™ä¸ªæ¦‚å¿µã€‚é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•æ‰¾åˆ°æœ€ä½³åˆ’åˆ†å‘¢ï¼Ÿä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº›æ•°å­¦ã€‚æˆ‘ä»¬è®¡ç®—ç†µï¼Œç†µä¹Ÿæ˜¯ä¸ç¡®å®šæ€§çš„è¡¡é‡æ ‡å‡†ã€‚å…¬å¼æ˜¯è´Ÿå·ï¼Œç„¶åæˆ‘ä»¬æœ‰p(x)ä¹˜ä»¥p(x)çš„å¯¹æ•°çš„æ€»å’Œï¼Œè€Œp(x)æ˜¯å‘ç”Ÿæ¬¡æ•°é™¤ä»¥æ ·æœ¬æ€»æ•°ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æœ‰110ä¸ªæ ·æœ¬ï¼Œå…¶ä¸­äº”æ¬¡ç­”æ¡ˆæ˜¯0ï¼Œäº”æ¬¡ç­”æ¡ˆæ˜¯ã€‚
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_34.png)'
  id: totrans-33
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_34.png)'
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_35.png)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_35.png)'
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_36.png)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_36.png)'
- en: 1ã€‚And then we have itsï¼Œ our entropy is minus5 over 10 times lock of 5 over 10
    minusã€‚ And then we look at the nextã€‚Labelï¼Œ so one againï¼Œ we have five labelsã€‚
    so minus5 over 10 times lock of 5 over 10ã€‚ And if you calculate thisï¼Œ then this
    is oneã€‚ So this is the worst possible case here in our in the first note we cannot
    make a prediction which are if it is one or0ã€‚
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 1ã€‚ç„¶åæˆ‘ä»¬å¾—å‡ºï¼Œç†µæ˜¯-5é™¤ä»¥10ä¹˜ä»¥5é™¤ä»¥10çš„å¯¹æ•°å‡å»ã€‚ç„¶åæˆ‘ä»¬çœ‹ä¸‹ä¸€ä¸ªæ ‡ç­¾ï¼Œæ‰€ä»¥å†æ¬¡ï¼Œäº”ä¸ªæ ‡ç­¾ã€‚å› æ­¤æ˜¯-5é™¤ä»¥10ä¹˜ä»¥5é™¤ä»¥10ã€‚å¦‚æœä½ è®¡ç®—è¿™ä¸ªï¼Œé‚£ä¹ˆç»“æœæ˜¯1ã€‚æ‰€ä»¥è¿™æ˜¯æœ€ç³Ÿç³•çš„æƒ…å†µï¼Œåœ¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æˆ‘ä»¬æ— æ³•é¢„æµ‹æ˜¯1è¿˜æ˜¯0ã€‚
- en: because we have an equal amount of bothã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_38.png)
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: å› ä¸ºæˆ‘ä»¬æœ‰ç›¸ç­‰æ•°é‡çš„ä¸¤è€…ã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_38.png)
- en: Samples or both classes hereã€‚So one is the worst possible case and like here
    the entropy here would be0ã€‚ so this is the best case here we are very certain
    that we have the class0ã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_40.png)
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™é‡Œçš„æ ·æœ¬æˆ–ä¸¤ç±»ã€‚æ‰€ä»¥ä¸€ä¸ªæ˜¯æœ€ç³Ÿç³•çš„æƒ…å†µï¼Œè¿™é‡Œçš„ç†µä¸º0ã€‚è¿™æ˜¯æœ€å¥½çš„æƒ…å†µï¼Œæˆ‘ä»¬éå¸¸ç¡®å®šæˆ‘ä»¬æœ‰ç±»0ã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_40.png)
- en: And now so we calculate the entropy and then we split our data and calculate
    the entropy for our childsã€‚And then we calculate how much information we gain
    through this split and this measure is actually really called information gainã€‚
    And this is calculated by the entropy of the parent minus weighted average of
    all the child entroiesã€‚ So like in our exampleï¼Œ we have the root note with our
    10 observationsã€‚
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬è®¡ç®—ç†µï¼Œç„¶åå¯¹æ•°æ®è¿›è¡Œåˆ†å‰²ï¼Œå¹¶è®¡ç®—å­èŠ‚ç‚¹çš„ç†µã€‚æ¥ç€æˆ‘ä»¬è®¡ç®—é€šè¿‡è¿™æ¬¡åˆ†å‰²è·å¾—çš„ä¿¡æ¯é‡ï¼Œè¿™ä¸ªåº¦é‡å®é™…ä¸Šç§°ä¸ºä¿¡æ¯å¢ç›Šã€‚å®ƒæ˜¯é€šè¿‡çˆ¶èŠ‚ç‚¹çš„ç†µå‡å»æ‰€æœ‰å­èŠ‚ç‚¹ç†µçš„åŠ æƒå¹³å‡å€¼æ¥è®¡ç®—çš„ã€‚å› æ­¤åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬æœ‰æ ¹èŠ‚ç‚¹å’Œ10ä¸ªè§‚å¯Ÿå€¼ã€‚
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_42.png)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_42.png)'
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_43.png)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_43.png)'
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_44.png)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_44.png)'
- en: And then on the left sideï¼Œ we have 7 observations with hereï¼Œ2 zerosã€‚And5 oneã€‚
    And on the right sideã€‚ we have three zerosã€‚ So our entropy is the entropy of the
    parent-7 over 10 times the entropy on the left side plus 3 over 10 times the entropy
    of the right sideã€‚
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶ååœ¨å·¦ä¾§ï¼Œæˆ‘ä»¬æœ‰7ä¸ªè§‚å¯Ÿå€¼ï¼Œå…¶ä¸­2ä¸ªä¸ºé›¶ï¼Œ5ä¸ªä¸º1ã€‚åœ¨å³ä¾§ï¼Œæˆ‘ä»¬æœ‰3ä¸ªé›¶ã€‚å› æ­¤æˆ‘ä»¬çš„ç†µæ˜¯çˆ¶èŠ‚ç‚¹çš„ç†µå‡å»7/10ä¹˜ä»¥å·¦ä¾§çš„ç†µåŠ ä¸Š3/10ä¹˜ä»¥å³ä¾§çš„ç†µã€‚
- en: So this is the information gainã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_46.png)
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯ä¿¡æ¯å¢ç›Šã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_46.png)
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_47.png)'
  id: totrans-45
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_47.png)'
- en: And now we do a greedy searchï¼Œ so we go over all the possible features and over
    all the possible feature values or thresholdsã€‚ so for rain we check if it's yes
    or no or it means one or zero and if the answer and for the time featureã€‚ we check
    for5ï¼Œ 10ï¼Œ 15ï¼Œ 20ï¼Œ 25 and 30 so we do a greedy searchã€‚
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬è¿›è¡Œè´ªå©ªæœç´¢ï¼Œå› æ­¤æˆ‘ä»¬æ£€æŸ¥æ‰€æœ‰å¯èƒ½çš„ç‰¹å¾å’Œæ‰€æœ‰å¯èƒ½çš„ç‰¹å¾å€¼æˆ–é˜ˆå€¼ã€‚å¯¹äºé™é›¨ï¼Œæˆ‘ä»¬æ£€æŸ¥å®ƒæ˜¯â€œæ˜¯â€è¿˜æ˜¯â€œå¦â€ï¼Œæ„å‘³ç€1æˆ–0ï¼Œå¯¹äºæ—¶é—´ç‰¹å¾ï¼Œæˆ‘ä»¬æ£€æŸ¥5ã€10ã€15ã€20ã€25å’Œ30ï¼Œå› æ­¤æˆ‘ä»¬è¿›è¡Œè´ªå©ªæœç´¢ã€‚
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_49.png)'
  id: totrans-47
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_49.png)'
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_50.png)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_50.png)'
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_51.png)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_51.png)'
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_52.png)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_52.png)'
- en: And thenï¼Œ we storeã€‚Or select and store the best feature and the best thresholdã€‚
    So this is theã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_54.png)
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åï¼Œæˆ‘ä»¬å­˜å‚¨æˆ–é€‰æ‹©å¹¶å­˜å‚¨æœ€ä½³ç‰¹å¾å’Œæœ€ä½³é˜ˆå€¼ã€‚æ‰€ä»¥è¿™æ˜¯ã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_54.png)
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_55.png)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_55.png)'
- en: Conceptï¼Œ so let's look at the approach a little bit more in detailã€‚ So firstã€‚
    we have the training phase where we want to build our treeã€‚ So we start at a top
    nodeã€‚ and at each nodeï¼Œ we select the best split based on the best information
    gameã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_57.png)
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: æ¦‚å¿µï¼Œè®©æˆ‘ä»¬æ›´è¯¦ç»†åœ°çœ‹çœ‹è¿™ç§æ–¹æ³•ã€‚å› æ­¤é¦–å…ˆï¼Œæˆ‘ä»¬æœ‰è®­ç»ƒé˜¶æ®µï¼Œåœ¨æ­¤é˜¶æ®µæˆ‘ä»¬æƒ³è¦æ„å»ºæˆ‘ä»¬çš„æ ‘ã€‚æˆ‘ä»¬ä»é¡¶èŠ‚ç‚¹å¼€å§‹ï¼Œåœ¨æ¯ä¸ªèŠ‚ç‚¹ï¼Œæˆ‘ä»¬æ ¹æ®æœ€ä½³ä¿¡æ¯å¢ç›Šé€‰æ‹©æœ€ä½³åˆ†å‰²ã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_57.png)
- en: And we do a greedy searchï¼Œ so we loop over all features and over all thresholdsã€‚Then
    we saved the best split feature and split threshold at each node and we built
    the tree recursivelyã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_59.png)
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬è¿›è¡Œè´ªå©ªæœç´¢ï¼Œå› æ­¤æˆ‘ä»¬éå†æ‰€æœ‰ç‰¹å¾å’Œæ‰€æœ‰é˜ˆå€¼ã€‚ç„¶åæˆ‘ä»¬åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¿å­˜æœ€ä½³åˆ†å‰²ç‰¹å¾å’Œåˆ†å‰²é˜ˆå€¼ï¼Œå¹¶é€’å½’åœ°æ„å»ºæ ‘ã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_59.png)
- en: And we also have to apply some stopping criteria to stop growingã€‚ And in our
    exampleã€‚ we will use a maximum depthã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_61.png)
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬è¿˜å¿…é¡»åº”ç”¨ä¸€äº›åœæ­¢å‡†åˆ™æ¥åœæ­¢ç”Ÿé•¿ã€‚åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æœ€å¤§æ·±åº¦ã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_61.png)
- en: So for exampleï¼Œ we say if the depth three is5ï¼Œ then we would stopã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_63.png)
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¯´å¦‚æœæ·±åº¦æ˜¯3ä¸”ä¸º5ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†åœæ­¢ã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_63.png)
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_64.png)'
  id: totrans-57
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_64.png)'
- en: And we use a minimum samples at a nodeã€‚ Soï¼Œ for exampleã€‚ we could say if we
    have less than five samples in a node then we don't split any furtherã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_66.png)
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬åœ¨èŠ‚ç‚¹ä½¿ç”¨æœ€å°æ ·æœ¬æ•°ã€‚å› æ­¤ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥è¯´å¦‚æœä¸€ä¸ªèŠ‚ç‚¹ä¸­çš„æ ·æœ¬å°‘äºäº”ä¸ªï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¸å†è¿›ä¸€æ­¥åˆ†å‰²ã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_66.png)
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_67.png)'
  id: totrans-59
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_67.png)'
- en: And if we have no more class distribution in a node like hereã€‚ then we can no
    longer split because we only have class 0 labels hereã€‚ So these are our stopping
    criteria that we needã€‚ And then when we have a leaf nodeã€‚ then we store the most
    common class label of this nodeã€‚ So here we store 0ï¼Œ1 and 0ã€‚
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœåœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸­æ²¡æœ‰æ›´å¤šçš„ç±»åˆ«åˆ†å¸ƒï¼Œå°±åƒè¿™é‡Œé‚£æ ·ã€‚æˆ‘ä»¬å°±æ— æ³•å†è¿›è¡Œåˆ†è£‚ï¼Œå› ä¸ºè¿™é‡Œåªæœ‰ç±»åˆ« 0 çš„æ ‡ç­¾ã€‚æ‰€ä»¥è¿™äº›æ˜¯æˆ‘ä»¬éœ€è¦çš„åœæ­¢æ ‡å‡†ã€‚å½“æˆ‘ä»¬æœ‰ä¸€ä¸ªå¶èŠ‚ç‚¹æ—¶ï¼Œæˆ‘ä»¬ä¼šå­˜å‚¨è¯¥èŠ‚ç‚¹ä¸­æœ€å¸¸è§çš„ç±»åˆ«æ ‡ç­¾ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å­˜å‚¨
    0ã€1 å’Œ 0ã€‚
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_69.png)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_69.png)'
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_70.png)'
  id: totrans-62
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_70.png)'
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_71.png)'
  id: totrans-63
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_71.png)'
- en: '![](img/e1b43f93535591fc8a4dc158e9ae735d_72.png)'
  id: totrans-64
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e1b43f93535591fc8a4dc158e9ae735d_72.png)'
- en: So this is our training phase and then later when we do the testing with new
    samplesã€‚ then we traverse the tree and we also do this recursivelyã€‚ so we implement
    a function that calls itselfã€‚And at each noteã€‚ we look at the best split feature
    of the test feature vector and go left or rightï¼Œ depending on ifã€‚
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯æˆ‘ä»¬çš„è®­ç»ƒé˜¶æ®µï¼Œéšååœ¨æµ‹è¯•æ–°æ ·æœ¬æ—¶ï¼Œæˆ‘ä»¬éå†æ ‘ï¼Œå¹¶ä¸”ä¹Ÿæ˜¯é€’å½’è¿›è¡Œã€‚å› æ­¤æˆ‘ä»¬å®ç°ä¸€ä¸ªè°ƒç”¨è‡ªèº«çš„å‡½æ•°ã€‚åœ¨æ¯ä¸ªèŠ‚ç‚¹ï¼Œæˆ‘ä»¬æŸ¥çœ‹æµ‹è¯•ç‰¹å¾å‘é‡çš„æœ€ä½³åˆ†è£‚ç‰¹å¾ï¼Œç„¶åæ ¹æ®æƒ…å†µå‘å·¦æˆ–å‘å³èµ°ã€‚
- en: The value of this featureã€‚Is smaller or equal than our threshold that we storedï¼Ÿ
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªç‰¹å¾çš„å€¼æ˜¯å¦å°äºæˆ–ç­‰äºæˆ‘ä»¬å­˜å‚¨çš„é˜ˆå€¼ï¼Ÿ
- en: And then when we reach the leaf node or the bottomï¼Œ we return the stored most
    common class labelã€‚ So this is the concept of theã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_74.png)
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: å½“æˆ‘ä»¬åˆ°è¾¾å¶èŠ‚ç‚¹æˆ–åº•éƒ¨æ—¶ï¼Œæˆ‘ä»¬è¿”å›å­˜å‚¨çš„æœ€å¸¸è§ç±»åˆ«æ ‡ç­¾ã€‚è¿™å°±æ˜¯è¿™ä¸ªæ¦‚å¿µã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_74.png)
- en: Decis 3ã€‚ And now I think I will stop this video hereã€‚ and we will continue in
    the next part or in the second part with the implementationã€‚ So see you thenã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_76.png)
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: å†³ç­– 3ã€‚ç°åœ¨æˆ‘æƒ³åœ¨è¿™é‡Œåœæ­¢è¿™ä¸ªè§†é¢‘ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€éƒ¨åˆ†æˆ–ç¬¬äºŒéƒ¨åˆ†ç»§ç»­å®ç°ã€‚æ‰€ä»¥åˆ°æ—¶è§ã€‚![](img/e1b43f93535591fc8a4dc158e9ae735d_76.png)
