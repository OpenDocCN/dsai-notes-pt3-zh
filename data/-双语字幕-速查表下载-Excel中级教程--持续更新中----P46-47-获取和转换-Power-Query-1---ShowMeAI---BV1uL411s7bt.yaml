- en: 【双语字幕+速查表下载】Excel中级教程！(持续更新中) - P46：47）获取和转换／Power Query 1 - ShowMeAI - BV1uL411s7bt
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 【双语字幕+速查表下载】Excel中级教程！(持续更新中) - P46：47）获取和转换／Power Query 1 - ShowMeAI - BV1uL411s7bt
- en: '![](img/acec3a93d9b497450000e00a04171fff_0.png)'
  id: totrans-1
  prefs: []
  type: TYPE_IMG
  zh: '![](img/acec3a93d9b497450000e00a04171fff_0.png)'
- en: This is the beginner's guide to Excel， get and transform。 otherwise known as
    power query。 In this video， I'll show you how you can use get and transform to
    take data that's in a spreadsheet and transform it。 Clean it。 F it。 Make it better。
    and easier for you to use and to read。 So let's get started learning get and transform。
    Take a close look at this worksheet。
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 这是Excel的初学者指南，获取和转换，亦称为**Power Query**。在这个视频中，我将向你展示如何使用获取和转换将电子表格中的数据进行转化。清理它，调整它，优化它，让它更易于使用和阅读。那么我们开始学习获取和转换吧。仔细看看这个工作表。
- en: As you can see， it's a list of movies。 and other information about those movies。
    And let's say that I got this spreadsheet from somebody else。 Maybe someone that
    wasn't careful about how they formatted the text。 You can see there's various
    inconsistencies with using bold or not using bold。
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，这是一个电影列表，以及关于这些电影的其他信息。假设我从其他地方获取了这个电子表格，也许是某个不小心处理文本的人。你可以看到在使用粗体方面存在各种不一致。
- en: There's extra spaces that I don't like in my data and different colors and things
    like that。 The person that created this must have copy and pasted some of this
    information from the internet or from emails and things。 And so it's not standardized。
    It's bothering me。 And I would。Like to get and transform this data。 So step 1
    is to simply click inside the data somewhere。
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 我的数据中有一些我不喜欢的多余空格、不同的颜色等等。创建此数据的人一定是从互联网上或电子邮件中复制粘贴了一些信息，因此它没有标准化。这让我感到烦恼。我想获取和转换这些数据。所以第一步就是简单地在数据的某处点击。
- en: So I have a range here of several rows and columns。 I just need to click somewhere
    inside that range of data。 and then I can go to the data tab and look in the get
    and transform group。 noticeice that there are various sources from which I can
    get the data。
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 所以我这里有几行几列的数据范围。我只需在数据范围内的某个位置点击，然后可以转到数据选项卡，在获取和转换组中查看。我注意到有多个来源可以获取数据。
- en: I can get it from text from the web from a table or range。 and there's a button
    here。 a drop down button that you can click to see even more possible sources
    for getting data。 So again。 making sure that I've clicked somewhere in my range。
    I'm going to click from table range。 and Excel has determined where my data is。
    Yes， my table has headers。 I click O。
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 我可以从文本、网页、表格或范围获取数据。这里有一个按钮，一个下拉按钮，你可以点击查看更多可能的数据来源。因此，再次确保我已点击某个范围，我将点击“从表格范围”。Excel已确定我的数据位置。是的，我的表格有标题。我点击“是”。
- en: and notice what it did， It turned my range。 my data into a table。 and it opened
    this new window。 This is the power query editor。 And if you're not used to。this
    window， it can be confusing。 It looks like Excel just changed dramatically。 And
    one reason for that is that this window is filling my screen。 So I'm going to
    click this button here in the upper right to minimize the power query editor just
    a bit。
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 注意它所做的，它把我的范围、数据变成了一个表格，并打开了这个新窗口。这就是**Power Query编辑器**。如果你不习惯这个窗口，它可能会让人感到困惑。看起来像是Excel发生了剧烈变化。而其中一个原因是这个窗口占满了我的屏幕。所以我会点击右上角的按钮，把Power
    Query编辑器稍微缩小一点。
- en: so that you can see that my original spreadsheet is still there in the background。
    My data is still intact。 The only thing that changed about it is that it was turned
    into a table and on top of my original sheet。 I have this power query editor。
    I'm going maximize it again。 I want you to think of this power query editor as
    being kind of like a sandbox。 that I can play in。
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 这样你就可以看到我原来的电子表格仍在后台。我的数据仍然完好无损。改变的唯一地方是它被转换成了一个表格，而在我的原始工作表上，我有这个Power Query编辑器。我会再次最大化它。我希望你把这个Power
    Query编辑器视为一个沙盒，我可以在其中玩耍。
- en: I can change the data。 I can try some things out， and none of it will affect
    or ruin my original data in the spreadsheet。 And then I can choose to add this
    data to my spreadsheet or not。 And let's take a close look at this power query
    editor。 In addition to being able to see my spreadsheet data here。 on the right
    side of the screen。
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 我可以更改数据，可以尝试一些东西，而这些都不会影响或破坏我在电子表格中的原始数据。然后我可以选择将这些数据添加到我的电子表格或不添加。让我们仔细看看这个Power
    Query编辑器。除了能够在屏幕右侧查看我的电子表格数据。
- en: I have the query settings and included in that。I have a list of applied steps。
    It says source。 In other words， I established a source for my data。 and that's
    the range that was turned into a table。 and it says changed type that probably
    refers to changing my range into a table as I make additional changes to this
    data。
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 我有查询设置，并在其中包含了一系列已应用的步骤。它说源。换句话说，我为我的数据建立了一个源。那就是被转换为表格的范围。它说更改类型，这可能是指将我的范围转换为表格，因为我对这些数据进行更多更改。
- en: you'll see those changes listed here。 Okay， so let's see how we can improve
    this data。 You'll notice that my title column is selected。 I could switch to category
    or second category or rating whatever I want to do。 but I'm going start with title
    and with that selected， I'm going go up here to my tabs。 noticeice that by default
    I am on the home tab and there are some options here that I can use to transform
    this data。
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 你会看到这些更改在这里列出。好的，让我们看看如何改进这些数据。你会注意到我的标题列被选中。我可以切换到类别或第二类别或评分，随便我想做什么。但我将从标题开始，选中后，我会去我的标签。注意，默认情况下我在主页选项卡上，这里有一些可以用来转换数据的选项。
- en: but there's even more options here on the transform tab by clicking on that。
    I can go to format and click and I would like to change all of the data in my
    title column to be lowercase。 So by clicking that button。And switching to lowercase。
    Look what happened。 Every movie title now is in lowercase only。 And that right
    there is an improvement。
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 但在转换选项卡上还有更多选择，只需点击即可。我可以进入格式，点击，我希望将我的标题列中的所有数据更改为小写。因此，通过点击那个按钮，并切换为小写。看看发生了什么。现在每个电影标题都仅为小写。这就是一个改进。
- en: because look at how it is in the original spreadsheet。 Some titles are in all
    caps。 Some are not。 It's just a mess。 And so in this sandbox in the power query
    editor。 I'm trying to standardize things and make them look the way they should。
    Now that everything is lowercase。 I can go back to the format button and choose
    capitalize each word。
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 因为看看原始电子表格中的情况。有些标题是全大写的，有些不是。这真是一团糟。因此，在这个 Power Query 编辑器的沙盒中，我试图标准化内容，使其看起来应该的样子。现在所有内容都是小写的。我可以回到格式按钮，选择每个单词首字母大写。
- en: I think that's an improvement。 Next， I'd like to fix all of these extra spaces
    that you can see in my title column。 Way too many spaces between gone and with。
    there's too many spaces here in front of the word Matilda。 just lots of problems
    with spacing to fix that。 I can go again。 to the format button。 And I'm going
    to try trimming the excess spaces。 When I click trim。
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 我认为这是一个改进。接下来，我想修复标题列中所有多余的空格。单词“gone”和“with”之间的空格太多。词“Matilda”前面也有太多空格。要解决这些空格问题，我可以再次去格式按钮。我将尝试修剪多余的空格。当我点击修剪时。
- en: you'll notice that extra spaces at the beginning and also at the end of the
    entries in these cells have。Been cleaned up。 The extra spaces have been removed。
    Now， what about the spaces between words。 That's a little bit tougher。 And there's
    probably a better way to do this。 But I'm going go up here to replace values。
    and I'll click and I want to Excel to find examples of three spaces in a row。
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 你会注意到，这些单元格中条目的开头和结尾的多余空格已经被清理掉了。多余的空格已被移除。那么，单词之间的空格呢？这有点难处理。可能有更好的方法来做到这一点。但我将去替换值。我会点击，想让
    Excel 找到连续三个空格的示例。
- en: So I just tap spacebar three times。 and I want to replace those three spaces
    in a row with just one space。 So I'm clicking here in the second box and tapping
    spacebar again。 I'm going to click O。 Now。 watch the data as I click O， You can
    see that that solved a lot of the problems with spacing。 I'll try it again。 I'll
    go up to replace values this time。
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 所以我连续按了三次空格键。我想将这三个连续的空格替换为一个空格。所以我在第二个框中点击，并再次按空格键。我将点击 O。现在，随着我点击 O，你可以看到这解决了很多空格问题。我再试一次，这次我将去替换值。
- en: maybe I'll replace two spaces with just one。 click O， again。 that seemed to
    improve my data。 Now。 let's look at my rating column。 If I click on the word rating。
    It highlights the whole column。 And I've noticed a couple of problems with this
    column as well。 Some of these movies are listed as。And others as R rated。 And
    P G13， I don't think is correct either。 So we'll use replace values again。
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 也许我将两个空格替换为一个。再次点击 O。这似乎改善了我的数据。现在。让我们看看我的评分列。如果我点击“评分”这个词，它会高亮显示整列。我注意到这一列也有几个问题。有些电影列为。而其他电影则标记为
    R 级和 P G13，我认为这也不正确。因此我们将再次使用替换值。
- en: So value to find R rated。 let's replace that with R。 And I'll do it again。 replace
    values value defined P G13， replace with Pg dash 13。 click O。 and it cleaned up
    the data for me。 Now， like I said， notice here at the right， my applied steps。
    I have a list of every step I've made。 If I regret any of these。 Let's say I regret
    fixing R rated。
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 所以要查找的值是R级，咱们将其替换为R。我再做一次。替换值定义P G13，将其替换为Pg-13。点击O，它为我清理了数据。正如我所说，注意右侧，我的已应用步骤。我有我所做的每一步的列表。如果我对其中任何一步后悔，比如我后悔修复R级。
- en: I can just click this red X。 Are you sure you want to delete this step。 It could
    cause some problems。 Let's try it out。 I click delete it removes that step。 and
    it did not cause problems for me。 Now， there are a lot of other ways in which
    I can transform this data。 I've shown you mostly this format button and the replace
    values button。
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 我只需点击这个红色的X。你确定要删除这个步骤吗？这可能会导致一些问题。让我们试一下。我点击删除，它移除了那个步骤，并没有给我带来问题。现在，我有很多其他方法可以转换这些数据。我主要向你展示了这个格式按钮和替换值按钮。
- en: and those are some of the most powerful options。 But there's much more。 And
    if you're interested。llMake more videos showing you some of the other options。
    But for now。 I want to also show you that instead of simply using these transform
    buttons that are here。 sometimes it's a little easier just to right click on a
    column title and choose options from the dropdown that appears。
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 这些是一些最强大的选项。但还有更多。如果你感兴趣，我会制作更多视频展示其他选项。但现在，我还想告诉你，有时候，不仅仅是使用这些变换按钮，右键点击列标题并选择下拉菜单中的选项会更简单。
- en: So I'll replace values again and change R rated back to R click。 let's assume
    that I'm completely happy with the transformations that I've made of this spreadsheet。
    and I'm ready to apply it to my workbook。 All I have to do is click this home
    button and then click close and load。 When I click close and load， it does take
    a little while sometimes but it creates a new spreadsheet。
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 我将再次替换值，将R级改回R。点击。假设我对这张电子表格所做的转换完全满意，并准备将其应用到我的工作簿中。我只需点击这个主页按钮，然后点击关闭并加载。当我点击关闭并加载时，有时会花一点时间，但它会创建一个新的电子表格。
- en: you'll notice that my original is still here sheet1。 Yes， it's a table now。
    but there's also a sheet4 that has all of my cleaned up data。 and I can browse
    down to see that all of the data came in。 I can now X out of this panel。 And if
    I really do prefer this data。To the original， I， of course。
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 你会注意到我的原始数据仍然在这里，表格1。是的，它现在是一个表格，但还有一个表格4，里面有我清理过的所有数据。我可以浏览下去查看所有数据都已导入。我现在可以关闭这个面板。如果我真的更喜欢这个数据而不是原始数据，当然。
- en: could right click on the original and delete that spreadsheet， click， delete。
    and I could even right click and rename sheet 4 to be my new sheet 1。 And I've
    just used get and transform， which used to be called power query。 to clean and
    transform the messy data into good data that I'm ready to work with。
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 我可以右键点击原始文件并删除那个电子表格，点击，删除。甚至我可以右键点击，将表格4重命名为我的新表格1。我刚刚使用了获取和转换，之前称为Power Query，来清理和转换杂乱的数据为我准备好的数据。
- en: There may be small changes that I still need to make。 But the majority of the
    work has been done。![](img/acec3a93d9b497450000e00a04171fff_2.png)
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 我可能仍然需要做一些小的更改。但大部分工作已经完成。![](img/acec3a93d9b497450000e00a04171fff_2.png)
