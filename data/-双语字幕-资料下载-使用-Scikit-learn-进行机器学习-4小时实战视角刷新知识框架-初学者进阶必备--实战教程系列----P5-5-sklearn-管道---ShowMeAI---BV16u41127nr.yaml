- en: 【双语字幕+资料下载】使用 Scikit-learn 进行机器学习，4小时实战视角刷新知识框架，初学者进阶必备！＜实战教程系列＞ - P5：5）sklearn
    管道 - ShowMeAI - BV16u41127nr
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 【双语字幕+资料下载】使用 Scikit-learn 进行机器学习，4小时实战视角刷新知识框架，初学者进阶必备！＜实战教程系列＞ - P5：5）sklearn
    管道 - ShowMeAI - BV16u41127nr
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_0.png)'
  id: totrans-1
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_0.png)'
- en: 。Well， in this video， we're going to be learning about Pscant Learn pipelines。We've
    been learning how to use linear regression as a model。 and often our model will
    have to transform the data in some sort of way before we can actually analyze
    it。 and so we'll end up with for our models are these pipelines where we do a
    series of transformations and then at the end we'll use an estimator is what they
    call it in PsyAL to actually make predictions。
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 好吧，在这个视频中，我们将学习 Pscant Learn 管道。我们一直在学习如何使用线性回归作为模型。通常我们的模型在分析数据之前需要对数据进行某种转换。因此，我们的模型最终会形成这些管道，我们会进行一系列转换，最后使用一个估计器，PsyAL
    中称之为估计器，以实际进行预测。
- en: And so for this example， I may be using a slightly more complicated data set
    in Chicago which is right on Lake Michigan。 they have all these sensors on different
    beaches which are measuring things about the waves and so I'm maybe looking at
    this data set all these measurements so I can see well here's an Ohio Beach here's
    63rd Street Beach。
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 因此在这个例子中，我可能会使用一个稍微复杂一点的数据集，在芝加哥，正好位于密歇根湖旁边。他们在不同海滩上都有这些传感器，测量波浪的相关数据，所以我可能会查看这个数据集中的所有测量结果，我可以看到这是俄亥俄海滩，这是63街海滩。
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_2.png)'
  id: totrans-4
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_2.png)'
- en: And then I know all these things about these sensors， like how warm is the water，
    turbidity。 and other things like that， and the why that we're going to try to
    predict is well how big are the waves on this speech。And we're going to be using
    things like like wave period to predict or maybe by looking directly at what beach
    we're on。
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我知道关于这些传感器的所有信息，比如水温、浊度等等，而我们要尝试预测的是这个海滩的波浪有多大。我们将使用波周期等因素来进行预测，或者直接看看我们所在的海滩。
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_4.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_4.png)'
- en: And so theres some garbage data in here， so I've cleaned that up。 so this is
    a picture of all the data where I have the wave period on the X axis and then
    on the Y axis。 I have wave height。![](img/6759ee1a4176e478df5915cb285d57a7_6.png)
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 所以这里有一些垃圾数据，我已经清理过了。这是所有数据的图表，X轴是波周期，Y轴是波高。![](img/6759ee1a4176e478df5915cb285d57a7_6.png)
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_7.png)'
  id: totrans-8
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_7.png)'
- en: Then I also try to break it down and to look beach by beach。 so here I'm kind
    of pulling out all the beaches as a sortrded list that's unique。![](img/6759ee1a4176e478df5915cb285d57a7_9.png)
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我也试着逐个海滩分析。因此在这里我把所有的海滩提取出来，形成一个唯一的排序列表。![](img/6759ee1a4176e478df5915cb285d57a7_9.png)
- en: From the beach name， and then what am I doing down here， I'm drawing each beach
    separately。![](img/6759ee1a4176e478df5915cb285d57a7_11.png)
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 根据海滩名称，然后我在这里做什么呢，我是分别绘制每个海滩。![](img/6759ee1a4176e478df5915cb285d57a7_11.png)
- en: So I'm creating some subplots。And I'm looping over those。 and I'm basically
    plotting each beach。 right， I'm doing some filtering in pandas。 I'm plotting each
    beach in a different Ax region。 And so I look at this。 and so there's a couple
    observations right away， often before I do modeling。 I like to just do a lot of
    scatter plots and try to get an intuition from what's going on。
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 所以我在创建一些子图。我正在循环这些子图，并基本上绘制每个海滩。对，我在 pandas 中进行一些过滤。我把每个海滩绘制在不同的 Ax 区域。所以我看着这个，有一些观察结果，通常在我建模之前，我喜欢做很多散点图，试图从中获得一些直觉。
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_13.png)'
  id: totrans-12
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_13.png)'
- en: One is that I do see that what beach runron is an important variable。 some of
    these beaches have different patterns in terms of the waves。The other thing I
    see is that the relationship between wave period and wave height is not linear。
    it's not as if the bigger the wave period， the bigger the wave height or vice
    versa。
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 一个是我确实看到海滩运行是一个重要变量。这些海滩在波浪方面有不同的模式。另一个我看到的是波周期和波高之间的关系并不是线性的。并不是说波周期越大，波高就越大，反之亦然。
- en: what I see is often there's kind of like this hump in the middle right so kind
    of if we want to get the biggest waves。 we need a wave period that's somewhere
    in the middle。![](img/6759ee1a4176e478df5915cb285d57a7_15.png)
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 我看到的情况是，通常在中间会有一个小隆起，因此如果我们想要得到最大的波浪，我们需要一个位于中间的波周期。![](img/6759ee1a4176e478df5915cb285d57a7_15.png)
- en: So I'm going to be making four different models here that try to analyze this
    data and they're each going to be using different variables in different ways
    first will be something very similar to what we've done before。 I'll try to predict
    the wave height based on wave period just using a simple linear ear regression
    and we'll see what performance we have there next we're going to learn how we
    can do a polynomial effect right so that means if I'm drawing a line on here while
    the line doesn't have to be straight anymore。
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 我将在这里构建四个不同的模型来分析这些数据，它们将以不同的方式使用不同的变量，第一个将与我们之前做的非常相似。我将尝试基于波周期预测波高，仅使用简单的线性回归，我们将看看它的表现如何。接下来，我们将学习如何进行多项式回归，这意味着如果我在这里画一条线，这条线就不必再是直的。
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_17.png)'
  id: totrans-16
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_17.png)'
- en: Finally， I'm going to look at well not finally， but next I'm going to look at
    what beach if the only thing I know is what beach I'm on。 how well can I predict？And
    then finally， I'm going look at the combination of both beach and wave period。
    with wave period being treated as a polynomial and see how much I can predict
    there。So in terms of my imports， I have some things that we've done before we've
    the first thing we learned was how to do a linear regression。
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我将研究，如果我只知道我在什么海滩上，我能多好地进行预测？然后最终，我将查看海滩和波周期的组合，将波周期视为多项式，看看我能在那儿预测多少。因此，在我的导入中，我有一些我们之前做过的内容，我们首先学习了如何进行线性回归。
- en: we would fit our linear regression to training data set and then we would evaluate
    it on a test data data set at the very end along the way we might also do crossvalidation
    within just the training data so these things are old and then these things down
    here are new right so in order to be able to。
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 我们会将线性回归拟合到训练数据集上，然后在最后评估测试数据集，在此过程中我们可能还会在训练数据中进行交叉验证，所以这些都是旧的内容，而下面的内容是新的。因此，为了能够。
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_19.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_19.png)'
- en: Deal with this data and I want in a polynomial way I might have to transform
    it using this polynomial features thing if I want to deal with categorical data
    like well what beach am I on that's not a number right that's a category I have
    to use this thing called one hot enr and if I want to use both of those I have
    to use this other thing make column transformer to combine them and in total what
    I'm going to do is I'm going have this pipeline and in the end of the pipeline
    I'm still going be doing just a simple linear regression。
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 处理这些数据时，我想以多项式方式进行，可能需要使用这个多项式特征的东西进行转换。如果我想处理像“我在什么海滩上”这样的分类数据，那不是数字，而是一个类别，我必须使用这个叫做“一热编码”的东西。如果我想使用这两者，我必须使用这个叫做“列转换器”的东西来将它们组合起来，最终我将有这个管道，在管道的最后，我仍然将进行简单的线性回归。
- en: But I'm going be making all these transformations to the data before it gets
    to that。 and that's how maybe I'll do these more complicated models。So let's start
    down here and I may call。 I'm just trying to number these four models of one，
    two， three。 four just following the numbering up here， as I may have Model 1 is
    going to be just a simple linear regression。
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 但我将在数据达到之前对其进行所有这些转换。这也许就是我如何构建这些更复杂模型的方式。让我们从这里开始，我可能会给这四个模型编号，分别为一、二、三、四，按照这里的编号，我可能将模型1设为简单的线性回归。
- en: Like that。 And And then what I could do is I could say M1， well， actually。I
    could do different things I could say M1 do fit and I would fit that to my x values
    and then my y values here。 this is uppercase because it's a full data frame and
    then this is lowercase because it's just done a single series and I guess before
    I have to do it I actually have to separate out my train data frame from my test
    data frame。And I say train test。Split Df。And maybe I'll just look at the length
    of both of these。
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 就像那样。然后我可以说M1，实际上。我可以做不同的事情，我可以说M1进行拟合，我会将其拟合到我的x值和y值上。这是大写，因为它是一个完整的数据框，而这是小写，因为它只是一个单一系列。我想在此之前，我实际上需要将我的训练数据框与测试数据框分开。我说训练测试。拆分Df。也许我会查看这两个的长度。
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_21.png)'
  id: totrans-23
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_21.png)'
- en: 。And so about 25% is going into testing， which I'll be fine with that。And so
    then down here I have to have my trained DF， and then here I can put a list of
    features。And then over here， I may have my train DF again， and I just may have
    my Y column。 and so my y column， the thing I'm trying to predict is just while
    the wave height。
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 所以大约25%的数据用于测试，我对此没问题。因此在这里，我需要我的训练数据框，然后我可以放一个特征列表。然后在这里，我可能会再次使用我的训练数据框，我只需使用我的y列。我的y列，也就是我试图预测的，就是波高。
- en: Like that and then my list of features， well first off I've put a list here
    and that's why I get these weird double brackets。 I'm just going to start with
    wave period just like that and I probably have to capitalize to match what is
    in my data frame from earlier if I check back。
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 就这样，然后我的特征列表，首先我在这里列出了一个列表，这就是我得到这些奇怪的双括号的原因。我将首先使用波周期，如果我回去查看，我可能需要大写以匹配早先数据框中的内容。
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_23.png)'
  id: totrans-26
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_23.png)'
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_24.png)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_24.png)'
- en: Yep， it looks like all these things are capitalizing。And so I can do that。And，
    and now。 this model has learned the pattern。And so then what I could do is I could
    say M1 dot predict。Based on my testing data。So I could say test Df， right so I
    give it only x values and then it's going to predict what these y values are for
    me。
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 是的，看来这些都是大写的。所以我可以这样做。现在，这个模型已经学习了模式。那么我可以说M1点预测。基于我的测试数据。所以我可以说测试数据框，只给它x值，然后它将为我预测这些y值。
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_26.png)'
  id: totrans-29
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_26.png)'
- en: And so let me oh， might I call it M2 M1。 And so I get all these predictions。
    And then what I could do is I can compare those predictions to。![](img/6759ee1a4176e478df5915cb285d57a7_28.png)
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 所以让我叫它M2和M1。我得到了所有这些预测。接下来我可以将这些预测进行比较。![](img/6759ee1a4176e478df5915cb285d57a7_28.png)
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_29.png)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_29.png)'
- en: What I actually have for that wave period。I can compare these numbers to these
    numbers down here and at a glance I see it's not very close the easier way for
    me to do that comparison and actually get a score will be I call the scoring right
    so the score function will automatically call that predict on this and then it'll
    compare that to my test D of wave height and it will tell me what percentage of
    the variance I'm explaining there and I see right now it's terrible right I'm
    not really explaining anything if I just always predict the average wave height
    that would be better than what I'm doing right now now of course some of this
    is luck in terms of like how I did my train test split。
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 我实际上对这个波周期的数据进行比较。我可以把这些数字与下方的数字进行比较，乍一看，我看到它们并不接近。我进行比较的更简单方法是调用评分函数，这样评分函数会自动在此调用预测，然后与我的波高测试数据进行比较，告诉我我解释的方差百分比，而现在我看到结果很糟糕，实际上我没有解释任何东西。如果我总是预测平均波高，那会比我现在的结果要好。当然，这其中有些运气成分，特别是在我如何进行训练测试拆分方面。
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_31.png)'
  id: totrans-33
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_31.png)'
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_32.png)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_32.png)'
- en: And so the more reliable way to get a measure here。 Let me just print that would
    be to do my cross validation。 That so I can say cross validation score。![](img/6759ee1a4176e478df5915cb285d57a7_34.png)
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 所以这里更可靠的衡量方法是进行交叉验证。让我打印一下交叉验证得分。![](img/6759ee1a4176e478df5915cb285d57a7_34.png)
- en: And then here I have to give it three things， I have to say， well， what is my
    model， my model is M1。 what are my x values and what are my y values I'm going
    to do this up here。And when'm doing the cross validation I usually do that all
    within the training data and I just try and hold back the test data for the very
    end of my project to have a final analysis I see I actually get a variety of scores
    and we can see that yeah it is a matter of luck sometimes I do worse than zero
    most of the time not I can say how many pieces I want to break my data into remember
    that I cycle through each piece or fold and it has its turn being the test data
    set so I can get more here numbers here maybe I'm just going to say scores equals
    that and I could say scores don't mean。
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我需要给它三个东西，我得说，嗯，我的模型是什么，我的模型是M1。我的x值和y值是什么，我将在这里进行处理。当我进行交叉验证时，我通常会在训练数据中完成这一切，我只是尝试将测试数据保留到项目的最后进行最终分析，我发现我实际上得到了各种分数，有时运气不好我做得甚至还不如零，大多数情况下我可以说我想将数据分成多少块，记住我会循环遍历每一块或折叠，它都有机会成为测试数据集，所以我可以在这里获得更多数字，也许我只会说分数等于这个，我可以说分数没有意义。
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_36.png)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_36.png)'
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_37.png)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_37.png)'
- en: And so this is probably a better indication of how well my model is doing。 I'm
    explaining 1/10th of 1% of the pattern， which is not too surprising right all
    I'm using is the wave period and I'm trying to fit a straight line to this and
    I can see well yeah。
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 所以这可能是我模型表现的更好指示。我解释了1/10的1%的模式，这并不令人惊讶，对吧，我用的只是波周期，我试图将一条直线拟合到这里，我能看到，嗯，是的。
- en: no surprise I can't fit a straight line to it。![](img/6759ee1a4176e478df5915cb285d57a7_39.png)
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 毫不奇怪，我无法将一条直线拟合到它上面。![](img/6759ee1a4176e478df5915cb285d57a7_39.png)
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_40.png)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_40.png)'
- en: Okay， if I wanted to， let me just copy this for a moment， I'm going to delete
    it shortly。If I wanted to do more columns， that would be an easy thing to do。
    So for example。 if I wanted to also include， let's say like the water temperature。
    I could easily add that as another column， right， It's very simple to have multiple
    x values So I can do that here。
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 好吧，如果我想要，我先复制一下这个，我很快就会删掉。如果我想做更多的列，那将是一件简单的事情。例如，如果我想包括，比如说水温。我可以很容易地将其作为另一列添加，对吧，有多个x值非常简单。所以我可以在这里做到。
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_42.png)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_42.png)'
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_43.png)'
  id: totrans-44
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_43.png)'
- en: And then down here as well and then maybe I get a slightly different score still
    not great right was just try delete this here right。 but it's very easy to add
    these different things and why is that well when I do this and I put that list
    here。 I'm just showing a simple data frame of X columns that I want to use for
    my predictions。
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 然后在这里，也许我会得到一个稍微不同的分数，还是不太好，对吧，试着把这个删掉。 但是添加这些不同的东西非常简单，为什么呢？因为当我这样做并把那个列表放在这里时。我只是展示了一个我想用来进行预测的简单数据框，包含X列。
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_45.png)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_45.png)'
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_46.png)'
  id: totrans-47
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_46.png)'
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_47.png)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_47.png)'
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_48.png)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_48.png)'
- en: Okay， so that's that's how we can add things， let's actually think about how
    we're going to do this now if I want to have a polynomial vet。 so what we'll do
    is let me actually delete all of this。😊。![](img/6759ee1a4176e478df5915cb285d57a7_50.png)
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 好吧，这就是我们如何添加东西，实际上让我们考虑一下现在该怎么做，如果我想要有一个多项式拟合。那么我们要做的是，实际上让我把这一切都删掉。😊。![](img/6759ee1a4176e478df5915cb285d57a7_50.png)
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_51.png)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_51.png)'
- en: I'm just trying to create a demo here， which is going a copy of my train DF
    and my train DF Im may have just。A waveve period。![](img/6759ee1a4176e478df5915cb285d57a7_53.png)
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 我只是想创建一个演示，这将是我的训练DF的副本，而我的训练DF可能只是一个波周期。![](img/6759ee1a4176e478df5915cb285d57a7_53.png)
- en: Let me take a look at this data frame， but we're going to be doing if I want
    to have say like a quadratic fit。 I want to just add some columns down here that
    are going to contain that square data。![](img/6759ee1a4176e478df5915cb285d57a7_55.png)
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 让我看一下这个数据框，但我们要做的事情是，如果我想要有一个二次拟合。我想在这里添加一些列，这些列将包含平方数据。![](img/6759ee1a4176e478df5915cb285d57a7_55.png)
- en: And so I can do things like this， I could say demo。I could say period。Squared。Equals
    demo。Of wave period。That or I could have like one that's cubed like this。![](img/6759ee1a4176e478df5915cb285d57a7_57.png)
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 所以我可以做这样的事情，我可以说演示。我可以说周期。平方。等于demo。波期。那我可以有像这样的一个是立方体。![](img/6759ee1a4176e478df5915cb285d57a7_57.png)
- en: And。And why is that unhappy， Oh， because I'm doing a comparison on an assignment。
    so I just assumed that' already exists。![](img/6759ee1a4176e478df5915cb285d57a7_59.png)
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 这是为什么不开心，哦，因为我在一个比较上做一个分配。所以我只是假设那'已经存在。![](img/6759ee1a4176e478df5915cb285d57a7_59.png)
- en: And so if I do that， then。![](img/6759ee1a4176e478df5915cb285d57a7_61.png)
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 所以如果我这样做，那么。![](img/6759ee1a4176e478df5915cb285d57a7_61.png)
- en: And you know， I do I actually want to copy this so that it doesn't complain。I
    can see what I'll do is that this column while two squared is2，2 cubed as8。3 squared
    his line。33 cubed is 27。 And so what I can actually do is I can do a linear regression
    across these things right and so even though secondly the linear regression is
    trying to act like quadratic or cubic regression because。
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 而且你知道，我实际上想要复制这个，以免抱怨。我可以看到我会做的事情是，这一列而二平方是2，2立方体是8。3平方体线。33的立方体是27。所以我实际上可以做的是对这些东西进行线性回归，即使第二次线性回归试图像二次或三次回归一样。
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_63.png)'
  id: totrans-58
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_63.png)'
- en: Because I'm just treating these as regular columns right and I can put kind
    of weights to how important these things are and so how can I do this so here
    I was just manually adding these things If I want to I can use this polynomial
    features thing。![](img/6759ee1a4176e478df5915cb285d57a7_65.png)
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 因为我只是把这些视为常规列，我可以对这些东西的重要性进行加权，所以我怎么能做到这一点呢，这里我只是手动添加这些东西，如果我想的话，我可以使用这个多项式特征的东西。![](img/6759ee1a4176e478df5915cb285d57a7_65.png)
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_66.png)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_66.png)'
- en: And so down here， may I say Polly。Equals polynomial features， and I can say
    poly dot fit transform。And what I want to do， I want to transform my data right
    here， this was what I had before。![](img/6759ee1a4176e478df5915cb285d57a7_68.png)
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 所以在这里，我可以说波利。等于多项式特征，我可以说poly点fit transform。我想在这里转换我的数据，这是我以前有的。![](img/6759ee1a4176e478df5915cb285d57a7_68.png)
- en: So I'm going to run this thing。And I see that I get all these different columns。And
    and if I wanted to， let me capture those in data， right， This is one of those
    nuy arrays。 which we'll eventually learn about until we learn about it。 I just
    want to put it in a panda data frame so I can better see what's happening。
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 所以我要运行这个东西。我看到我得到了所有这些不同的列。如果我想的话，让我在数据中捕捉这些，对，这是其中一个nuy数组。我们最终会学到的，直到我们学到为止。我只是想把它放在熊猫数据框中，这样我就能更好地看到发生了什么。
- en: So I going say pandas data frame。![](img/6759ee1a4176e478df5915cb285d57a7_70.png)
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 所以我要说熊猫数据框。![](img/6759ee1a4176e478df5915cb285d57a7_70.png)
- en: And then I'm going put my data there and then I want to figure out what the
    column names are on those and it turns out that this thing will tell me that as
    well。 so I can say， I'm sorry Polly will tell me that， so I can say poly do。![](img/6759ee1a4176e478df5915cb285d57a7_72.png)
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我要把我的数据放在那里，然后我想知道这些列的列名是什么，结果这件事也会告诉我。所以我可以说，抱歉Polly会告诉我，所以我可以说多项式处理。![](img/6759ee1a4176e478df5915cb285d57a7_72.png)
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_73.png)'
  id: totrans-65
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_73.png)'
- en: Feature names just like that， and I have to say columns equals that。![](img/6759ee1a4176e478df5915cb285d57a7_75.png)
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 就像那样的特征名称，我必须说的列等于。![](img/6759ee1a4176e478df5915cb285d57a7_75.png)
- en: And now I can see well I have V x and then x squared。 and I actually have to
    tell what my original name was for that to work。![](img/6759ee1a4176e478df5915cb285d57a7_77.png)
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我可以看到，我有V x然后x平方。我实际上必须告诉我的原始名字才能起作用。![](img/6759ee1a4176e478df5915cb285d57a7_77.png)
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_78.png)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_78.png)'
- en: I actually have to have like a list of that， excuse me。![](img/6759ee1a4176e478df5915cb285d57a7_80.png)
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 我实际上必须有像这样的一个列表，请原谅我。![](img/6759ee1a4176e478df5915cb285d57a7_80.png)
- en: And so I can see， okay， well I have period and I have period squared， and if
    I wanted to appear。 I could say things like well I want to have it be a fourth
    degree right so I could have period period squared period cubed period to the
    fourth。![](img/6759ee1a4176e478df5915cb285d57a7_82.png)
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 所以我能看到，好的，我有一个周期和一个周期的平方，如果我想出现。我可以说像这样的事情，我想要它成为一个四次的对吧，所以我可以有一个周期周期的平方周期的立方周期的四次。![](img/6759ee1a4176e478df5915cb285d57a7_82.png)
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_83.png)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_83.png)'
- en: You can see it also is giving me period to the zero which is just a column of
    ones right and so what I'll often do is I'll disable that it's called the bias
    column。 so I'll say I don't want that thing。![](img/6759ee1a4176e478df5915cb285d57a7_85.png)
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以看到它也给我提供了一个零的列，这实际上是一列全是1的值。所以我通常会禁用这个称为偏置列的东西。所以我会说我不想要那个东西。![](img/6759ee1a4176e478df5915cb285d57a7_85.png)
- en: And so now I actually have something that's very similar to what I did above
    manually and I could do that with my data right I could if I wanted to I could
    do this transformation on both my training data and then my test data and then
    that's what I would do all my modeling on now I think to keep things simpler what
    we want to do is we want to automatically transform and then immediately apply
    the linear regression and so it turns out that pipelines which I also imported
    up here。
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我实际上有一些与我之前手动所做的非常相似的东西，我可以使用我的数据进行这个转换。如果我想的话，我可以对我的训练数据和测试数据都进行这个转换，然后这就是我将要进行所有建模的基础。现在，我认为为了简化，我们想要自动进行转换，然后立即应用线性回归，事实证明，这里的管道（pipelines）也被我导入了。
- en: make that really easy to do right so I can create a pipeline down here。![](img/6759ee1a4176e478df5915cb285d57a7_87.png)
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 让这一切变得非常简单，所以我可以在这里创建一个管道。![](img/6759ee1a4176e478df5915cb285d57a7_87.png)
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_88.png)'
  id: totrans-75
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_88.png)'
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_89.png)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_89.png)'
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_90.png)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_90.png)'
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_91.png)'
  id: totrans-78
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_91.png)'
- en: Like this， and maybe I'll just draw this on this is going to be my second model。
    it's going to be a pipeline， and then we have to pass in a list here。![](img/6759ee1a4176e478df5915cb285d57a7_93.png)
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 就像这样，也许我会在这里画出这个，它将成为我的第二个模型。它将是一个管道，我们必须在这里传入一个列表。![](img/6759ee1a4176e478df5915cb285d57a7_93.png)
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_94.png)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_94.png)'
- en: And the way the list works is that I will have like transformers。U。 and I might
    have like one or more of those。And then at the end， I may have an estimator。Right
    so all of these things are going to be modifying my data in some way。 maybe adding
    more columns and then at the very end I may actually do my real model and my real
    model is just a linear。
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 列表的工作方式是我会有像转换器（transformers）这样的东西。我可能会有一个或多个这样的东西。然后在最后，我可能会有一个估计器。所以所有这些东西都将以某种方式修改我的数据，可能会添加更多的列，然后在最后我可能实际上会进行我的真实模型，而我的真实模型只是一个线性模型。
- en: regression like that。 And then here， well， what are my transformers， well。 I'm
    just trying to do polynomial features like this。And and I think the degree of
    two will be fine for us for now and so I have these two things and then the later
    detail about this pipeline is that we have to name each of our stages of the pipeline
    and the way that it wants us to do that is it wants us to put these things in
    parentheses to create a tuple and then put a name as the first part of the tuple。
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 就是这样的回归。那么这里，我的转换器是什么呢？我只是想像这样做多项式特征。我认为二次的程度对于我们现在来说是合适的，所以我有这两个东西，关于这个管道的后续细节是，我们必须给每个阶段命名，而它想让我们这样做的方式是将这些东西放在括号内以创建一个元组，然后将名称放在元组的第一部分。
- en: so I'm going to call this transformer poly because it's a polynomial transformer
    and then this thing I don't know I'll just call that LR for short。It doesn't really
    matter。![](img/6759ee1a4176e478df5915cb285d57a7_96.png)
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 所以我将这个转换器称为poly，因为它是一个多项式转换器，然后这个我不知道，我就称它为LR的缩写。其实这并不重要。![](img/6759ee1a4176e478df5915cb285d57a7_96.png)
- en: Allright so let me just take a look here M2 it kind of shows me all these details
    of it。 but now M2 is just a model right and it's a lot like a simple linear regression
    I can do it in all the same ways so for example if I head back here all of this
    stuff I did before。
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 好吧，让我看一下M2，它向我展示了所有这些细节。但是现在M2只是一个模型，它与简单的线性回归非常相似，我可以用同样的方法进行。比如说，如果我回到这里，所有之前做的事情。
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_98.png)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_98.png)'
- en: You I just created M1 as my model and I did all this stuff on it。 I can do all
    those same things down here right so if I run down here and I just say M2 dofi
    and maybe I'll just delete this for simplicity everything's the same and I can
    see while maybe I'm doing slightly better now so what was my score before。
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 我刚刚创建了M1作为我的模型，并且我在它上面做了所有这些事情。我可以在这里做所有那些相同的事情，所以如果我在这里运行，只需说M2 dofi，也许我会为简化起见删除这个，一切都是一样的，我可以看到也许我现在的表现稍微好一点。那么我之前的分数是多少呢？
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_100.png)'
  id: totrans-87
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_100.png)'
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_101.png)'
  id: totrans-88
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_101.png)'
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_102.png)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_102.png)'
- en: Actually， that's exactly the same。 I was expected to do slightly better。 And
    why wasn't I doing better， probably because I was evaluating my same model。 That's
    the curse of the of the copy paste。 Okay， so so before let me just see this。 I
    was explaining 0。1%。
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，这完全是一样的。我本来期望表现得稍微好一点。为什么我表现得没有更好，可能是因为我在评估我的同一个模型。这就是复制粘贴的诅咒。好吧，在此之前让我看看这个。我解释的是0.1%。
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_104.png)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_104.png)'
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_105.png)'
  id: totrans-92
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_105.png)'
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_106.png)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_106.png)'
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_107.png)'
  id: totrans-94
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_107.png)'
- en: Well I guess closer to 0。2% of the variance and now I'm explaining more like
    4。6% so I can see that model2 is a huge improvement on Model one and the only
    thing I really did there I'm still doing a linear regression but I'm just giving
    it a little bit more information to work with by giving it these extra columns
    I have a column that says something like wave period squared and drawing way back
    here。
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 嗯，我想接近0.2%的方差，现在我解释的是差不多4.6%，所以我可以看到模型2相比模型1有了巨大的改进，而我真正做的就是我仍在进行线性回归，但我通过给它这些额外的列，提供了更多的信息。我有一列大概是“波周期的平方”，在这里绘制。
- en: the intuition is right is I'm fitting a line here。![](img/6759ee1a4176e478df5915cb285d57a7_109.png)
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 直觉是，我在这里拟合一条线。![](img/6759ee1a4176e478df5915cb285d57a7_109.png)
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_110.png)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_110.png)'
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_111.png)'
  id: totrans-98
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_111.png)'
- en: And that line doesn't have to be straight anymore。 It can be a quadratic line
    that kind of curves。![](img/6759ee1a4176e478df5915cb285d57a7_113.png)
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 而且那条线不必再是直线。它可以是一个弯曲的二次曲线。![](img/6759ee1a4176e478df5915cb285d57a7_113.png)
- en: Okay， so we have two of these models。 We have this one。 which was terrible right
    It told me almost nothing。 Sometimes this one。 depending on your train test data
    site would actually lead you farther away from the truth。 And if you just always
    guess the average， this one is actually doing somewhat well。
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 好的，我们有这两个模型。我们有这个，真的是很糟糕，它几乎告诉我没有什么。有时这个模型，取决于你的训练测试数据集，实际上会让你离真相更远。如果你总是猜测平均值，这个模型实际上表现得相当不错。
- en: right It's explaining almost 5% of the variance。 Let's try the beach。 And and
    see how we can do that。 So that'll be my third model。 And so if I come down here。
    I think for this one， I'm just going to go back to here and try this as a first
    attempt。![](img/6759ee1a4176e478df5915cb285d57a7_115.png)
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 好吧，它几乎解释了5%的方差。让我们试试海滩，看看我们能做到什么。这将是我的第三个模型。所以如果我下来这里，我想对这个模型做第一次尝试。![](img/6759ee1a4176e478df5915cb285d57a7_115.png)
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_116.png)'
  id: totrans-102
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_116.png)'
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_117.png)'
  id: totrans-103
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_117.png)'
- en: Maybe I should have some comments here， right， so this is。This is Po period。![](img/6759ee1a4176e478df5915cb285d57a7_119.png)
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 也许我应该在这里加些注释，对吧，这个是。这是波周期。![](img/6759ee1a4176e478df5915cb285d57a7_119.png)
- en: And then what was this one up here， so Model one， this was just linear on period。![](img/6759ee1a4176e478df5915cb285d57a7_121.png)
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 然后这个在上面是什么，模型1，这只是基于周期的线性分析。![](img/6759ee1a4176e478df5915cb285d57a7_121.png)
- en: And then I'm going to try doing you know， linear on beach is what I'm trying
    to do right now。 And so if I have this model， I'm going to call this model 3。And
    maybe'm going to delete this again just to keep it clean。And may do this down
    here。![](img/6759ee1a4176e478df5915cb285d57a7_123.png)
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我会尝试进行线性分析，海滩就是我现在想做的事情。所以如果我有这个模型，我将把这个模型称为模型3。也许我会再次删除这个，以保持干净。可能会在这里做这个。![](img/6759ee1a4176e478df5915cb285d57a7_123.png)
- en: The main thing I want to do is instead of having it be wave period， I want it
    to be the beach name。 and if I had it all the way up here I' just see all that
    speech name。![](img/6759ee1a4176e478df5915cb285d57a7_125.png)
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 我想做的主要事情是，想要将其改为海滩名称，而不是波周期。如果我把它放在这里，我就能看到所有的海滩名称。![](img/6759ee1a4176e478df5915cb285d57a7_125.png)
- en: Okay， so I'm going to head down here and I want to predict。![](img/6759ee1a4176e478df5915cb285d57a7_127.png)
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 好的，我要下去，我想要预测。![](img/6759ee1a4176e478df5915cb285d57a7_127.png)
- en: The wave height based on beach name， right， so just like that。 And then this
    is also beach name down here。![](img/6759ee1a4176e478df5915cb285d57a7_129.png)
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 波浪高度基于沙滩名称，对吧，就像这样。而且这也是下面的沙滩名称。![](img/6759ee1a4176e478df5915cb285d57a7_129.png)
- en: And this is going to complain to me and what does it complain about it says
    could not convert to a float Ohio street name Street Beach is not it to not be
    converted to a float and that makes a lot of sense right so this thing here if
    I take a look at it is。
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 这将会给我抱怨，它说无法将俄亥俄街名称沙滩转换为浮点数，这确实没有被转换为浮点数，这很有道理。因此，如果我看一下这个东西。
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_131.png)'
  id: totrans-111
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_131.png)'
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_132.png)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_132.png)'
- en: That's categorical data and it turns out the linear regression will eventually
    learn why。 but it wants everything to be numeric。![](img/6759ee1a4176e478df5915cb285d57a7_134.png)
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 这是分类数据，事实证明线性回归最终会学习到原因。但它希望一切都是数字的。![](img/6759ee1a4176e478df5915cb285d57a7_134.png)
- en: And so that's a problem。 And so how do I。How do I。How do I deal with this， I
    mean。 maybe one idea that students sometimes come up with is that I could intde
    these。 I could say like one means Ohio Beach and then maybe two means a calummet
    beach。 and then maybe three means， something like Montrose Beach。
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 所以这是个问题。那么我该如何处理呢，我的意思是，也许学生有时想到的一个主意是，我可以编码这些。我可以说，1代表俄亥俄沙滩，2代表卡拉梅特沙滩，然后3可能代表蒙特罗斯沙滩。
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_136.png)'
  id: totrans-115
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_136.png)'
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_137.png)'
  id: totrans-116
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_137.png)'
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_138.png)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_138.png)'
- en: And。The problem is is that if I put these numbers like this。嗯。The linear regression
    model is going to assume they're meaningful。 and so what that means is that if
    the model learn something about Ohio Beach and then it learn something about Monroose
    Beach。It mistakenly thinks it know something about calamette Beach just I think
    that that's somehow the average all these other show and of course that's not
    true right I mean。
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 问题是，如果我把这些数字放成这样。嗯，线性回归模型会假设它们是有意义的。这意味着，如果模型学习到关于俄亥俄沙滩的某些东西，然后学习到关于蒙特罗斯沙滩的东西。它错误地认为它了解一些关于卡拉梅特沙滩的信息，我觉得这就像是所有其他沙滩的平均值，当然这不是真的。
- en: just I kind of arbitrarily put these numbers here。 there's no reason to believe
    that this beach has characteristics that are kind of average of other two so that's
    not going to work right I can't ent it that way。![](img/6759ee1a4176e478df5915cb285d57a7_140.png)
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 我只是有点任意地把这些数字放在这里。没有理由相信这个沙滩有其他两个沙滩的平均特征，所以那样是行不通的，我不能那样编码。![](img/6759ee1a4176e478df5915cb285d57a7_140.png)
- en: The idea that we going to use instead is called one hot en coatding and one
    hot in toding looks like this。 one hot ender。It's going to be like that and I
    can say 112 thatt foot。Transform。I'm going to transform this data right here。And
    I get this weird thing that's， well。 whatever is that that's like it says it's
    like a sparse matrix。
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 我们要使用的想法叫做独热编码（one hot encoding），独热编码看起来是这样的。独热编码。这将是这样的，我可以说112那个脚。转换。我将把这个数据在这里进行转换。然后我得到了这个奇怪的东西，嗯，无论那是什么，那就像是稀疏矩阵。
- en: We're going eventually learn more about that， but I can convert it to this thing，
    which is。I is a nuy array， and then that thing I can actually put into， and I'm
    going simplify this a bit。That thing I can actually put into a data frame or sometimes
    say panda do data frame。
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 我们最终会学到更多，但我可以把它转换成这个东西，这是一个NumPy数组，然后这个东西我实际上可以放进， 我会简化一下。这个东西我实际上可以放入数据框，或者有时称为pandas数据框。
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_142.png)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_142.png)'
- en: Just like this and then just like before， I want to figure out what these columns
    are and so just like with the polynomial transformer。 I could say get feature
    names，Same deal here， right， I can say what hot dot get feature names。like that
    and then I have to tell it well， what was I originally operating with and I guess
    I was like the beach。
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 就像这样，然后就像之前那样，我想弄清楚这些列是什么，所以就像多项式变换器一样。我可以说获取特征名称，情况也是一样，对吧，我可以说什么热点获取特征名称。就这样，然后我必须告诉它，我最初是用什么操作的，我想我是在沙滩上。
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_144.png)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_144.png)'
- en: And why is that unhappy？So the shape of the values past is this and and indices
    imply。Something like that， I wonder what is going out right there。 I think my
    promise is that I need to say like columns equals that。![](img/6759ee1a4176e478df5915cb285d57a7_146.png)
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 那为什么这样不高兴呢？所以过去的值的形状是这样的，索引暗示了。类似的东西，我在想那里发生了什么。我认为我的承诺是我需要说像列等于那个。![](img/6759ee1a4176e478df5915cb285d57a7_146.png)
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_147.png)'
  id: totrans-126
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_147.png)'
- en: Okay， and so how is this working， so the first one by first row was Ohio Beach。And
    you see that I have actually a column for each different beach。And what we'll
    do is we'll set within that。 We'll set it to one。 If it's an Ohio Beach。 and then
    it'll be 0 and all others。 If I go a few down。
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 好的，那么这是如何工作的，第一行是俄亥俄海滩。你看到我实际上为每个不同的海滩都有一列。我们要做的是设置在其中。如果是俄亥俄海滩，我们会设为1。然后其他都是0。如果我再往下几行。
- en: I see that I have a Mon Rose Beach in position 4。![](img/6759ee1a4176e478df5915cb285d57a7_149.png)
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 我看到我在第4个位置有蒙特罗斯海滩。![](img/6759ee1a4176e478df5915cb285d57a7_149.png)
- en: And so that taste， I'll put a one under Mont Rose Beach and then a zeros under
    others。 And that's what we call it one hot。 right， So I guess the place where
    it's hot is where we have a one and then everywhere else。 it says zero， So if
    I have this。![](img/6759ee1a4176e478df5915cb285d57a7_151.png)
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 所以那个口味，我会在蒙特罗斯海滩下放一个1，然后在其他地方放0。这就是我们所称的“一热编码”。对吧，所以我想热的地方是我们有1的地方，而其他地方是0。所以如果我有这个。![](img/6759ee1a4176e478df5915cb285d57a7_151.png)
- en: Even though I started with some categorical data， I can end up with something
    where。Where I have a bunch of numbers。And so if I， if I clean this up here。![](img/6759ee1a4176e478df5915cb285d57a7_153.png)
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管我一开始有一些分类数据，但我最终可能会得到一些数字的东西。所以如果我整理一下。![](img/6759ee1a4176e478df5915cb285d57a7_153.png)
- en: Let me draw back to this。 I may actually delete all of this because this was
    kind of a dead end。 right， What will be a closer inspiration is the pipeline I
    used before with。![](img/6759ee1a4176e478df5915cb285d57a7_155.png)
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 让我回到这个。我可能会删除所有这些，因为这有点走入死胡同。对吧， 更接近的灵感是我之前使用的管道。![](img/6759ee1a4176e478df5915cb285d57a7_155.png)
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_156.png)'
  id: totrans-132
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_156.png)'
- en: With with the polynoial features because just like polynonoial features as a
    transformer。 so also is one hot encoding right， so I'm going to tweak this， we're
    on model 3 now。And this is one hot。And here I can just blowl this away， and I
    can say one hot in toor。Just like that。 and then I can do my linear regression
    down here。 and so then I can say down here。
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 由于多项式特征，因为就像多项式特征作为变换器一样。所以一热编码也是对的，我要调整一下，现在我们在模型3。这就是一热编码。在这里我可以直接放弃这个，然后我可以说一热编码。就这样。然后我可以在这里做线性回归。然后我可以在这里说。
- en: I can say。![](img/6759ee1a4176e478df5915cb285d57a7_158.png)
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 我可以说。![](img/6759ee1a4176e478df5915cb285d57a7_158.png)
- en: I think it was like beach name， right。 So beach name。 and then。Actually， I don't
    even need this。 right， Im I'm kind of this will automatically do the fitting for
    me and tell me how well it's doing。呃。I wonder why this is complaining up here。
    I get nervous that's thread anyway。 It'll probably tell me shortly。I can say beach
    name here。
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 我想这像是海滩名称，对吧。海滩名称。然后。实际上，我甚至不需要这个。对，我有点这会自动为我进行拟合，并告诉我效果如何。呃。我想知道为什么这在这里抱怨。我有点紧张，不过它可能会很快告诉我。我可以在这里说海滩名称。
- en: And then let me try that and then sure enough， it's invalid syntax。Because I
    didn't have a match there。![](img/6759ee1a4176e478df5915cb285d57a7_160.png)
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 然后让我试一下，果然，这是无效的语法。因为我那里没有匹配。![](img/6759ee1a4176e478df5915cb285d57a7_160.png)
- en: 。And so this does even better than before， right， so I guess just looking at
    the beach name is even better than knowing what the wave period is。![](img/6759ee1a4176e478df5915cb285d57a7_162.png)
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 所以这比之前更好，对吧，我想仅仅查看海滩名称就比知道波周期更好。![](img/6759ee1a4176e478df5915cb285d57a7_162.png)
- en: Right， so my model is getting better and better。 right first。 I started with
    just a linear model on the wave period。 and then that's terrible right I'm now
    even explaining 1%。![](img/6759ee1a4176e478df5915cb285d57a7_164.png)
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 对，所以我的模型越来越好。对，首先。我一开始只是用线性模型看波周期。然后那太糟糕了，我现在甚至只能解释1%。![](img/6759ee1a4176e478df5915cb285d57a7_164.png)
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_165.png)'
  id: totrans-139
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_165.png)'
- en: And I said， well let's do a polynomial fit on the wave period and I'm explaining
    almost 5% and well about 4 and half percent。 then I just look only at the beach
    and I get 5。5% and so the kind of natural next thing to do is well let's do the
    regression on both beach and and also polynomial of the wave period and maybe
    I can do even better maybe that both these things are providing me some information。
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 我说，嗯，让我们对波浪周期进行多项式拟合，我大约解释了5%，而且差不多是4.5%。然后我只看海滩，得到5.5%。接下来自然而然要做的事情是，让我们对海滩和波浪周期的多项式进行回归，也许我可以做得更好，或许这两者都为我提供了一些信息。
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_167.png)'
  id: totrans-141
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_167.png)'
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_168.png)'
  id: totrans-142
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_168.png)'
- en: And so here is where I get to have a challenge， right because I want to do one
    hot en coating on the beach name。 and I want to do polynomial features。![](img/6759ee1a4176e478df5915cb285d57a7_170.png)
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是我面临挑战的地方，对吧，因为我想对海滩名称进行独热编码。我还想做多项式特征。![](img/6759ee1a4176e478df5915cb285d57a7_170.png)
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_171.png)'
  id: totrans-144
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_171.png)'
- en: My other column right I have to have some sort of way of combining these things
    and it turns out that that's that last piece that I imported up here。 the make
    column transformer is going to let me stitch together multiple transformers each
    of which applies to a different column so I going come down here and I may copy
    this for my inspiration for kind of Model 4。
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 另外一列对吧，我必须有某种方式来组合这些东西，结果发现这就是我在这里导入的最后一部分。创建列转换器将让我将多个转换器组合在一起，每个转换器应用于不同的列，所以我会在这里往下走，可能会复制这个以获取我对模型4的灵感。
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_173.png)'
  id: totrans-146
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_173.png)'
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_174.png)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_174.png)'
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_175.png)'
  id: totrans-148
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_175.png)'
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_176.png)'
  id: totrans-149
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_176.png)'
- en: I time I have model 4 now。 And what am I going to do？ So this is what has to
    change， right？
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 我现在有模型4了。我将要做什么？所以这就是必须改变的，对吧？
- en: somehow I have to have。Something here。That can capture both columns， right。
    because what I'm going to do down here is I may pass in both beach name and wave
    period。Like that in an effort to predict my wave height。And so how do I do that，
    Well。 I I call that thing that I imported， which was make column transformer。
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 不知怎么的，我必须要有一些东西。在这里。能够同时捕获两个列，对吧。因为我接下来要做的事情是，我可能会传入海滩名称和波浪周期。为了预测我的波浪高度。那么我该怎么做呢，嗯。我称之为我导入的东西，就是创建列转换器。
- en: And when I'm calling that thing and when I'm calling that。 what I'll do is I'll
    have just a series of transformers。 And I'll have like transformer。One and then
    transformer two， and if I wanted to， I could have more。 but I don't need that
    in this case。Each of these things。
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 当我调用那个东西时，我会有一系列的转换器。我会有转换器一，然后是转换器二，如果我想的话，可以有更多，但在这种情况下我不需要。每一个。
- en: each of these transformers is going to be a tuple and the tuple will be the
    transformer。And then it will be a list of the columns that it applies to right
    so both are going to be like this right I have these tuples and maybe I'll just
    try to put a new line there。
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 每个转换器将是一个元组，元组将是转换器。然后将是它适用的列的列表，所以这两者都将是这样的，对吧，我有这些元组，或许我只需在这里换行。
- en: So we have these two transformers。And then a list of columns。 And so I think
    what I want to do is I want to do one hot encoding on the beach name right so
    I'm going to copy my one hot encoder right here。 and then what column does that
    apply to Well that applies to the beach name column。 And then my other one was
    polynomial features， which I should just copy from up above。
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 所以我们有这两个转换器。然后是一列列名。因此，我认为我想做的事情是对海滩名称进行独热编码，所以我会在这里复制我的独热编码器。那么这个适用于哪个列呢？嗯，它适用于海滩名称列。然后我的另一个是多项式特征，我应该直接从上面复制。
- en: that was this thing right here。![](img/6759ee1a4176e478df5915cb285d57a7_178.png)
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 就是这个东西。![](img/6759ee1a4176e478df5915cb285d57a7_178.png)
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_179.png)'
  id: totrans-156
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_179.png)'
- en: Polynomial features。It is my other introtter。 And what does that apply to that
    only applies to wave period。Okay， so I have this model for now and then I can
    well try running it and now I see I'm getting up to 9。5% of variances explained，
    which is actually， well， I guess I wish I was explaining 100%。 but I could see
    by kind of considering both these factors I'm explaining quite a bit more than
    I would have otherwise。
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 多项式特征。这是我的另一个引入者。这仅适用于波周期。好的，所以我现在有这个模型，然后我可以尝试运行它，现在我看到我解释了高达9.5%的方差，这实际上，我想我希望能解释100%。但我可以通过考虑这两个因素看到，我解释的方差比我原本要多得多。
- en: So one last thing I want to do before I wrap up this video is I want to talk
    about why we have these names here and I can use this。We can use pipelines like
    a dictionary。Right， so so for example。 that means I can put both here and what
    will that give me。 that will give me this column transformer that I created。
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 在我结束这个视频之前，我想做的最后一件事是讨论一下这些名称的意义，我可以利用这个。我们可以把管道像字典一样使用。对，所以例如，这意味着我可以把两个都放在这里，这样会给我什么呢？这会给我我创建的这个列转换器。
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_181.png)'
  id: totrans-159
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_181.png)'
- en: Right here。 And so if I wanted to， I could kind of peek at what this thing is
    doing as a way to debug my model。 I could say fit， transform。![](img/6759ee1a4176e478df5915cb285d57a7_183.png)
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 就在这里。如果我想，我可以窥视一下这个东西的工作方式，以便调试我的模型。我可以说拟合，转换。![](img/6759ee1a4176e478df5915cb285d57a7_183.png)
- en: And then what I could do here is I could say， well， this is the data I'm working
    with so I could see。![](img/6759ee1a4176e478df5915cb285d57a7_185.png)
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我可以在这里说，这就是我正在处理的数据，所以我可以看到。![](img/6759ee1a4176e478df5915cb285d57a7_185.png)
- en: That well and then I guess I'd actually need to have some column names here
    as well。 but I can see well， this is what I'm dealing with， let me do a data frame。![](img/6759ee1a4176e478df5915cb285d57a7_187.png)
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 那么我想我实际上需要一些列名在这里。不过我可以看到，这是我正在处理的，让我做一个数据框。![](img/6759ee1a4176e478df5915cb285d57a7_187.png)
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_188.png)'
  id: totrans-163
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_188.png)'
- en: Here。I could see that it has all these columns here that have the one hot en
    toading。And then I have these columns here that are doing polynomial features
    on other things。 so this is the data that I'm using to try to predict what the
    wave height is。 so even though I'm kind of starting with just these two columns。After
    I do all this transformation。
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里。我看到这里有所有这些列，这些列进行了独热编码。然后我有这些列对其他事物进行了多项式特征处理。所以这是我用来预测波高的数据。因此，即使我最开始只有这两列，在我完成所有这些转换后。
- en: I'm actually I'm giving the linear regressionion here at the end of my pipeline。
    quite a bit more information to work with， and that's why we're able to do much
    better here。So as the very last step， what I would like to do， so I saw that Model4
    was clearly the best one so that's the one I'll recommend now it's possible if
    I'm doing four different models one of them just kind of by lock does better and
    that's why I hung on to my training data I only used around my testing and I'll
    use training data for cross。
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，我在管道的最后给线性回归提供了更多的信息，这就是为什么我们能够在这里做得更好。因此，作为最后一步，我想做的是，我看到Model4显然是最好的，所以我会推荐这个。可能如果我在做四个不同的模型，其中一个恰好表现更好，这就是为什么我保留了我的训练数据，我只在测试数据上使用，并且会将训练数据用于交叉验证。
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_190.png)'
  id: totrans-166
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_190.png)'
- en: Validation scoring。 So at the very， very end， I may fit this data to these things。Just
    like that and。![](img/6759ee1a4176e478df5915cb285d57a7_192.png)
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 验证评分。所以在最后，我可能会将这些数据适配到这些内容上。就这样。![](img/6759ee1a4176e478df5915cb285d57a7_192.png)
- en: Then let me just run that and then I could use it to make predictions right。
    let me just remember how to do this because it's useful。 I could use this to make
    predictions on my test data frame。Like that。I could make all these predictions
    for what the waves could be。
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 那么让我运行一下，然后我可以用它来进行预测。让我记住如何做到这一点，因为这很有用。我可以用这个在我的测试数据框上进行预测。就这样。我可以做出所有这些关于波浪可能性的预测。
- en: or I could as a convenience score how good those predictions are against my
    test DF of。wave height。And I see well now I'm explaining 8。4% of variances right
    so I did do a little bit lucky there。 but still I can say this is clearly better
    than my other models were。
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 或者我可以方便地评估这些预测在我的测试数据框中关于波高的准确性。我现在看到，我能够解释8.4%的方差，所以我确实有一点运气，但我仍然可以说这显然比我的其他模型要好。
- en: '![](img/6759ee1a4176e478df5915cb285d57a7_194.png)'
  id: totrans-170
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6759ee1a4176e478df5915cb285d57a7_194.png)'
